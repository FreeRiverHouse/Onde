(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[241],{5036:(e,t,a)=>{"use strict";a.d(t,{default:()=>r});var n=a(5155),l=a(2115),c=a(2619),s=a.n(c),i=a(1865);let o={};function r(e){var t,a;let{bookId:c}=e,[i,r]=(0,l.useState)(null),[d,h]=(0,l.useState)(!0),[m,x]=(0,l.useState)(null),[f,g]=(0,l.useState)(19),[b,u]=(0,l.useState)(0),[p,j]=(0,l.useState)(!1),[N,v]=(0,l.useState)(0),[w,y]=(0,l.useState)("notte"),E=(0,l.useRef)(null),C=o[c];(0,l.useEffect)(()=>{let e=()=>{if(!E.current)return;let{scrollTop:e,scrollHeight:t,clientHeight:a}=document.documentElement;v(Math.min(100,Math.max(0,e/(t-a)*100)))};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,l.useEffect)(()=>{let e=localStorage.getItem("onde-reader-fontsize"),t=localStorage.getItem("onde-reader-theme");e&&g(parseInt(e)),t&&y(t)},[]),(0,l.useEffect)(()=>{localStorage.setItem("onde-reader-fontsize",f.toString()),localStorage.setItem("onde-reader-theme",w)},[f,w]),(0,l.useEffect)(()=>{if(c){if(!(null==C?void 0:C.gutenberg)){x("Contenuto in arrivo"),h(!1);return}(async()=>{try{let e="https://www.gutenberg.org/cache/epub/".concat(C.gutenberg,"/pg").concat(C.gutenberg,".txt"),t=await fetch(e);if(!t.ok)throw Error("Non disponibile");let a=await t.text(),n=function(e,t){let a=e;for(let e of["*** START OF THE PROJECT GUTENBERG EBOOK","*** START OF THIS PROJECT GUTENBERG EBOOK","*END*THE SMALL PRINT"]){let t=a.indexOf(e);if(-1!==t){a=a.substring(t+e.length);break}}for(let e of["*** END OF THE PROJECT GUTENBERG EBOOK","*** END OF THIS PROJECT GUTENBERG EBOOK","End of the Project Gutenberg","End of Project Gutenberg"]){let t=a.indexOf(e);if(-1!==t){a=a.substring(0,t);break}}a=a.trim();let n=[],l=a.split(/\n\s*(CHAPTER|Chapter|PART|Part|BOOK|Book)\s+([IVXLCDM\d]+|[A-Z]+|\d+)[.\s]*/gi);if(l.length>3)for(let e=1;e<l.length;e+=3){let t=l[e]||"Chapter",a=l[e+1]||"",c=l[e+2]||"",s=c.trim().split("\n"),i="".concat(t," ").concat(a);for(let e=0;e<Math.min(3,s.length);e++){let n=s[e].trim();if(n&&!n.match(/^[\d\s]+$/)&&n.length<100){i="".concat(t," ").concat(a,": ").concat(n);break}}n.push({title:i,content:c.trim()})}else n.push({title:t.title,content:a});let c=a.split(/\s+/).filter(Boolean).length;return{title:t.title,author:t.author,lang:t.lang||"en",content:a,chapters:n,wordCount:c}}(a,C);r(n)}catch(e){x("Impossibile caricare il libro. Prova a ricaricare la pagina.")}finally{h(!1)}})()}},[C,c]);let B={notte:{bg:"bg-gradient-to-b from-[#0a1628] to-[#0d1f3c]",text:"text-[#e8f4f8]",header:"bg-[#0a1628]/95",border:"border-[#2dd4bf]/20",accent:"text-[#fbbf24]",accentBg:"bg-[#fbbf24]/15",highlight:"text-[#2dd4bf]",highlightBg:"bg-[#2dd4bf]/10",muted:"text-[#94a3b8]",icon:"\uD83C\uDF19"},giorno:{bg:"bg-gradient-to-b from-[#f0fdfa] to-[#ffffff]",text:"text-[#134e4a]",header:"bg-[#f0fdfa]/95",border:"border-[#14b8a6]/20",accent:"text-[#d97706]",accentBg:"bg-[#d97706]/10",highlight:"text-[#0d9488]",highlightBg:"bg-[#0d9488]/10",muted:"text-[#5eead4]",icon:"☀️"},seppia:{bg:"bg-gradient-to-b from-[#fef3e2] to-[#fefaf6]",text:"text-[#44403c]",header:"bg-[#fef3e2]/95",border:"border-[#d97706]/20",accent:"text-[#b45309]",accentBg:"bg-[#b45309]/10",highlight:"text-[#0f766e]",highlightBg:"bg-[#0f766e]/10",muted:"text-[#a8a29e]",icon:"\uD83D\uDCDC"}}[w];if(!C)return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-[#0a1628] to-[#0d1f3c] flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center px-4",children:[(0,n.jsx)("div",{className:"text-6xl mb-6",children:"\uD83D\uDCDA"}),(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4 text-white",children:"Libro non trovato"}),(0,n.jsx)(s(),{href:"/catalogo",className:"text-[#2dd4bf] hover:text-[#fbbf24] transition font-medium",children:"← Torna alla Biblioteca"})]})});let T=i?Math.ceil(i.wordCount/200):0;return(0,n.jsxs)("div",{className:"min-h-screen ".concat(B.bg," transition-all duration-500"),children:[(0,n.jsx)("div",{className:"fixed top-0 left-0 right-0 h-1 bg-black/10 z-50",children:(0,n.jsx)("div",{className:"h-full bg-gradient-to-r from-[#2dd4bf] via-[#fbbf24] to-[#f59e0b] transition-all duration-150",style:{width:"".concat(N,"%")}})}),(0,n.jsx)("header",{className:"sticky top-0 ".concat(B.header," backdrop-blur-md ").concat(B.border," border-b z-40"),children:(0,n.jsx)("div",{className:"max-w-3xl mx-auto px-4 py-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(s(),{href:"/catalogo",className:"".concat(B.highlight," text-sm font-medium hover:").concat(B.accent," transition flex items-center gap-2"),children:[(0,n.jsx)("span",{children:"←"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Biblioteca"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{let e=["notte","giorno","seppia"],t=(e.indexOf(w)+1)%e.length;y(e[t])},className:"w-9 h-9 rounded-full ".concat(B.highlightBg," ").concat(B.highlight," text-base flex items-center justify-center hover:scale-110 transition-transform"),"aria-label":"Cambia tema",children:B.icon}),(0,n.jsx)("button",{onClick:()=>g(e=>Math.max(14,e-2)),className:"w-9 h-9 rounded-full ".concat(B.accentBg," ").concat(B.accent," text-sm font-bold hover:scale-110 transition-transform"),"aria-label":"Riduci font",children:"A-"}),(0,n.jsx)("button",{onClick:()=>g(e=>Math.min(28,e+2)),className:"w-9 h-9 rounded-full ".concat(B.accentBg," ").concat(B.accent," text-sm font-bold hover:scale-110 transition-transform"),"aria-label":"Ingrandisci font",children:"A+"}),i&&i.chapters.length>1&&(0,n.jsx)("button",{onClick:()=>j(!p),className:"w-9 h-9 rounded-full ".concat(B.highlightBg," ").concat(B.highlight," text-sm font-bold hover:scale-110 transition-transform"),"aria-label":"Indice",children:"☰"})]})]})})}),p&&i&&i.chapters.length>1&&(0,n.jsxs)("div",{className:"fixed inset-0 z-30",onClick:()=>j(!1),children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-[#0a1628]/60 backdrop-blur-sm"}),(0,n.jsx)("aside",{className:"absolute right-0 top-0 bottom-0 w-80 max-w-[85vw] ".concat(B.bg," ").concat(B.border," border-l shadow-2xl overflow-y-auto"),onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"p-5",children:[(0,n.jsxs)("h3",{className:"font-bold text-lg mb-5 ".concat(B.accent," flex items-center gap-2"),children:[(0,n.jsx)("span",{children:"\uD83D\uDCD6"})," Indice"]}),(0,n.jsx)("nav",{className:"space-y-1",children:i.chapters.map((e,t)=>(0,n.jsx)("button",{onClick:()=>{u(t),j(!1),window.scrollTo({top:0,behavior:"smooth"})},className:"w-full text-left px-4 py-3 rounded-xl text-sm transition-all ".concat(b===t?"".concat(B.highlightBg," ").concat(B.highlight," font-medium"):"".concat(B.text," opacity-70 hover:opacity-100 hover:").concat(B.accentBg)),children:e.title||"Sezione ".concat(t+1)},t))})]})})]}),(0,n.jsx)("div",{className:"".concat(B.border," border-b"),children:(0,n.jsxs)("div",{className:"max-w-3xl mx-auto px-4 py-10 text-center",children:[(0,n.jsx)("div",{className:"".concat(B.highlight," text-3xl mb-4"),children:"✦"}),(0,n.jsx)("h1",{className:"text-2xl md:text-4xl font-serif font-bold mb-3 ".concat(B.text),children:C.title}),(0,n.jsx)("p",{className:"text-lg md:text-xl ".concat(B.muted," mb-5 italic"),children:C.author}),(0,n.jsxs)("div",{className:"flex items-center justify-center gap-4 text-sm flex-wrap",children:[C.lang&&"en"!==C.lang&&(0,n.jsx)("span",{className:"".concat(B.highlightBg," ").concat(B.highlight," px-4 py-1.5 rounded-full font-medium"),children:C.lang.toUpperCase()}),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"".concat(B.muted),children:[i.wordCount.toLocaleString()," parole"]}),(0,n.jsx)("span",{className:"".concat(B.muted),children:"•"}),(0,n.jsxs)("span",{className:"".concat(B.muted),children:["~",T," min di lettura"]})]})]})]})}),(0,n.jsx)("main",{className:"max-w-3xl mx-auto px-4 py-10 pb-24",ref:E,children:d?(0,n.jsxs)("div",{className:"text-center py-24",children:[(0,n.jsxs)("div",{className:"relative inline-block",children:[(0,n.jsx)("div",{className:"w-16 h-16 rounded-full border-4 border-[#2dd4bf]/20 border-t-[#2dd4bf] animate-spin"}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCD6"})})]}),(0,n.jsx)("p",{className:"".concat(B.highlight," mt-6 animate-pulse font-medium"),children:"Caricamento in corso..."})]}):m?(0,n.jsxs)("div",{className:"text-center py-24",children:[(0,n.jsx)("div",{className:"text-6xl mb-6",children:"\uD83D\uDCDA"}),(0,n.jsx)("p",{className:"".concat(B.muted," mb-6 text-lg"),children:m}),(0,n.jsx)(s(),{href:"/catalogo",className:"".concat(B.highlightBg," ").concat(B.highlight," px-6 py-3 rounded-full font-medium hover:scale-105 transition-transform inline-block"),children:"← Torna alla biblioteca"})]}):i?(0,n.jsxs)(n.Fragment,{children:[i.chapters.length>1&&(0,n.jsxs)("div",{className:"flex items-center justify-between mb-10",children:[(0,n.jsx)("button",{onClick:()=>{u(e=>Math.max(0,e-1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:0===b,className:"px-5 py-2.5 rounded-full ".concat(B.highlightBg," ").concat(B.highlight," font-medium disabled:opacity-30 disabled:cursor-not-allowed hover:scale-105 transition-transform"),children:"← Prec"}),(0,n.jsxs)("span",{className:"".concat(B.muted," text-sm font-medium"),children:[b+1," / ",i.chapters.length]}),(0,n.jsx)("button",{onClick:()=>{u(e=>Math.min(i.chapters.length-1,e+1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:b===i.chapters.length-1,className:"px-5 py-2.5 rounded-full ".concat(B.highlightBg," ").concat(B.highlight," font-medium disabled:opacity-30 disabled:cursor-not-allowed hover:scale-105 transition-transform"),children:"Succ →"})]}),(null==(t=i.chapters[b])?void 0:t.title)&&(0,n.jsx)("h2",{className:"text-xl md:text-2xl font-serif font-bold mb-10 text-center ".concat(B.accent),children:i.chapters[b].title}),(0,n.jsx)("article",{className:"".concat(B.text," font-serif leading-relaxed"),style:{fontSize:"".concat(f,"px"),lineHeight:"2",textAlign:"justify",hyphens:"auto",WebkitHyphens:"auto"},children:null==(a=i.chapters[b])?void 0:a.content.split("\n\n").map((e,t)=>(0,n.jsx)("p",{className:"mb-7 first-letter:text-3xl first-letter:font-bold first-letter:mr-1 first-letter:float-left first-letter:leading-none",style:{textIndent:t>0?"1.5em":"0"},children:e.trim()},t))}),i.chapters.length>1&&(0,n.jsxs)("div",{className:"flex items-center justify-between mt-16 pt-10 ".concat(B.border," border-t"),children:[(0,n.jsx)("button",{onClick:()=>{u(e=>Math.max(0,e-1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:0===b,className:"px-6 py-3 rounded-full ".concat(B.highlightBg," ").concat(B.highlight," font-medium disabled:opacity-30 disabled:cursor-not-allowed hover:scale-105 transition-transform"),children:"← Capitolo Precedente"}),(0,n.jsx)("button",{onClick:()=>{u(e=>Math.min(i.chapters.length-1,e+1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:b===i.chapters.length-1,className:"px-6 py-3 rounded-full ".concat(B.highlightBg," ").concat(B.highlight," font-medium disabled:opacity-30 disabled:cursor-not-allowed hover:scale-105 transition-transform"),children:"Capitolo Successivo →"})]})]}):null}),(0,n.jsx)("footer",{className:"".concat(B.border," border-t py-10"),children:(0,n.jsxs)("div",{className:"max-w-3xl mx-auto px-4 text-center",children:[(0,n.jsx)("div",{className:"".concat(B.highlight," text-2xl mb-3"),children:"\uD83C\uDF0A"}),(0,n.jsx)("p",{className:"".concat(B.muted," text-sm"),children:"Testo da Project Gutenberg"}),(0,n.jsx)("p",{className:"".concat(B.accent," text-sm font-medium mt-1"),children:"Onde Publishing"})]})})]})}i.b.forEach(e=>{o[e.id]=e})},8175:(e,t,a)=>{Promise.resolve().then(a.bind(a,5036))}},e=>{e.O(0,[619,865,441,255,358],()=>e(e.s=8175)),_N_E=e.O()}]);