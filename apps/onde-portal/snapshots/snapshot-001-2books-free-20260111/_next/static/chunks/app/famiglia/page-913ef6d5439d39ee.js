(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[425],{4562:(e,a,i)=>{"use strict";i.r(a),i.d(a,{default:()=>l});var s=i(5155),t=i(2115);function l(){let[e,a]=(0,t.useState)([]),[i,l]=(0,t.useState)([]),[o,r]=(0,t.useState)(!0),[n,d]=(0,t.useState)(!1),[c,m]=(0,t.useState)({name:"",avatarEmoji:"",age:""}),[x,h]=(0,t.useState)(""),[g,p]=(0,t.useState)(null),[b,u]=(0,t.useState)(null);async function f(){try{let e=await fetch("/api/family/profiles"),i=await e.json();e.ok?(a(i.profiles),l(i.avatarOptions||[])):401===e.status&&(window.location.href="/account")}catch(e){console.error("Error fetching profiles:",e)}finally{r(!1)}}async function j(s){s.preventDefault(),h("");try{let s=await fetch("/api/family/profiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c.name,avatarEmoji:c.avatarEmoji||i[0],age:c.age?parseInt(c.age):void 0})}),t=await s.json();s.ok?(a([...e,t.profile]),m({name:"",avatarEmoji:"",age:""}),d(!1)):h(t.error)}catch(e){h("Errore di connessione"),console.error(e)}}async function v(e){p(e);try{let a=await fetch("/api/family/profiles/".concat(e.id)),i=await a.json();a.ok&&u(i.stats)}catch(e){console.error("Error fetching profile stats:",e)}}async function N(i){if(confirm("Sei sicuro di voler eliminare questo profilo?"))try{(await fetch("/api/family/profiles/".concat(i),{method:"DELETE"})).ok&&(a(e.filter(e=>e.id!==i)),p(null))}catch(e){console.error("Error deleting profile:",e)}}return((0,t.useEffect)(()=>{f()},[]),o)?(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-10 bg-white/10 rounded mb-8 w-1/3"}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"aspect-square bg-white/10 rounded-2xl"},e))})]})}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"Profili Famiglia"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-8",children:[e.map(e=>(0,s.jsxs)("button",{onClick:()=>v(e),className:"aspect-square bg-white/5 rounded-2xl p-4 flex flex-col items-center justify-center hover:bg-white/10 transition-colors border-2 ".concat((null==g?void 0:g.id)===e.id?"border-onde-gold":"border-transparent"),children:[(0,s.jsx)("div",{className:"text-5xl mb-3",children:e.avatarEmoji}),(0,s.jsx)("div",{className:"font-bold text-center",children:e.name}),e.age&&(0,s.jsxs)("div",{className:"text-sm opacity-60",children:[e.age," anni"]}),!e.isChild&&(0,s.jsx)("div",{className:"text-xs text-onde-gold mt-1",children:"Genitore"})]},e.id)),e.length<5&&(0,s.jsxs)("button",{onClick:()=>d(!0),className:"aspect-square bg-white/5 rounded-2xl p-4 flex flex-col items-center justify-center hover:bg-white/10 transition-colors border-2 border-dashed border-white/20",children:[(0,s.jsx)("div",{className:"text-4xl mb-2 opacity-60",children:"+"}),(0,s.jsx)("div",{className:"text-sm opacity-60",children:"Aggiungi profilo"})]})]}),g&&(0,s.jsxs)("div",{className:"bg-white/5 rounded-2xl p-8 mb-8",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"text-6xl",children:g.avatarEmoji}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:g.name}),g.age&&(0,s.jsxs)("p",{className:"opacity-60",children:[g.age," anni"]}),(0,s.jsx)("p",{className:"text-sm opacity-40",children:g.isChild?"Profilo bambino":"Profilo genitore"})]})]}),g.isChild&&(0,s.jsx)("button",{onClick:()=>N(g.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Elimina profilo"})]}),b&&(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-onde-gold",children:b.booksStarted}),(0,s.jsx)("div",{className:"text-sm opacity-60",children:"Libri iniziati"})]}),(0,s.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-onde-gold",children:b.booksCompleted}),(0,s.jsx)("div",{className:"text-sm opacity-60",children:"Libri completati"})]}),(0,s.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-onde-gold",children:b.chaptersRead}),(0,s.jsx)("div",{className:"text-sm opacity-60",children:"Capitoli letti"})]})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)("a",{href:"/libreria",className:"inline-block bg-onde-gold text-black font-bold px-6 py-3 rounded-lg hover:bg-onde-gold/80",children:"Vai alla Libreria"})})]}),n&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-onde-dark rounded-2xl p-8 max-w-md w-full",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Nuovo Profilo Bambino"}),x&&(0,s.jsx)("div",{className:"bg-red-500/20 border border-red-500 rounded-lg p-3 mb-4 text-sm",children:x}),(0,s.jsxs)("form",{onSubmit:j,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm mb-2 opacity-60",children:"Nome"}),(0,s.jsx)("input",{type:"text",value:c.name,onChange:e=>m({...c,name:e.target.value}),className:"w-full bg-white/10 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-onde-gold",placeholder:"Nome del bambino",required:!0,maxLength:50})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm mb-2 opacity-60",children:"Eta (opzionale)"}),(0,s.jsx)("input",{type:"number",value:c.age,onChange:e=>m({...c,age:e.target.value}),className:"w-full bg-white/10 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-onde-gold",placeholder:"Anni",min:1,max:18})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm mb-2 opacity-60",children:"Avatar"}),(0,s.jsx)("div",{className:"grid grid-cols-5 gap-2",children:i.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>m({...c,avatarEmoji:e}),className:"text-3xl p-2 rounded-lg ".concat(c.avatarEmoji===e?"bg-onde-gold/30 ring-2 ring-onde-gold":"bg-white/5 hover:bg-white/10"),children:e},e))})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{d(!1),m({name:"",avatarEmoji:"",age:""}),h("")},className:"flex-1 bg-white/10 font-bold py-3 rounded-lg hover:bg-white/20",children:"Annulla"}),(0,s.jsx)("button",{type:"submit",className:"flex-1 bg-onde-gold text-black font-bold py-3 rounded-lg hover:bg-onde-gold/80",children:"Crea Profilo"})]})]})]})}),(0,s.jsxs)("div",{className:"bg-white/5 rounded-xl p-6 text-center opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"Ogni famiglia puo avere fino a 5 profili."}),(0,s.jsxs)("p",{className:"text-sm",children:["I libri acquistati sono condivisi tra tutti i profili della famiglia.",(0,s.jsx)("br",{}),"Il progresso di lettura e salvato separatamente per ogni profilo."]})]})]})}},8002:(e,a,i)=>{Promise.resolve().then(i.bind(i,4562))}},e=>{e.O(0,[441,255,358],()=>e(e.s=8002)),_N_E=e.O()}]);