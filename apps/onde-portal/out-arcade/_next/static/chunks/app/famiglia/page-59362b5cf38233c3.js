(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2425],{18176:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>r});var t=s(54568),i=s(7620),l=s(79355);function r(){let e=(0,l.c3)(),[a,s]=(0,i.useState)([]),[r,o]=(0,i.useState)([]),[n,c]=(0,i.useState)(!0),[d,m]=(0,i.useState)(!1),[x,h]=(0,i.useState)({name:"",avatarEmoji:"",age:""}),[f,g]=(0,i.useState)(""),[u,b]=(0,i.useState)(null),[p,j]=(0,i.useState)(null);async function v(){try{let e=await fetch("/api/family/profiles"),a=await e.json();e.ok?(s(a.profiles),o(a.avatarOptions||[])):401===e.status&&(window.location.href="/account")}catch(e){console.error("Error fetching profiles:",e)}finally{c(!1)}}async function N(t){t.preventDefault(),g("");try{let e=await fetch("/api/family/profiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x.name,avatarEmoji:x.avatarEmoji||r[0],age:x.age?parseInt(x.age):void 0})}),t=await e.json();e.ok?(s([...a,t.profile]),h({name:"",avatarEmoji:"",age:""}),m(!1)):g(t.error)}catch(a){g(e.famiglia.connectionError),console.error(a)}}async function y(e){b(e);try{let a=await fetch("/api/family/profiles/".concat(e.id)),s=await a.json();a.ok&&j(s.stats)}catch(e){console.error("Error fetching profile stats:",e)}}async function w(t){if(confirm(e.famiglia.confirmDelete))try{(await fetch("/api/family/profiles/".concat(t),{method:"DELETE"})).ok&&(s(a.filter(e=>e.id!==t)),b(null))}catch(e){console.error("Error deleting profile:",e)}}return((0,i.useEffect)(()=>{v()},[]),n)?(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-10 bg-white/10 rounded mb-8 w-1/3"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"aspect-square bg-white/10 rounded-2xl"},e))})]})}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold mb-8",children:e.famiglia.title}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-8",children:[a.map(a=>(0,t.jsxs)("button",{onClick:()=>y(a),className:"aspect-square bg-white/5 rounded-2xl p-4 flex flex-col items-center justify-center hover:bg-white/10 transition-colors border-2 ".concat((null==u?void 0:u.id)===a.id?"border-onde-gold":"border-transparent"),children:[(0,t.jsx)("div",{className:"text-5xl mb-3",children:a.avatarEmoji}),(0,t.jsx)("div",{className:"font-bold text-center",children:a.name}),a.age&&(0,t.jsxs)("div",{className:"text-sm opacity-60",children:[a.age," ",e.famiglia.years]}),!a.isChild&&(0,t.jsx)("div",{className:"text-xs text-onde-gold mt-1",children:e.famiglia.parent})]},a.id)),a.length<5&&(0,t.jsxs)("button",{onClick:()=>m(!0),className:"aspect-square bg-white/5 rounded-2xl p-4 flex flex-col items-center justify-center hover:bg-white/10 transition-colors border-2 border-dashed border-white/20",children:[(0,t.jsx)("div",{className:"text-4xl mb-2 opacity-60",children:"+"}),(0,t.jsx)("div",{className:"text-sm opacity-60",children:e.famiglia.addProfile})]})]}),u&&(0,t.jsxs)("div",{className:"bg-white/5 rounded-2xl p-8 mb-8",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"text-6xl",children:u.avatarEmoji}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:u.name}),u.age&&(0,t.jsxs)("p",{className:"opacity-60",children:[u.age," ",e.famiglia.years]}),(0,t.jsx)("p",{className:"text-sm opacity-40",children:u.isChild?e.famiglia.childProfile:e.famiglia.parentProfile})]})]}),u.isChild&&(0,t.jsx)("button",{onClick:()=>w(u.id),className:"text-red-400 hover:text-red-300 text-sm",children:e.famiglia.deleteProfile})]}),p&&(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-onde-gold",children:p.booksStarted}),(0,t.jsx)("div",{className:"text-sm opacity-60",children:e.famiglia.stats.booksStarted})]}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-onde-gold",children:p.booksCompleted}),(0,t.jsx)("div",{className:"text-sm opacity-60",children:e.famiglia.stats.booksCompleted})]}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-onde-gold",children:p.chaptersRead}),(0,t.jsx)("div",{className:"text-sm opacity-60",children:e.famiglia.stats.chaptersRead})]})]}),(0,t.jsx)("div",{className:"mt-6 text-center",children:(0,t.jsx)("a",{href:"/libreria",className:"inline-block bg-onde-gold text-black font-bold px-6 py-3 rounded-lg hover:bg-onde-gold/80",children:e.famiglia.goToLibrary})})]}),d&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-onde-dark rounded-2xl p-8 max-w-md w-full",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6",children:e.famiglia.newProfile.title}),f&&(0,t.jsx)("div",{className:"bg-red-500/20 border border-red-500 rounded-lg p-3 mb-4 text-sm",children:f}),(0,t.jsxs)("form",{onSubmit:N,children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm mb-2 opacity-60",children:e.famiglia.newProfile.name}),(0,t.jsx)("input",{type:"text",value:x.name,onChange:e=>h({...x,name:e.target.value}),className:"w-full bg-white/10 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-onde-gold",placeholder:e.famiglia.newProfile.namePlaceholder,required:!0,maxLength:50})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm mb-2 opacity-60",children:e.famiglia.newProfile.age}),(0,t.jsx)("input",{type:"number",value:x.age,onChange:e=>h({...x,age:e.target.value}),className:"w-full bg-white/10 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-onde-gold",placeholder:e.famiglia.newProfile.agePlaceholder,min:1,max:18})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm mb-2 opacity-60",children:e.famiglia.newProfile.avatar}),(0,t.jsx)("div",{className:"grid grid-cols-5 gap-2",children:r.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>h({...x,avatarEmoji:e}),className:"text-3xl p-2 rounded-lg ".concat(x.avatarEmoji===e?"bg-onde-gold/30 ring-2 ring-onde-gold":"bg-white/5 hover:bg-white/10"),children:e},e))})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{m(!1),h({name:"",avatarEmoji:"",age:""}),g("")},className:"flex-1 bg-white/10 font-bold py-3 rounded-lg hover:bg-white/20",children:e.famiglia.newProfile.cancel}),(0,t.jsx)("button",{type:"submit",className:"flex-1 bg-onde-gold text-black font-bold py-3 rounded-lg hover:bg-onde-gold/80",children:e.famiglia.newProfile.create})]})]})]})}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-xl p-6 text-center opacity-60",children:[(0,t.jsx)("p",{className:"mb-2",children:e.famiglia.info.maxProfiles}),(0,t.jsxs)("p",{className:"text-sm",children:[e.famiglia.info.sharedBooks,(0,t.jsx)("br",{}),e.famiglia.info.separateProgress]})]})]})}},27541:(e,a,s)=>{"use strict";var t=s(43041);s.o(t,"useParams")&&s.d(a,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})},79355:(e,a,s)=>{"use strict";s.d(a,{c3:()=>t.c3});var t=s(18701);s(40637),s(19664),s(27541)},86087:(e,a,s)=>{Promise.resolve().then(s.bind(s,18176))}},e=>{e.O(0,[9664,8701,587,18,7358],()=>e(e.s=86087)),_N_E=e.O()}]);