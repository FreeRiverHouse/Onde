(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5653],{27541:(e,t,s)=>{"use strict";var a=s(43041);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},41090:(e,t,s)=>{"use strict";let a;s.r(t),s.d(t,{default:()=>$});var l=s(54568),n=s(7620);let r=-1,i=e=>{addEventListener("pageshow",t=>{t.persisted&&(r=t.timeStamp,e(t))},!0)},c=(e,t,s,a)=>{let l,n;return r=>{t.value>=0&&(r||a)&&((n=t.value-(l??0))||void 0===l)&&(l=t.value,t.delta=n,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,s),e(t))}},d=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},o=()=>{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},x=()=>{let e=o();return e?.activationStart??0},h=(e,t=-1)=>{let s=o(),a="navigate";return r>=0?a="back-forward-cache":s&&(document.prerendering||x()>0?a="prerender":document.wasDiscarded?a="restore":s.type&&(a=s.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(0x82f79cd8fff*Math.random())+1e12}`,navigationType:a}},m=new WeakMap;function u(e,t){return m.get(e)||m.set(e,new t),m.get(e)}class g{t;i=0;o=[];h(e){if(e.hadRecentInput)return;let t=this.o[0],s=this.o.at(-1);this.i&&t&&s&&e.startTime-s.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}let v=(e,t,s={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let a=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return a.observe({type:e,buffered:!0,...s}),a}}catch{}},p=e=>{let t=!1;return()=>{t||(e(),t=!0)}},b=-1,j=new Set,w=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,f=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(let e of j)e();isFinite(b)||(b="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",f,!0))}},y=()=>{if(b<0){let e=x();b=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime)??w(),addEventListener("visibilitychange",f,!0),addEventListener("prerenderingchange",f,!0),i(()=>{setTimeout(()=>{b=w()})})}return{get firstHiddenTime(){return b},onHidden(e){j.add(e)}}},N=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},k=[1800,3e3],D=(e,t={})=>{N(()=>{let s=y(),a,l=h("FCP"),n=v("paint",e=>{for(let t of e)"first-contentful-paint"===t.name&&(n.disconnect(),t.startTime<s.firstHiddenTime&&(l.value=Math.max(t.startTime-x(),0),l.entries.push(t),a(!0)))});n&&(a=c(e,l,k,t.reportAllChanges),i(s=>{a=c(e,l=h("FCP"),k,t.reportAllChanges),d(()=>{l.value=performance.now()-s.timeStamp,a(!0)})}))})},S=[.1,.25],_=0,C=1/0,T=0,L=e=>{for(let t of e)t.interactionId&&(C=Math.min(C,t.interactionId),_=(T=Math.max(T,t.interactionId))?(T-C)/7+1:0)},E=()=>a?_:performance.interactionCount??0,M=0;class A{u=[];l=new Map;m;p;v(){M=E(),this.u.length=0,this.l.clear()}L(){let e=Math.min(this.u.length-1,Math.floor((E()-M)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&"first-input"!==e.entryType)return;let t=this.u.at(-1),s=this.l.get(e.interactionId);if(s||this.u.length<10||e.duration>t.P){if(s?e.duration>s.P?(s.entries=[e],s.P=e.duration):e.duration===s.P&&e.startTime===s.entries[0].startTime&&s.entries.push(e):(s={id:e.interactionId,entries:[e],P:e.duration},this.l.set(s.id,s),this.u.push(s)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10)for(let e of this.u.splice(10))this.l.delete(e.id);this.p?.(s)}}}let P=e=>{let t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(addEventListener("visibilitychange",e=p(e),{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},I=[200,500];class F{m;h(e){this.m?.(e)}}let R=[2500,4e3],U=[800,1800],H=e=>{document.prerendering?N(()=>H(e)):"complete"!==document.readyState?addEventListener("load",()=>H(e),!0):setTimeout(e)};var z=s(79355);function B(e){let{value:t,size:s="md"}=e,a=t>=99.9||t>=99?"bg-green-500/20 text-green-400 border-green-500/40":t>=95?"bg-yellow-500/20 text-yellow-400 border-yellow-500/40":"bg-red-500/20 text-red-400 border-red-500/40";return(0,l.jsxs)("span",{className:"font-bold rounded-lg border ".concat(a," ").concat("lg"===s?"text-2xl px-4 py-2":"md"===s?"text-lg px-3 py-1.5":"text-sm px-2 py-1"),children:[t.toFixed(2),"%"]})}function W(e){let{checks:t,hours:s=24}=e,a=(0,n.useMemo)(()=>{if(!t||0===t.length)return[];let e=Date.now()-60*s*6e4,a=60*s*6e4/s,l=Array.from({length:s},()=>({ok:0,total:0,latencies:[]}));for(let n of t){let t=new Date(n.timestamp).getTime();if(t<e)continue;let r=Math.floor((t-e)/a);r>=0&&r<s&&(l[r].total++,n.ok&&(l[r].ok++,l[r].latencies.push(n.latency_ms)))}return l.map((e,t)=>{if(0===e.total)return{status:"no-data",uptime:0,avgLatency:0};let s=e.ok/e.total*100;return{status:100===s?"up":s>=50?"degraded":"down",uptime:s,avgLatency:Math.round(e.latencies.length>0?e.latencies.reduce((e,t)=>e+t,0)/e.latencies.length:0),hour:t}})},[t,s]);return 0===a.length?(0,l.jsx)("div",{className:"flex gap-0.5 h-8 items-end",children:Array.from({length:24}).map((e,t)=>(0,l.jsx)("div",{className:"flex-1 bg-slate-700/50 rounded-sm min-w-[4px] h-full",title:"No data"},t))}):(0,l.jsx)("div",{className:"flex gap-0.5 h-8 items-end group",children:a.map((e,t)=>(0,l.jsx)("div",{className:"flex-1 rounded-sm min-w-[4px] transition-all cursor-pointer hover:opacity-80 ".concat("up"===e.status?"bg-green-500":"degraded"===e.status?"bg-yellow-500":"down"===e.status?"bg-red-500":"bg-slate-700/50"),style:{height:"no-data"===e.status?"100%":"".concat(Math.max(20,e.uptime),"%")},title:"no-data"===e.status?"No data":"".concat(e.uptime.toFixed(0),"% uptime, ").concat(e.avgLatency,"ms avg (").concat(24-e.hour,"h ago)")},t))})}function O(e){let{checks:t,hours:s=24}=e,a=(0,n.useMemo)(()=>{if(!t||0===t.length)return[];let e=Date.now()-60*s*6e4,a=t.filter(t=>new Date(t.timestamp).getTime()>e&&t.ok).map(t=>({x:(new Date(t.timestamp).getTime()-e)/(60*s*6e4)*100,y:t.latency_ms}));if(0===a.length)return[];let l=Math.max(...a.map(e=>e.y)),n=Math.min(...a.map(e=>e.y)),r=l-n||1;return a.map(e=>({x:e.x,y:100-((e.y-n)/r*80+10),latency:e.y}))},[t,s]);if(a.length<2)return(0,l.jsx)("div",{className:"h-12 bg-slate-800/50 rounded-lg flex items-center justify-center text-slate-500 text-xs",children:"Not enough data"});let r=a.map((e,t)=>"".concat(0===t?"M":"L"," ").concat(e.x," ").concat(e.y)).join(" ");return(0,l.jsxs)("svg",{viewBox:"0 0 100 100",className:"h-12 w-full",preserveAspectRatio:"none",children:[(0,l.jsx)("line",{x1:"0",y1:"25",x2:"100",y2:"25",stroke:"currentColor",strokeOpacity:"0.1"}),(0,l.jsx)("line",{x1:"0",y1:"50",x2:"100",y2:"50",stroke:"currentColor",strokeOpacity:"0.1"}),(0,l.jsx)("line",{x1:"0",y1:"75",x2:"100",y2:"75",stroke:"currentColor",strokeOpacity:"0.1"}),(0,l.jsx)("path",{d:r,fill:"none",stroke:"url(#latencyGradient)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("defs",{children:(0,l.jsxs)("linearGradient",{id:"latencyGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,l.jsx)("stop",{offset:"0%",stopColor:"#3b82f6"}),(0,l.jsx)("stop",{offset:"100%",stopColor:"#06b6d4"})]})})]})}function V(e){let{checks:t,hours:s=24}=e,a=(0,n.useMemo)(()=>{if(!t||0===t.length)return[];let e=Date.now()-60*s*6e4,a=[],l=null;for(let s of t.slice().reverse())!(new Date(s.timestamp).getTime()<e)&&(s.ok?l&&(l.end=s.timestamp,a.push({...l,duration:new Date(l.end).getTime()-new Date(l.start).getTime()}),l=null):l||(l={start:s.timestamp,error:s.error}));return l&&a.push({...l,duration:Date.now()-new Date(l.start).getTime()}),a.slice(0,5)},[t,s]);return 0===a.length?(0,l.jsxs)("div",{className:"text-center py-2 text-green-400 text-sm",children:["✅ No incidents in the last ",s,"h"]}):(0,l.jsx)("div",{className:"space-y-2",children:a.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between bg-red-500/10 border border-red-500/30 rounded-lg px-3 py-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-red-400 text-sm font-medium",children:"⚠️ Downtime detected"}),(0,l.jsxs)("div",{className:"text-xs text-slate-400",children:[new Date(e.start).toLocaleTimeString(),e.end&&" - ".concat(new Date(e.end).toLocaleTimeString())]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-red-400 text-sm font-mono",children:e.duration<6e4?"".concat(Math.round(e.duration/1e3),"s"):"".concat(Math.round(e.duration/6e4),"m")}),e.error&&(0,l.jsx)("div",{className:"text-xs text-slate-500 truncate max-w-[150px]",children:e.error})]})]},t))})}function q(e){let{data:t,loading:s}=e;return s?(0,l.jsx)("div",{className:"rounded-lg border bg-slate-500/10 border-slate-500/30 p-4",children:(0,l.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,l.jsx)("div",{className:"h-6 bg-slate-700 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-slate-700 rounded"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsx)("div",{className:"h-20 bg-slate-700 rounded"}),(0,l.jsx)("div",{className:"h-20 bg-slate-700 rounded"})]})]})}):t&&0!==Object.keys(t.sites||{}).length?(0,l.jsxs)("div",{className:"space-y-4",children:[Object.entries(t.sites).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"rounded-lg border bg-slate-800/30 border-slate-700/50 p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s.stats.uptime_24h>=99.9||s.stats.uptime_24h>=99?"bg-green-500":s.stats.uptime_24h>=95?"bg-yellow-500":"bg-red-500")}),(0,l.jsx)("span",{className:"text-white font-medium",children:t})]}),(0,l.jsx)(B,{value:s.stats.uptime_24h})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[(0,l.jsx)("span",{children:"24h ago"}),(0,l.jsx)("span",{children:"Now"})]}),(0,l.jsx)(W,{checks:s.checks,hours:24})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"24h Uptime"}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(s.stats.uptime_24h>=99?"text-green-400":"text-yellow-400"),children:[s.stats.uptime_24h.toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"7d Uptime"}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(s.stats.uptime_7d>=99?"text-green-400":"text-yellow-400"),children:[s.stats.uptime_7d.toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Avg Latency (24h)"}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(s.stats.avg_latency_24h<200?"text-green-400":s.stats.avg_latency_24h<500?"text-blue-400":"text-yellow-400"),children:[s.stats.avg_latency_24h,"ms"]})]}),(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Incidents (7d)"}),(0,l.jsx)("div",{className:"text-lg font-bold ".concat(0===s.stats.incidents_7d?"text-green-400":s.stats.incidents_7d<=2?"text-yellow-400":"text-red-400"),children:s.stats.incidents_7d})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("div",{className:"text-xs text-slate-400 mb-2",children:"Response Time (24h)"}),(0,l.jsx)(O,{checks:s.checks,hours:24})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-slate-400 mb-2",children:"Recent Incidents"}),(0,l.jsx)(V,{checks:s.checks,hours:24})]})]},t)}),(0,l.jsxs)("div",{className:"text-xs text-slate-500 text-center pt-2",children:["Last updated: ",new Date(t.generated_at).toLocaleString()]})]}):(0,l.jsx)("div",{className:"rounded-lg border bg-slate-500/10 border-slate-500/30 p-4",children:(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsx)("div",{children:"\uD83D\uDCCA No uptime history available"}),(0,l.jsxs)("div",{className:"text-xs mt-2",children:["Run ",(0,l.jsx)("code",{className:"bg-slate-700 px-1 rounded",children:"scripts/record-uptime.py"})," to start collecting data"]})]})})}let G=[{name:"onde.la",url:"https://onde.la"},{name:"onde.surf",url:"https://onde.surf"},{name:"GitHub (FRH)",url:"https://github.com/FreeRiverHouse"}],K=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,t)).toFixed(1)," ").concat(["B","KB","MB","GB"][t])};function $(){let e=(0,z.c3)(),[t,s]=(0,n.useState)(G.map(e=>({name:e.name,status:"checking"}))),[r,m]=(0,n.useState)([]),[b,j]=(0,n.useState)("checking"),[w,f]=(0,n.useState)(null),[k,_]=(0,n.useState)({online:!0,swStatus:"checking"}),[C,T]=(0,n.useState)(null),[E,M]=(0,n.useState)(!1),[B,W]=(0,n.useState)([]),[O,V]=(0,n.useState)(null),[$,X]=(0,n.useState)(!0),[Z,J]=(0,n.useState)(null),[Q,Y]=(0,n.useState)(null),[ee,et]=(0,n.useState)("all"),[es,ea]=(0,n.useState)(null),[el,en]=(0,n.useState)(!0),[er,ei]=(0,n.useState)(null),[ec,ed]=(0,n.useState)(!0),[eo,ex]=(0,n.useState)(null),[eh,em]=(0,n.useState)(!0),[eu,eg]=(0,n.useState)(!1),[ev,ep]=(0,n.useState)(30),[eb,ej]=(0,n.useState)(!1);(0,n.useEffect)(()=>{{let e=localStorage.getItem("health-auto-refresh");null!==e&&em("true"===e)}},[]);let ew=(0,n.useCallback)(()=>{em(e=>{let t=!e;return localStorage.setItem("health-auto-refresh",String(t)),t})},[]);(0,n.useEffect)(()=>{let e=e=>{W(t=>[...t.filter(t=>t.name!==e.name),{name:e.name,value:e.value,rating:((e,t)=>{let[s,a]={CLS:[.1,.25],FCP:[1800,3e3],INP:[200,500],LCP:[2500,4e3],TTFB:[800,1800]}[e]||[0,0];return t<=s?"good":t<=a?"needs-improvement":"poor"})(e.name,e.value),unit:"CLS"===e.name?"":"ms"}].sort((e,t)=>e.name.localeCompare(t.name)))};((e,t={})=>{let s=y();D(p(()=>{let a,l=h("CLS",0),n=u(t,g),r=e=>{for(let t of e)n.h(t);n.i>l.value&&(l.value=n.i,l.entries=n.o,a())},o=v("layout-shift",r);o&&(a=c(e,l,S,t.reportAllChanges),s.onHidden(()=>{r(o.takeRecords()),a(!0)}),i(()=>{n.i=0,a=c(e,l=h("CLS",0),S,t.reportAllChanges),d(()=>a())}),setTimeout(a))}))})(e),D(e),((e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;let s=y();N(()=>{"interactionCount"in performance||a||(a=v("event",L,{type:"event",buffered:!0,durationThreshold:0}));let l,n=h("INP"),r=u(t,A),d=e=>{P(()=>{for(let t of e)r.h(t);let t=r.L();t&&t.P!==n.value&&(n.value=t.P,n.entries=t.entries,l())})},o=v("event",d,{durationThreshold:t.durationThreshold??40});l=c(e,n,I,t.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),s.onHidden(()=>{d(o.takeRecords()),l(!0)}),i(()=>{r.v(),l=c(e,n=h("INP"),I,t.reportAllChanges)}))})})(e),((e,t={})=>{N(()=>{let s=y(),a,l=h("LCP"),n=u(t,F),r=e=>{for(let r of(t.reportAllChanges||(e=e.slice(-1)),e))n.h(r),r.startTime<s.firstHiddenTime&&(l.value=Math.max(r.startTime-x(),0),l.entries=[r],a())},o=v("largest-contentful-paint",r);if(o){a=c(e,l,R,t.reportAllChanges);let s=p(()=>{r(o.takeRecords()),o.disconnect(),a(!0)}),n=e=>{e.isTrusted&&(P(s),removeEventListener(e.type,n,{capture:!0}))};for(let e of["keydown","click","visibilitychange"])addEventListener(e,n,{capture:!0});i(s=>{a=c(e,l=h("LCP"),R,t.reportAllChanges),d(()=>{l.value=performance.now()-s.timeStamp,a(!0)})})}})})(e),((e,t={})=>{let s=h("TTFB"),a=c(e,s,U,t.reportAllChanges);H(()=>{let l=o();l&&(s.value=Math.max(l.responseStart-x(),0),s.entries=[l],a(!0),i(()=>{(a=c(e,s=h("TTFB",0),U,t.reportAllChanges))(!0)}))})})(e)},[]);let ef=(0,n.useCallback)(async()=>{let e={online:"undefined"==typeof navigator||navigator.onLine,swStatus:"checking"},t=navigator;if((null==t?void 0:t.connection)&&(e.effectiveType=t.connection.effectiveType,e.downlink=t.connection.downlink,e.rtt=t.connection.rtt),"serviceWorker"in navigator)try{let t=await navigator.serviceWorker.getRegistration();if(t){T(t),t.waiting?e.swStatus="waiting":t.installing?e.swStatus="installing":t.active&&(e.swStatus="active");let s=(await caches.keys()).find(e=>e.startsWith("onde-v"));s&&(e.swVersion=s.replace("onde-",""))}else e.swStatus="none",T(null)}catch(t){e.swStatus="error",T(null)}else e.swStatus="none";if("storage"in navigator&&"estimate"in navigator.storage)try{let t=await navigator.storage.estimate();e.cacheUsage={usage:t.usage||0,quota:t.quota||0}}catch(e){}_(e)},[]),ey=(0,n.useCallback)(async()=>{en(!0);try{if(!("caches"in window))return void ea(null);let e=await caches.keys(),t={caches:[],totalEntries:0,staleEntries:0,totalSize:0},s=Date.now();for(let a of e){let e=await caches.open(a),l=await e.keys(),n={name:a,entryCount:l.length,totalSize:0,entries:[]};for(let a of l.slice(0,20))try{let l=await e.match(a);if(l){let e={url:new URL(a.url).pathname||a.url},r=l.headers.get("date");if(r){let a=new Date(r);e.date=r,e.ageMinutes=Math.round((s-a.getTime())/6e4),s-a.getTime()>864e5&&t.staleEntries++}let i=l.headers.get("content-length");if(i){let t=parseInt(i,10);e.contentLength=t,n.totalSize+=t}let c=l.headers.get("content-type");c&&(e.contentType=c.split(";")[0]),n.entries.push(e)}}catch(e){}t.totalEntries+=n.entryCount,t.totalSize+=n.totalSize,t.caches.push(n)}ea(t)}catch(e){console.error("Cache analysis failed:",e),ea(null)}finally{en(!1)}},[]),eN=(0,n.useCallback)(async()=>{if(null==C?void 0:C.waiting){M(!0);try{C.waiting.postMessage({type:"SKIP_WAITING"}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}),setTimeout(()=>{window.location.reload()},3e3)}catch(e){console.error("Failed to update service worker:",e),M(!1)}}},[C]),ek=async(e,t)=>{let s=Date.now();try{let a=new AbortController,l=setTimeout(()=>a.abort(),5e3);await fetch(t,{mode:"no-cors",signal:a.signal}),clearTimeout(l);let n=Date.now()-s;return{name:e,status:"up",latency:n,message:"Reachable"}}catch(t){return{name:e,status:"down",latency:Date.now()-s,message:t instanceof Error?t.message:"Unreachable"}}},eD=async()=>{try{let e=await fetch("/api/health/cron"),t=await e.json();m(t.jobs),j(t.status)}catch(e){j("error")}},eS=async()=>{X(!0),ed(!0);try{let e=await fetch("https://gist.githubusercontent.com/FreeRiverHouse/43b0815cc640bba8ac799ecb27434579/raw/onde-trading-stats.json",{cache:"no-store"}),t=await e.json();t.apiLatency&&V(t.apiLatency),t.healthStatus&&J(t.healthStatus),t.alerts&&Y(t.alerts),t.uptimeHistory&&ei(t.uptimeHistory),t.webhookAlerts&&ex(t.webhookAlerts)}catch(e){console.error("Failed to fetch trading stats:",e)}finally{X(!1),ed(!1)}},e_=(0,n.useCallback)(async()=>{eg(!0),s(G.map(e=>({name:e.name,status:"checking"}))),j("checking");try{let[e]=await Promise.all([Promise.all(G.map(e=>{let{name:t,url:s}=e;return ek(t,s)})),eD(),eS()]);s(e),f(new Date)}finally{eg(!1)}},[]);(0,n.useEffect)(()=>{e_(),ef(),ey()},[e_,ef,ey]),(0,n.useEffect)(()=>{if(!eh||eb||eu)return;let e=setInterval(()=>{ep(e=>e<=1?(e_(),30):e-1)},1e3);return()=>clearInterval(e)},[eh,eb,eu,e_]),(0,n.useEffect)(()=>{eu||ep(30)},[eu]),(0,n.useEffect)(()=>{if(!eh)return;let e=setInterval(ef,3e4),t=setInterval(ey,12e4);return()=>{clearInterval(e),clearInterval(t)}},[eh,ef,ey]),(0,n.useEffect)(()=>{let e=()=>_(e=>({...e,online:!0})),t=()=>_(e=>({...e,online:!1}));return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,n.useEffect)(()=>{let e=e=>{var t;"r"!==e.key.toLowerCase()||e.ctrlKey||e.metaKey||e.altKey||["INPUT","TEXTAREA","SELECT"].includes(null==(t=e.target)?void 0:t.tagName)||(e.preventDefault(),e_())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[e_]);let eC=e=>{switch(e){case"up":return"text-green-500";case"down":return"text-red-500";default:return"text-yellow-500"}},eT=e=>{switch(e){case"up":return"bg-green-500/10 border-green-500/30";case"down":return"bg-red-500/10 border-red-500/30";default:return"bg-yellow-500/10 border-yellow-500/30"}},eL=t.every(e=>"up"===e.status),eE=t.some(e=>"down"===e.status),eM=t.some(e=>"checking"===e.status)||"checking"===b?"checking":eL&&"healthy"===b?"healthy":eE||"error"===b?"degraded":"unknown";return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 p-8",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,l.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2",children:["\uD83C\uDF0A ",e.health.title]}),(0,l.jsx)("p",{className:"text-slate-400 mb-8",children:e.health.subtitle}),(0,l.jsxs)("div",{className:"rounded-xl border p-6 mb-8 ".concat(eT(eM)),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-slate-400 uppercase tracking-wide",children:e.health.overall.label}),(0,l.jsx)("div",{className:"text-2xl font-bold ".concat(eC(eM)),children:"healthy"===eM?"✅ ".concat(e.health.overall.healthy):"degraded"===eM?"⚠️ ".concat(e.health.overall.degraded):"checking"===eM?"\uD83D\uDD04 ".concat(e.health.overall.checking):"❓ ".concat(e.health.overall.unknown)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("button",{onClick:e_,disabled:eu,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:bg-slate-800 disabled:cursor-wait text-white rounded-lg transition-colors flex items-center gap-2",title:"Press R to refresh",children:[(0,l.jsx)("span",{className:eu?"animate-spin":"",children:"↻"}),eu?"Refreshing...":e.health.refresh]}),(0,l.jsx)("kbd",{className:"hidden sm:inline-block px-2 py-1 text-xs font-mono bg-slate-800 text-slate-400 border border-slate-600 rounded",children:"R"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-slate-700/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("button",{onClick:ew,className:"relative w-12 h-6 rounded-full transition-colors ".concat(eh?"bg-green-500":"bg-slate-600"),"aria-label":"Toggle auto-refresh",children:(0,l.jsx)("div",{className:"absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ".concat(eh?"translate-x-7":"translate-x-1")})}),(0,l.jsxs)("span",{className:"text-sm text-slate-300",children:["Auto-refresh ",eh?"on":"off"]}),eh&&!eu&&(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-2",onMouseEnter:()=>ej(!0),onMouseLeave:()=>ej(!1),title:eb?"Paused - move mouse away to resume":"Hover to pause countdown",children:[(0,l.jsx)("div",{className:"relative w-6 h-6",children:(0,l.jsxs)("svg",{className:"w-6 h-6 -rotate-90",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-slate-700"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",className:eb?"text-yellow-500":"text-green-500",strokeDasharray:2*Math.PI*10,strokeDashoffset:2*Math.PI*10*(1-ev/30),style:{transition:"stroke-dashoffset 1s linear"}})]})}),(0,l.jsx)("span",{className:"text-xs font-mono ".concat(eb?"text-yellow-500":"text-slate-400"),children:eb?"⏸":"".concat(ev,"s")})]}),eu&&(0,l.jsx)("span",{className:"text-xs text-blue-400 ml-2 animate-pulse",children:"Refreshing..."})]}),(0,l.jsx)("div",{className:"text-xs text-slate-500",children:w?(0,l.jsxs)(l.Fragment,{children:["Last: ",w.toLocaleTimeString()]}):(0,l.jsx)(l.Fragment,{children:"Never refreshed"})})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold text-white mb-3",children:["\uD83C\uDF10 ",e.health.services.title]}),(0,l.jsx)("div",{className:"space-y-3",children:t.map(t=>(0,l.jsxs)("div",{className:"rounded-lg border p-4 flex items-center justify-between ".concat(eT(t.status)),children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("up"===t.status?"bg-green-500":"down"===t.status?"bg-red-500":"bg-yellow-500 animate-pulse")}),(0,l.jsx)("span",{className:"text-white font-medium",children:t.name})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-sm font-medium ".concat(eC(t.status)),children:"up"===t.status?e.health.services.up:"down"===t.status?e.health.services.down:e.health.services.checking}),t.latency&&(0,l.jsxs)("div",{className:"text-xs text-slate-400",children:[t.latency,"ms"]})]})]},t.name))})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"\uD83D\uDCC8 Uptime History"}),(0,l.jsx)(q,{data:er,loading:ec})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold text-white mb-3",children:["⏰ ",e.health.cron.title]}),(0,l.jsx)("div",{className:"space-y-3",children:0===r.length&&"checking"===b?(0,l.jsx)("div",{className:"text-slate-400 text-center py-4",children:e.health.cron.loading}):0===r.length?(0,l.jsx)("div",{className:"text-slate-400 text-center py-4",children:e.health.cron.noData}):r.map(t=>{var s;return(0,l.jsxs)("div",{className:"rounded-lg border p-4 ".concat((e=>{switch(e){case"healthy":return"bg-green-500/10 border-green-500/30";case"stale":return"bg-yellow-500/10 border-yellow-500/30";case"error":return"bg-red-500/10 border-red-500/30";default:return"bg-slate-500/10 border-slate-500/30"}})(t.status)),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("healthy"===t.status?"bg-green-500":"stale"===t.status?"bg-yellow-500":"error"===t.status?"bg-red-500":"bg-slate-500")}),(0,l.jsx)("span",{className:"text-white font-medium",children:t.name})]}),(0,l.jsx)("div",{className:"text-sm font-medium ".concat((e=>{switch(e){case"healthy":return"text-green-500";case"stale":return"text-yellow-500";case"error":return"text-red-500";default:return"text-slate-400"}})(t.status)),children:"healthy"===t.status?e.health.cron.healthy:"stale"===t.status?e.health.cron.stale:"error"===t.status?e.health.cron.error:e.health.cron.unknown})]}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-slate-400 pl-6",children:[(0,l.jsxs)("span",{children:[e.health.cron.schedule,": ",(0,l.jsx)("code",{className:"bg-slate-700 px-1 rounded",children:t.schedule})]}),(0,l.jsx)("span",{children:null===(s=t.ageMinutes)?e.health.cron.never:s<60?"".concat(s,"m ").concat(e.health.cron.ago):s<1440?"".concat(Math.round(s/60),"h ").concat(e.health.cron.ago):"".concat(Math.round(s/1440),"d ").concat(e.health.cron.ago)})]})]},t.name)})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"\uD83E\uDD16 Autotrader Status"}),(0,l.jsx)("div",{className:"rounded-lg border p-4 ".concat(Z?"healthy"===Z.status?"bg-green-500/10 border-green-500/30":"warning"===Z.status?"bg-yellow-500/10 border-yellow-500/30":"error"===Z.status?"bg-red-500/10 border-red-500/30":"bg-slate-500/10 border-slate-500/30":"bg-slate-500/10 border-slate-500/30"),children:Z?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(Z.is_running?"bg-green-500 animate-pulse":"bg-red-500")}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"text-white font-medium",children:[Z.is_running?"Running":"Stopped",Z.dry_run&&" (Dry Run \uD83E\uDDEA)"]}),(0,l.jsx)("div",{className:"text-sm ".concat("healthy"===Z.status?"text-green-400":"warning"===Z.status?"text-yellow-400":"error"===Z.status?"text-red-400":"text-slate-400"),children:"healthy"===Z.status?"✅ Healthy":"warning"===Z.status?"⚠️ Warning":"error"===Z.status?"❌ Error":"❓ Unknown"})]})]}),Z.circuit_breaker_active&&(0,l.jsx)("div",{className:"px-3 py-1 bg-red-500/20 border border-red-500/40 rounded-lg",children:(0,l.jsx)("span",{className:"text-red-400 text-sm font-medium",children:"\uD83D\uDED1 Circuit Breaker Active"})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[void 0!==Z.trades_today&&(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Trades Today"}),(0,l.jsx)("div",{className:"text-xl font-bold text-white",children:Z.trades_today})]}),void 0!==Z.trades_24h&&!Z.trades_today&&(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Trades (24h)"}),(0,l.jsx)("div",{className:"text-xl font-bold text-white",children:Z.trades_24h})]}),void 0!==Z.win_rate_today&&(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Win Rate Today"}),(0,l.jsxs)("div",{className:"text-xl font-bold ".concat(Z.win_rate_today>=50?"text-green-400":Z.win_rate_today>=40?"text-yellow-400":"text-red-400"),children:[Z.win_rate_today.toFixed(0),"%"]})]}),void 0!==Z.pnl_today_cents&&(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"PnL Today"}),(0,l.jsxs)("div",{className:"text-xl font-bold ".concat(Z.pnl_today_cents>=0?"text-green-400":"text-red-400"),children:[Z.pnl_today_cents>=0?"+":"","$",(Z.pnl_today_cents/100).toFixed(2)]})]}),void 0!==Z.consecutive_losses&&Z.consecutive_losses>0&&(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Consecutive Losses"}),(0,l.jsx)("div",{className:"text-xl font-bold ".concat(Z.consecutive_losses>=5?"text-red-400":Z.consecutive_losses>=3?"text-yellow-400":"text-slate-300"),children:Z.consecutive_losses})]}),void 0!==Z.cycle_count&&(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Cycles"}),(0,l.jsx)("div",{className:"text-xl font-bold text-white",children:Z.cycle_count.toLocaleString()})]})]}),Z.issues&&Z.issues.length>0&&(0,l.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 mb-3",children:[(0,l.jsx)("div",{className:"text-yellow-400 text-xs font-medium mb-1",children:"⚠️ Issues"}),(0,l.jsx)("ul",{className:"text-yellow-300 text-sm space-y-1",children:Z.issues.map((e,t)=>(0,l.jsxs)("li",{children:["• ",e]},t))})]}),Z.last_cycle_time&&(0,l.jsxs)("div",{className:"text-xs text-slate-500 text-center pt-2 border-t border-slate-700",children:["Last cycle: ",new Date(Z.last_cycle_time).toLocaleString()]})]}):(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsx)("div",{children:"\uD83E\uDD16 No autotrader data available"}),(0,l.jsx)("div",{className:"text-xs mt-2",children:"Health status will appear when autotrader is running"})]})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"⚡ API Latency"}),(0,l.jsx)("div",{className:"rounded-lg border p-4 ".concat($?"bg-slate-500/10 border-slate-500/30":O?O.overall.avg_latency_ms>1e3?"bg-red-500/10 border-red-500/30":O.overall.avg_latency_ms>500?"bg-yellow-500/10 border-yellow-500/30":"bg-green-500/10 border-green-500/30":"bg-slate-500/10 border-slate-500/30"),children:$?(0,l.jsx)("div",{className:"text-slate-400 text-center py-4 animate-pulse",children:"Loading API latency data..."}):O?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-slate-700",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-slate-400",children:"Overall Average"}),(0,l.jsxs)("div",{className:"text-2xl font-bold ".concat(O.overall.avg_latency_ms<200?"text-green-400":O.overall.avg_latency_ms<500?"text-blue-400":O.overall.avg_latency_ms<1e3?"text-yellow-400":"text-red-400"),children:[O.overall.avg_latency_ms.toFixed(0),"ms"]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-sm text-slate-400",children:"Total Calls"}),(0,l.jsx)("div",{className:"text-xl font-semibold text-white",children:O.overall.total_calls.toLocaleString()})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:Object.entries(O.categories).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsx)("span",{className:"text-slate-400 text-xs font-medium uppercase",children:"kalshi"===t?"\uD83D\uDCC8 Kalshi":"coingecko"===t?"\uD83E\uDD8E CoinGecko":"binance"===t?"\uD83D\uDFE1 Binance":"coinbase"===t?"\uD83D\uDD35 Coinbase":"\uD83D\uDD27 ".concat(t)}),(0,l.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(s.avg_latency_ms<200?"bg-green-500":s.avg_latency_ms<500?"bg-blue-500":s.avg_latency_ms<1e3?"bg-yellow-500":"bg-red-500")})]}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(s.avg_latency_ms<200?"text-green-400":s.avg_latency_ms<500?"text-blue-400":s.avg_latency_ms<1e3?"text-yellow-400":"text-red-400"),children:[s.avg_latency_ms.toFixed(0),"ms"]}),(0,l.jsxs)("div",{className:"text-xs text-slate-500",children:[s.total_calls.toLocaleString()," calls • ",s.endpoint_count," endpoints"]})]},t)})}),O.slowest&&O.slowest.length>0&&(0,l.jsxs)("div",{className:"border-t border-slate-700 pt-3",children:[(0,l.jsx)("div",{className:"text-xs text-slate-400 mb-2",children:"\uD83D\uDC22 Slowest Endpoints"}),(0,l.jsx)("div",{className:"space-y-1",children:O.slowest.slice(0,3).map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,l.jsxs)("span",{className:"text-slate-300 truncate max-w-[60%]",children:[t+1,". ",e.name]}),(0,l.jsxs)("span",{className:"font-mono ".concat(e.avgMs<500?"text-slate-400":e.avgMs<1e3?"text-yellow-400":"text-red-400"),children:[e.avgMs.toFixed(0),"ms avg • p95: ",e.p95Ms.toFixed(0),"ms"]})]},e.name))})]}),(0,l.jsxs)("div",{className:"mt-3 pt-2 border-t border-slate-700 text-xs text-slate-500 text-center",children:["Updated: ",new Date(O.generated_at).toLocaleString()]})]}):(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsx)("div",{children:"\uD83D\uDCCA No API latency data available"}),(0,l.jsx)("div",{className:"text-xs mt-2",children:"Autotrader needs to run for ~30min to generate latency profile"})]})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"\uD83D\uDEA8 Alert History (24h)"}),(0,l.jsx)("div",{className:"rounded-lg border p-4 ".concat(Q?0===Q.count?"bg-green-500/10 border-green-500/30":Q.count<=5?"bg-yellow-500/10 border-yellow-500/30":"bg-red-500/10 border-red-500/30":"bg-slate-500/10 border-slate-500/30"),children:Q?0===Q.count?(0,l.jsxs)("div",{className:"text-center py-4",children:[(0,l.jsx)("div",{className:"text-green-400 text-lg",children:"✅ No alerts in the last 24h"}),(0,l.jsxs)("div",{className:"text-xs text-slate-400 mt-2",children:["Last checked: ",new Date(Q.generated_at).toLocaleString()]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-slate-700",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-slate-400",children:"Total Alerts"}),(0,l.jsx)("div",{className:"text-2xl font-bold ".concat(Q.count<=3?"text-yellow-400":Q.count<=10?"text-orange-400":"text-red-400"),children:Q.count})]}),(0,l.jsxs)("div",{className:"text-right text-xs text-slate-500",children:["Last updated: ",new Date(Q.generated_at).toLocaleString()]})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:["all","divergence","regime","vol","whipsaw"].map(e=>{let t="all"===e?Q.items.length:Q.items.filter(t=>"divergence"===e?t.type.includes("divergence"):"regime"===e?t.type.includes("regime"):"vol"===e?t.type.includes("vol"):t.type.includes("whipsaw")).length;return(0,l.jsxs)("button",{onClick:()=>et(e),className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ".concat(ee===e?"all"===e?"bg-slate-600 text-white":"divergence"===e?"bg-yellow-500/30 text-yellow-300 border border-yellow-500/50":"regime"===e?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"vol"===e?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-red-500/30 text-red-300 border border-red-500/50":"bg-slate-700/50 text-slate-400 hover:bg-slate-700 hover:text-slate-300"),children:["all"===e?"\uD83D\uDCCB All":"divergence"===e?"\uD83D\uDCC9 Divergence":"regime"===e?"\uD83D\uDD04 Regime":"vol"===e?"\uD83D\uDCCA Volatility":"⚡ Whipsaw",(0,l.jsxs)("span",{className:"ml-1.5 opacity-70",children:["(",t,")"]})]},e)})}),(0,l.jsxs)("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:[Q.items.filter(e=>"all"===ee||("divergence"===ee?e.type.includes("divergence"):"regime"===ee?e.type.includes("regime"):"vol"===ee?e.type.includes("vol"):e.type.includes("whipsaw"))).slice(0,10).map((e,t)=>{var s,a;return(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-xs font-mono px-2 py-0.5 rounded ".concat(e.type.includes("divergence")?"bg-yellow-500/20 text-yellow-400":e.type.includes("regime")?"bg-purple-500/20 text-purple-400":e.type.includes("vol")?"bg-blue-500/20 text-blue-400":e.type.includes("whipsaw")?"bg-red-500/20 text-red-400":"bg-slate-600/50 text-slate-300"),children:e.type.replace(/_/g," ").replace("momentum ","")}),(null==(s=e.details)?void 0:s.severity)&&(0,l.jsx)("span",{className:"text-xs ".concat("high"===e.details.severity?"text-red-400":"medium"===e.details.severity?"text-yellow-400":"text-slate-400"),children:e.details.severity})]}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,l.jsx)("div",{className:"text-sm text-slate-300",children:e.summary}),(null==(a=e.details)?void 0:a.asset)&&(0,l.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:[e.details.asset,e.details.timeframe&&" • ".concat(e.details.timeframe)]})]},"".concat(e.timestamp,"-").concat(t))}),(()=>{let e=Q.items.filter(e=>"all"===ee||("divergence"===ee?e.type.includes("divergence"):"regime"===ee?e.type.includes("regime"):"vol"===ee?e.type.includes("vol"):e.type.includes("whipsaw"))).length;return e>10?(0,l.jsxs)("div",{className:"text-center text-xs text-slate-500 pt-2",children:["... and ",e-10," more ","all"!==ee?ee+" ":"","alerts"]}):null})()]})]}):(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsx)("div",{children:"\uD83D\uDEA8 No alert data available"}),(0,l.jsx)("div",{className:"text-xs mt-2",children:"Run upload-alerts-to-gist.py to sync alerts"})]})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"\uD83D\uDCE2 Webhook Alerts (7d)"}),(0,l.jsx)("div",{className:"rounded-lg border p-4 ".concat(eo?0===eo.count?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30":"bg-slate-500/10 border-slate-500/30"),children:eo?0===eo.count?(0,l.jsxs)("div",{className:"text-center py-4",children:[(0,l.jsx)("div",{className:"text-green-400 text-lg",children:"✅ No critical alerts in the last 7 days"}),(0,l.jsxs)("div",{className:"text-xs text-slate-400 mt-2",children:["All systems have been stable. Last checked: ",new Date(eo.generated_at).toLocaleString()]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-slate-700",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-slate-400",children:"Critical Alerts (7d)"}),(0,l.jsx)("div",{className:"text-2xl font-bold text-red-400",children:eo.count})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xs text-slate-500",children:"Sites Down"}),(0,l.jsx)("div",{className:"text-lg font-bold text-red-400",children:eo.items.filter(e=>{var t,s;return(null==(t=e.details)?void 0:t.ondeLaDown)||(null==(s=e.details)?void 0:s.ondeSurfDown)}).length})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xs text-slate-500",children:"Autotrader"}),(0,l.jsx)("div",{className:"text-lg font-bold text-yellow-400",children:eo.items.filter(e=>{var t;return null==(t=e.details)?void 0:t.autotraderDown}).length})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[eo.items.slice(0,10).map((e,t)=>{var s,a,n;return(0,l.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-xs font-mono px-2 py-0.5 rounded bg-red-500/20 text-red-400",children:"CRITICAL"}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(null==(s=e.details)?void 0:s.ondeLaDown)&&(0,l.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-slate-700 rounded text-red-300",children:"onde.la"}),(null==(a=e.details)?void 0:a.ondeSurfDown)&&(0,l.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-slate-700 rounded text-red-300",children:"onde.surf"}),(null==(n=e.details)?void 0:n.autotraderDown)&&(0,l.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-slate-700 rounded text-yellow-300",children:"autotrader"})]})]}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.timestamp).toLocaleString()})]}),(0,l.jsxs)("div",{className:"text-sm text-red-300",children:["Health check detected critical issues",e.resolved&&(0,l.jsx)("span",{className:"ml-2 text-green-400 text-xs",children:"✅ Resolved"})]})]},"webhook-".concat(t))}),eo.count>10&&(0,l.jsxs)("div",{className:"text-center text-xs text-slate-500 pt-2",children:["... and ",eo.count-10," more alerts"]})]})]}):(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsx)("div",{children:"\uD83D\uDCE2 No webhook alert data"}),(0,l.jsx)("div",{className:"text-xs mt-2",children:"Webhook alerts appear when critical health issues are detected"})]})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold text-white mb-3",children:["\uD83D\uDCE1 ",e.health.network.title]}),(0,l.jsxs)("div",{className:"rounded-lg border p-4 space-y-3 ".concat(k.online?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(k.online?"bg-green-500":"bg-red-500")}),(0,l.jsx)("span",{className:"text-white font-medium",children:e.health.network.connection})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-sm font-medium ".concat(k.online?"text-green-500":"text-red-500"),children:k.online?e.health.network.online:e.health.network.offline}),k.effectiveType&&(0,l.jsxs)("div",{className:"text-xs text-slate-400",children:[k.effectiveType.toUpperCase(),k.downlink&&" • ".concat(k.downlink,"Mbps"),k.rtt&&" • ".concat(k.rtt,"ms RTT")]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between border-t border-slate-700 pt-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("active"===k.swStatus?"bg-green-500":"installing"===k.swStatus||"waiting"===k.swStatus?"bg-yellow-500 animate-pulse":"none"===k.swStatus?"bg-slate-500":"checking"===k.swStatus?"bg-yellow-500 animate-pulse":"bg-red-500")}),(0,l.jsx)("span",{className:"text-white font-medium",children:e.health.network.serviceWorker})]}),(0,l.jsxs)("div",{className:"text-right flex items-center gap-2",children:["waiting"===k.swStatus&&(0,l.jsx)("button",{onClick:eN,disabled:E,className:"px-2 py-1 text-xs bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400 border border-yellow-500/30 rounded transition-colors disabled:opacity-50",children:E?"⏳ ".concat(e.health.network.updating):"\uD83D\uDD04 ".concat(e.health.network.updateNow)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-medium ".concat("active"===k.swStatus?"text-green-500":"installing"===k.swStatus||"waiting"===k.swStatus?"text-yellow-500":"none"===k.swStatus?"text-slate-400":"checking"===k.swStatus?"text-yellow-500":"text-red-500"),children:"active"===k.swStatus?e.health.network.active:"installing"===k.swStatus?e.health.network.installing:"waiting"===k.swStatus?e.health.network.waiting:"none"===k.swStatus?e.health.network.none:k.swStatus.toUpperCase()}),k.swVersion&&(0,l.jsxs)("div",{className:"text-xs text-slate-400",children:[e.health.network.cache,": ",k.swVersion]})]})]})]}),k.cacheUsage&&k.cacheUsage.quota>0&&(0,l.jsxs)("div",{className:"border-t border-slate-700 pt-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("span",{className:"text-slate-400 text-sm",children:e.health.network.cacheStorage}),(0,l.jsxs)("span",{className:"text-slate-400 text-sm",children:[K(k.cacheUsage.usage)," / ",K(k.cacheUsage.quota)]})]}),(0,l.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:"".concat(Math.min(100,k.cacheUsage.usage/k.cacheUsage.quota*100),"%")}})}),(0,l.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:[(k.cacheUsage.usage/k.cacheUsage.quota*100).toFixed(2),"% ",e.health.network.used]})]})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"\uD83D\uDCBE Cache Diagnostics"}),(0,l.jsx)("div",{className:"rounded-lg border p-4 ".concat(el?"bg-slate-500/10 border-slate-500/30":es?es.staleEntries>10?"bg-yellow-500/10 border-yellow-500/30":"bg-green-500/10 border-green-500/30":"bg-slate-500/10 border-slate-500/30"),children:el?(0,l.jsx)("div",{className:"text-slate-400 text-center py-4 animate-pulse",children:"Analyzing cache entries..."}):es?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Total Entries"}),(0,l.jsx)("div",{className:"text-xl font-bold text-white",children:es.totalEntries})]}),(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Cache Size"}),(0,l.jsx)("div",{className:"text-xl font-bold text-white",children:K(es.totalSize)})]}),(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Cache Buckets"}),(0,l.jsx)("div",{className:"text-xl font-bold text-white",children:es.caches.length})]}),(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Stale (>24h)"}),(0,l.jsx)("div",{className:"text-xl font-bold ".concat(0===es.staleEntries?"text-green-400":es.staleEntries<=5?"text-yellow-400":"text-red-400"),children:es.staleEntries})]})]}),es.caches.length>0&&(0,l.jsx)("div",{className:"space-y-3",children:es.caches.map(e=>(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-white font-medium text-sm",children:e.name}),(0,l.jsxs)("span",{className:"text-xs text-slate-500",children:["(",e.entryCount," items)"]})]}),e.totalSize>0&&(0,l.jsx)("span",{className:"text-xs text-slate-400",children:K(e.totalSize)})]}),e.entries.length>0&&(0,l.jsxs)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:[e.entries.slice(0,10).map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,l.jsx)("span",{className:"text-slate-300 truncate max-w-[50%]",title:e.url,children:e.url.length>40?"...".concat(e.url.slice(-37)):e.url}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-slate-500",children:[e.contentType&&(0,l.jsx)("span",{className:"bg-slate-700 px-1.5 py-0.5 rounded text-slate-400",children:e.contentType.split("/")[1]||e.contentType}),void 0!==e.ageMinutes&&(0,l.jsx)("span",{className:e.ageMinutes>1440?"text-yellow-400":"",children:e.ageMinutes<60?"".concat(e.ageMinutes,"m"):e.ageMinutes<1440?"".concat(Math.round(e.ageMinutes/60),"h"):"".concat(Math.round(e.ageMinutes/1440),"d")}),e.contentLength&&(0,l.jsx)("span",{children:K(e.contentLength)})]})]},t)),e.entryCount>10&&(0,l.jsxs)("div",{className:"text-xs text-slate-500 text-center pt-1",children:["... and ",e.entryCount-10," more"]})]})]},e.name))}),(0,l.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-700 flex justify-center",children:(0,l.jsx)("button",{onClick:ey,className:"px-3 py-1.5 text-xs bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors",children:"↻ Refresh Cache Analysis"})})]}):(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsx)("div",{children:"\uD83D\uDCBE Cache API not available"}),(0,l.jsx)("div",{className:"text-xs mt-2",children:"Browser may not support Cache API"})]})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold text-white mb-3",children:["⚡ ",e.health.webVitals.title]}),(0,l.jsxs)("div",{className:"rounded-lg border p-4 ".concat(0===B.length?"bg-slate-500/10 border-slate-500/30":B.some(e=>"poor"===e.rating)?"bg-red-500/10 border-red-500/30":B.some(e=>"needs-improvement"===e.rating)?"bg-yellow-500/10 border-yellow-500/30":"bg-green-500/10 border-green-500/30"),children:[0===B.length?(0,l.jsxs)("div",{className:"text-slate-400 text-center py-4",children:[(0,l.jsxs)("div",{className:"animate-pulse",children:["\uD83D\uDCCA ",e.health.webVitals.collecting]}),(0,l.jsx)("div",{className:"text-xs mt-2",children:e.health.webVitals.interactHint})]}):(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:B.map(t=>(0,l.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsx)("span",{className:"text-slate-400 text-xs font-medium",children:t.name}),(0,l.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("good"===t.rating?"bg-green-500":"needs-improvement"===t.rating?"bg-yellow-500":"bg-red-500")})]}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat("good"===t.rating?"text-green-400":"needs-improvement"===t.rating?"text-yellow-400":"text-red-400"),children:["CLS"===t.name?t.value.toFixed(3):Math.round(t.value),t.unit]}),(0,l.jsx)("div",{className:"text-xs capitalize ".concat("good"===t.rating?"text-green-500":"needs-improvement"===t.rating?"text-yellow-500":"text-red-500"),children:"good"===t.rating?e.health.webVitals.good:"needs-improvement"===t.rating?e.health.webVitals.needsImprovement:e.health.webVitals.poor})]},t.name))}),B.length>0&&(0,l.jsxs)("div",{className:"mt-3 pt-3 border-t border-slate-700 text-xs text-slate-500 text-center",children:[e.health.webVitals.basedOn," ",(0,l.jsx)("a",{href:"https://web.dev/vitals/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"Google's Core Web Vitals"})," ",e.health.webVitals.thresholds]})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold text-white mb-3",children:["\uD83D\uDD50 ",e.health.timezone.title]}),(0,l.jsxs)("div",{className:"rounded-lg border bg-slate-500/10 border-slate-500/30 p-4 grid grid-cols-2 gap-3 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-slate-400",children:[e.health.timezone.cronTz,":"]}),(0,l.jsx)("span",{className:"text-white ml-2",children:"UTC"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-slate-400",children:[e.health.timezone.yourTz,":"]}),(0,l.jsx)("span",{className:"text-white ml-2",children:Intl.DateTimeFormat().resolvedOptions().timeZone})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-slate-400",children:[e.health.timezone.utc,":"]}),(0,l.jsx)("span",{className:"text-white ml-2",children:new Date().toISOString().slice(11,19)})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-slate-400",children:[e.health.timezone.local,":"]}),(0,l.jsx)("span",{className:"text-white ml-2",children:new Date().toLocaleTimeString()})]})]})]}),(0,l.jsx)("div",{className:"mt-8 text-center text-slate-500 text-sm",children:w?(0,l.jsxs)(l.Fragment,{children:[e.health.lastChecked,": ",w.toLocaleString(),(0,l.jsx)("br",{}),(0,l.jsx)("span",{className:"text-xs",children:eh?"\uD83D\uDD04 Auto-refresh enabled (30s)":"⏸️ Auto-refresh paused"})]}):(0,l.jsx)("span",{className:"text-xs",children:e.health.cron.never})}),(0,l.jsx)("div",{className:"mt-12 text-center",children:(0,l.jsxs)("a",{href:"/",className:"text-blue-400 hover:text-blue-300",children:["← ",e.health.backToOnde]})})]})})}},64467:(e,t,s)=>{Promise.resolve().then(s.bind(s,41090))},79355:(e,t,s)=>{"use strict";s.d(t,{c3:()=>a.c3});var a=s(18701);s(40637),s(19664),s(27541)}},e=>{e.O(0,[9664,8701,587,18,7358],()=>e(e.s=64467)),_N_E=e.O()}]);