(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[939],{2965:(e,t)=>{"use strict";function i(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.freeze?t.freeze(e):e}var r=i({HTML:"text/html",isHTML:function(e){return e===r.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),s=i({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===s.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.find=function(e,t,i){if(void 0===i&&(i=Array.prototype),e&&"function"==typeof i.find)return i.find.call(e,t);for(var r=0;r<e.length;r++)if(Object.prototype.hasOwnProperty.call(e,r)){var s=e[r];if(t.call(void 0,s,r,e))return s}},t.freeze=i,t.MIME_TYPE=r,t.NAMESPACE=s},7875:(e,t,i)=>{var r=i(2965),s=i(6869),n=i(2568),o=i(7093),a=s.DOMImplementation,l=r.NAMESPACE,h=o.ParseError,c=o.XMLReader;function u(e){this.options=e||{locator:{}}}function d(){this.cdata=!1}function f(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function p(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function g(e,t,i){return"string"==typeof e?e.substr(t,i):e.length>=t+i||t?new java.lang.String(e,t,i)+"":e}function m(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}u.prototype.parseFromString=function(e,t){var i=this.options,r=new c,s=i.domBuilder||new d,o=i.errorHandler,a=i.locator,h=i.xmlns||{},u=/\/x?html?$/.test(t),f=u?n.HTML_ENTITIES:n.XML_ENTITIES;return a&&s.setDocumentLocator(a),r.errorHandler=function(e,t,i){if(!e){if(t instanceof d)return t;e=t}var r={},s=e instanceof Function;function n(t){var n=e[t];!n&&s&&(n=2==e.length?function(i){e(t,i)}:e),r[t]=n&&function(e){n("[xmldom "+t+"]	"+e+p(i))}||function(){}}return i=i||{},n("warning"),n("error"),n("fatalError"),r}(o,s,a),r.domBuilder=i.domBuilder||s,u&&(h[""]=l.HTML),h.xml=h.xml||l.XML,e&&"string"==typeof e?r.parse(e,h,f):r.errorHandler.error("invalid doc source"),s.doc},d.prototype={startDocument:function(){this.doc=new a().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,i,r){var s=this.doc,n=s.createElementNS(e,i||t),o=r.length;m(this,n),this.currentElement=n,this.locator&&f(this.locator,n);for(var a=0;a<o;a++){var e=r.getURI(a),l=r.getValue(a),i=r.getQName(a),h=s.createAttributeNS(e,i);this.locator&&f(r.getLocator(a),h),h.value=h.nodeValue=l,n.setAttributeNode(h)}},endElement:function(e,t,i){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var i=this.doc.createProcessingInstruction(e,t);this.locator&&f(this.locator,i),m(this,i)},ignorableWhitespace:function(e,t,i){},characters:function(e,t,i){if(e=g.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else var r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&f(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,i){e=g.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&f(this.locator,r),m(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,i){var r=this.doc.implementation;if(r&&r.createDocumentType){var s=r.createDocumentType(e,t,i);this.locator&&f(this.locator,s),m(this,s),this.doc.doctype=s}},warning:function(e){console.warn("[xmldom warning]	"+e,p(this.locator))},error:function(e){console.error("[xmldom error]	"+e,p(this.locator))},fatalError:function(e){throw new h(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){d.prototype[e]=function(){return null}}),t.DOMParser=u,s.DOMImplementation,s.XMLSerializer},6869:(e,t,i)=>{var r=i(2965),s=r.find,n=r.NAMESPACE;function o(e){return""!==e}function a(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function l(e){return e?Object.keys((e?e.split(/[\t\n\f\r ]+/).filter(o):[]).reduce(a,{})):[]}function h(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}function c(e,t){var i=e.prototype;if(!(i instanceof t)){function r(){}r.prototype=t.prototype,h(i,r=new r),e.prototype=i=r}i.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),i.constructor=e)}var u={},d=u.ELEMENT_NODE=1,f=u.ATTRIBUTE_NODE=2,p=u.TEXT_NODE=3,g=u.CDATA_SECTION_NODE=4,m=u.ENTITY_REFERENCE_NODE=5,v=u.ENTITY_NODE=6,y=u.PROCESSING_INSTRUCTION_NODE=7,b=u.COMMENT_NODE=8,w=u.DOCUMENT_NODE=9,_=u.DOCUMENT_TYPE_NODE=10,E=u.DOCUMENT_FRAGMENT_NODE=11,S=u.NOTATION_NODE=12,T={},k={};T.INDEX_SIZE_ERR=(k[1]="Index size error",1),T.DOMSTRING_SIZE_ERR=(k[2]="DOMString size error",2);var x=T.HIERARCHY_REQUEST_ERR=(k[3]="Hierarchy request error",3);T.WRONG_DOCUMENT_ERR=(k[4]="Wrong document",4),T.INVALID_CHARACTER_ERR=(k[5]="Invalid character",5),T.NO_DATA_ALLOWED_ERR=(k[6]="No data allowed",6),T.NO_MODIFICATION_ALLOWED_ERR=(k[7]="No modification allowed",7);var C=T.NOT_FOUND_ERR=(k[8]="Not found",8);T.NOT_SUPPORTED_ERR=(k[9]="Not supported",9);var A=T.INUSE_ATTRIBUTE_ERR=(k[10]="Attribute in use",10);function R(e,t){if(t instanceof Error)var i=t;else i=this,Error.call(this,k[e]),this.message=k[e],Error.captureStackTrace&&Error.captureStackTrace(this,R);return i.code=e,t&&(this.message=this.message+": "+t),i}function D(){}function O(e,t){this._node=e,this._refresh=t,N(this)}function N(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var i=e._refresh(e._node);if(eg(e,"length",i.length),!e.$$length||i.length<e.$$length)for(var r=i.length;r in e;r++)Object.prototype.hasOwnProperty.call(e,r)&&delete e[r];h(i,e),e._inc=t}}function I(){}function L(e,t){for(var i=e.length;i--;)if(e[i]===t)return i}function P(e,t,i,r){if(r?t[L(t,r)]=i:t[t.length++]=i,e){i.ownerElement=e;var s=e.ownerDocument;s&&(r&&z(s,e,r),s&&s._inc++,i.namespaceURI===n.XMLNS&&(e._nsMap[i.prefix?i.localName:""]=i.value))}}function j(e,t,i){var r=L(t,i);if(r>=0){for(var s=t.length-1;r<s;)t[r]=t[++r];if(t.length=s,e){var n=e.ownerDocument;n&&(z(n,e,i),i.ownerElement=null)}}else throw new R(C,Error(e.tagName+"@"+i))}function U(){}function q(){}function B(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function $(e,t){if(t(e))return!0;if(e=e.firstChild)do if($(e,t))return!0;while(e=e.nextSibling)}function M(){this.ownerDocument=this}function z(e,t,i,r){e&&e._inc++,i.namespaceURI===n.XMLNS&&delete t._nsMap[i.prefix?i.localName:""]}function F(e,t,i){if(e&&e._inc){e._inc++;var r=t.childNodes;if(i)r[r.length++]=i;else{for(var s=t.firstChild,n=0;s;)r[n++]=s,s=s.nextSibling;r.length=n,delete r[r.length]}}}function W(e,t){var i=t.previousSibling,r=t.nextSibling;return i?i.nextSibling=r:e.firstChild=r,r?r.previousSibling=i:e.lastChild=i,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,F(e.ownerDocument,e),t}function V(e){return e&&e.nodeType===q.DOCUMENT_TYPE_NODE}function H(e){return e&&e.nodeType===q.ELEMENT_NODE}function G(e){return e&&e.nodeType===q.TEXT_NODE}function K(e,t){var i=e.childNodes||[];if(s(i,H)||V(t))return!1;var r=s(i,V);return!(t&&r&&i.indexOf(r)>i.indexOf(t))}function J(e,t){var i=e.childNodes||[];if(s(i,function(e){return H(e)&&e!==t}))return!1;var r=s(i,V);return!(t&&r&&i.indexOf(r)>i.indexOf(t))}function X(e,t,i){var r=e.childNodes||[],n=t.childNodes||[];if(t.nodeType===q.DOCUMENT_FRAGMENT_NODE){var o=n.filter(H);if(o.length>1||s(n,G))throw new R(x,"More than one element or text in fragment");if(1===o.length&&!J(e,i))throw new R(x,"Element in fragment can not be inserted before doctype")}if(H(t)&&!J(e,i))throw new R(x,"Only one element can be added and only after doctype");if(V(t)){if(s(r,function(e){return V(e)&&e!==i}))throw new R(x,"Only one doctype is allowed");var a=s(r,H);if(i&&r.indexOf(a)<r.indexOf(i))throw new R(x,"Doctype can only be inserted before an element")}}function Y(e,t,i,r){!function(e,t,i){if(!(e&&(e.nodeType===q.DOCUMENT_NODE||e.nodeType===q.DOCUMENT_FRAGMENT_NODE||e.nodeType===q.ELEMENT_NODE)))throw new R(x,"Unexpected parent node type "+e.nodeType);if(i&&i.parentNode!==e)throw new R(C,"child not in parent");if(!(t&&(H(t)||G(t)||V(t)||t.nodeType===q.DOCUMENT_FRAGMENT_NODE||t.nodeType===q.COMMENT_NODE||t.nodeType===q.PROCESSING_INSTRUCTION_NODE))||V(t)&&e.nodeType!==q.DOCUMENT_NODE)throw new R(x,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}(e,t,i),e.nodeType===q.DOCUMENT_NODE&&(r||function(e,t,i){var r=e.childNodes||[],n=t.childNodes||[];if(t.nodeType===q.DOCUMENT_FRAGMENT_NODE){var o=n.filter(H);if(o.length>1||s(n,G))throw new R(x,"More than one element or text in fragment");if(1===o.length&&!K(e,i))throw new R(x,"Element in fragment can not be inserted before doctype")}if(H(t)&&!K(e,i))throw new R(x,"Only one element can be added and only after doctype");if(V(t)){if(s(r,V))throw new R(x,"Only one doctype is allowed");var a=s(r,H);if(i&&r.indexOf(a)<r.indexOf(i))throw new R(x,"Doctype can only be inserted before an element");if(!i&&a)throw new R(x,"Doctype can not be appended since element is present")}})(e,t,i);var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===E){var o=t.firstChild;if(null==o)return t;var a=t.lastChild}else o=a=t;var l=i?i.previousSibling:e.lastChild;o.previousSibling=l,a.nextSibling=i,l?l.nextSibling=o:e.firstChild=o,null==i?e.lastChild=a:i.previousSibling=a;do o.parentNode=e;while(o!==a&&(o=o.nextSibling));return F(e.ownerDocument||e,e),t.nodeType==E&&(t.firstChild=t.lastChild=null),t}function Z(){this._nsMap={}}function Q(){}function ee(){}function et(){}function ei(){}function er(){}function es(){}function en(){}function eo(){}function ea(){}function el(){}function eh(){}function ec(){}function eu(e,t){var i=[],r=9==this.nodeType&&this.documentElement||this,s=r.prefix,n=r.namespaceURI;if(n&&null==s){var s=r.lookupPrefix(n);if(null==s)var o=[{namespace:n,prefix:null}]}return ep(this,i,e,t,o),i.join("")}function ed(e,t,i){var r=e.prefix||"",s=e.namespaceURI;if(!s||"xml"===r&&s===n.XML||s===n.XMLNS)return!1;for(var o=i.length;o--;){var a=i[o];if(a.prefix===r)return a.namespace!==s}return!0}function ef(e,t,i){e.push(" ",t,'="',i.replace(/[<&"]/g,B),'"')}function ep(e,t,i,r,s){if(s||(s=[]),r){if(!(e=r(e)))return;if("string"==typeof e){t.push(e);return}}switch(e.nodeType){case d:var o,a=e.attributes,l=a.length,h=e.firstChild,c=e.tagName;i=n.isHTML(e.namespaceURI)||i;var u=c;if(!i&&!e.prefix&&e.namespaceURI){for(var v=0;v<a.length;v++)if("xmlns"===a.item(v).name){o=a.item(v).value;break}if(!o)for(var S=s.length-1;S>=0;S--){var T=s[S];if(""===T.prefix&&T.namespace===e.namespaceURI){o=T.namespace;break}}if(o!==e.namespaceURI)for(var S=s.length-1;S>=0;S--){var T=s[S];if(T.namespace===e.namespaceURI){T.prefix&&(u=T.prefix+":"+c);break}}}t.push("<",u);for(var k=0;k<l;k++){var x=a.item(k);"xmlns"==x.prefix?s.push({prefix:x.localName,namespace:x.value}):"xmlns"==x.nodeName&&s.push({prefix:"",namespace:x.value})}for(var k=0;k<l;k++){var x=a.item(k);if(ed(x,i,s)){var C=x.prefix||"",A=x.namespaceURI;ef(t,C?"xmlns:"+C:"xmlns",A),s.push({prefix:C,namespace:A})}ep(x,t,i,r,s)}if(c===u&&ed(e,i,s)){var C=e.prefix||"",A=e.namespaceURI;ef(t,C?"xmlns:"+C:"xmlns",A),s.push({prefix:C,namespace:A})}if(h||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),i&&/^script$/i.test(c))for(;h;)h.data?t.push(h.data):ep(h,t,i,r,s.slice()),h=h.nextSibling;else for(;h;)ep(h,t,i,r,s.slice()),h=h.nextSibling;t.push("</",u,">")}else t.push("/>");return;case w:case E:for(var h=e.firstChild;h;)ep(h,t,i,r,s.slice()),h=h.nextSibling;return;case f:return ef(t,e.name,e.value);case p:return t.push(e.data.replace(/[<&]/g,B).replace(/]]>/g,"]]&gt;"));case g:return t.push("<![CDATA[",e.data,"]]>");case b:return t.push("\x3c!--",e.data,"--\x3e");case _:var R=e.publicId,D=e.systemId;if(t.push("<!DOCTYPE ",e.name),R)t.push(" PUBLIC ",R),D&&"."!=D&&t.push(" ",D),t.push(">");else if(D&&"."!=D)t.push(" SYSTEM ",D,">");else{var O=e.internalSubset;O&&t.push(" [",O,"]"),t.push(">")}return;case y:return t.push("<?",e.target," ",e.data,"?>");case m:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function eg(e,t,i){e[t]=i}T.INVALID_STATE_ERR=(k[11]="Invalid state",11),T.SYNTAX_ERR=(k[12]="Syntax error",12),T.INVALID_MODIFICATION_ERR=(k[13]="Invalid modification",13),T.NAMESPACE_ERR=(k[14]="Invalid namespace",14),T.INVALID_ACCESS_ERR=(k[15]="Invalid access",15),R.prototype=Error.prototype,h(T,R),D.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var i=[],r=0;r<this.length;r++)ep(this[r],i,e,t);return i.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},O.prototype.item=function(e){return N(this),this[e]||null},c(O,D),I.prototype={length:0,item:D.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var i=this[t];if(i.nodeName==e)return i}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new R(A);var i=this.getNamedItem(e.nodeName);return P(this._ownerElement,this,e,i),i},setNamedItemNS:function(e){var t,i=e.ownerElement;if(i&&i!=this._ownerElement)throw new R(A);return t=this.getNamedItemNS(e.namespaceURI,e.localName),P(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return j(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var i=this.getNamedItemNS(e,t);return j(this._ownerElement,this,i),i},getNamedItemNS:function(e,t){for(var i=this.length;i--;){var r=this[i];if(r.localName==t&&r.namespaceURI==e)return r}return null}},U.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,i){var r=new M;if(r.implementation=this,r.childNodes=new D,r.doctype=i||null,i&&r.appendChild(i),t){var s=r.createElementNS(e,t);r.appendChild(s)}return r},createDocumentType:function(e,t,i){var r=new es;return r.name=e,r.nodeName=e,r.publicId=t||"",r.systemId=i||"",r}},q.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Y(this,e,t)},replaceChild:function(e,t){Y(this,e,t,X),t&&this.removeChild(t)},removeChild:function(e){return W(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,i,r){var s=new i.constructor;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var o=i[n];"object"!=typeof o&&o!=s[n]&&(s[n]=o)}switch(i.childNodes&&(s.childNodes=new D),s.ownerDocument=t,s.nodeType){case d:var a=i.attributes,l=s.attributes=new I,h=a.length;l._ownerElement=s;for(var c=0;c<h;c++)s.setAttributeNode(e(t,a.item(c),!0));break;case f:r=!0}if(r)for(var u=i.firstChild;u;)s.appendChild(e(t,u,r)),u=u.nextSibling;return s}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==p&&e.nodeType==p?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var i=t._nsMap;if(i){for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)&&i[r]===e)return r}t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var i=t._nsMap;if(i&&e in i&&Object.prototype.hasOwnProperty.call(i,e))return i[e];t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},h(u,q),h(u,q.prototype),M.prototype={nodeName:"#document",nodeType:w,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==E){for(var i=e.firstChild;i;){var r=i.nextSibling;this.insertBefore(i,t),i=r}return e}return Y(this,e,t),e.ownerDocument=this,null===this.documentElement&&e.nodeType===d&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),W(this,e)},replaceChild:function(e,t){Y(this,e,t,X),e.ownerDocument=this,t&&this.removeChild(t),H(e)&&(this.documentElement=e)},importNode:function(e,t){return function e(t,i,r){var s;switch(i.nodeType){case d:(s=i.cloneNode(!1)).ownerDocument=t;case E:break;case f:r=!0}if(s||(s=i.cloneNode(!1)),s.ownerDocument=t,s.parentNode=null,r)for(var n=i.firstChild;n;)s.appendChild(e(t,n,r)),n=n.nextSibling;return s}(this,e,t)},getElementById:function(e){var t=null;return $(this.documentElement,function(i){if(i.nodeType==d&&i.getAttribute("id")==e)return t=i,!0}),t},getElementsByClassName:function(e){var t=l(e);return new O(this,function(i){var r=[];return t.length>0&&$(i.documentElement,function(s){if(s!==i&&s.nodeType===d){var n=s.getAttribute("class");if(n){var o=e===n;if(!o){var a=l(n);o=t.every(function(e){return a&&-1!==a.indexOf(e)})}o&&r.push(s)}}}),r})},createElement:function(e){var t=new Z;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new D,(t.attributes=new I)._ownerElement=t,t},createDocumentFragment:function(){var e=new el;return e.ownerDocument=this,e.childNodes=new D,e},createTextNode:function(e){var t=new et;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new ei;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new er;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var i=new eh;return i.ownerDocument=this,i.tagName=i.nodeName=i.target=e,i.nodeValue=i.data=t,i},createAttribute:function(e){var t=new Q;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new ea;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var i=new Z,r=t.split(":"),s=i.attributes=new I;return i.childNodes=new D,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=e,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,s._ownerElement=i,i},createAttributeNS:function(e,t){var i=new Q,r=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=e,i.specified=!0,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,i}},c(M,q),Z.prototype={nodeType:d,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var i=this.ownerDocument.createAttribute(e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===E?this.insertBefore(e,null):(e.parentNode&&e.parentNode.removeChild(e),e.parentNode=this,e.previousSibling=this.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:this.firstChild=e,this.lastChild=e,F(this.ownerDocument,this,e),e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);i&&this.removeAttributeNode(i)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);return i&&i.value||""},setAttributeNS:function(e,t,i){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+i,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new O(this,function(t){var i=[];return $(t,function(r){r!==t&&r.nodeType==d&&("*"===e||r.tagName==e)&&i.push(r)}),i})},getElementsByTagNameNS:function(e,t){return new O(this,function(i){var r=[];return $(i,function(s){s!==i&&s.nodeType===d&&("*"===e||s.namespaceURI===e)&&("*"===t||s.localName==t)&&r.push(s)}),r})}},M.prototype.getElementsByTagName=Z.prototype.getElementsByTagName,M.prototype.getElementsByTagNameNS=Z.prototype.getElementsByTagNameNS,c(Z,q),Q.prototype.nodeType=f,c(Q,q),ee.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw Error(k[x])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,i){i=this.data.substring(0,e)+i+this.data.substring(e+t),this.nodeValue=this.data=i,this.length=i.length}},c(ee,q),et.prototype={nodeName:"#text",nodeType:p,splitText:function(e){var t=this.data,i=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(i);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},c(et,ee),ei.prototype={nodeName:"#comment",nodeType:b},c(ei,ee),er.prototype={nodeName:"#cdata-section",nodeType:g},c(er,ee),es.prototype.nodeType=_,c(es,q),en.prototype.nodeType=S,c(en,q),eo.prototype.nodeType=v,c(eo,q),ea.prototype.nodeType=m,c(ea,q),el.prototype.nodeName="#document-fragment",el.prototype.nodeType=E,c(el,q),eh.prototype.nodeType=y,c(eh,q),ec.prototype.serializeToString=function(e,t,i){return eu.call(e,t,i)},q.prototype.toString=eu;try{Object.defineProperty&&(Object.defineProperty(O.prototype,"length",{get:function(){return N(this),this.$$length}}),Object.defineProperty(q.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case d:case E:var i=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&i.push(e(t)),t=t.nextSibling;return i.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case d:case E:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),eg=function(e,t,i){e["$$"+t]=i})}catch(e){}t.DocumentType=es,t.DOMException=R,t.DOMImplementation=U,t.Element=Z,t.Node=q,t.NodeList=D,t.XMLSerializer=ec},2568:(e,t,i)=>{"use strict";var r=i(2965).freeze;t.XML_ENTITIES=r({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=r({Aacute:"\xc1",aacute:"\xe1",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"\xc2",acirc:"\xe2",acute:"\xb4",Acy:"А",acy:"а",AElig:"\xc6",aelig:"\xe6",af:"⁡",Afr:"\uD835\uDD04",afr:"\uD835\uDD1E",Agrave:"\xc0",agrave:"\xe0",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"\xc5",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"\uD835\uDD38",aopf:"\uD835\uDD52",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"\xc5",aring:"\xe5",Ascr:"\uD835\uDC9C",ascr:"\uD835\uDCB6",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"\xc3",atilde:"\xe3",Auml:"\xc4",auml:"\xe4",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"\uD835\uDD05",bfr:"\uD835\uDD1F",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"\uD835\uDD39",bopf:"\uD835\uDD53",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"\xa6",Bscr:"ℬ",bscr:"\uD835\uDCB7",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"\xc7",ccedil:"\xe7",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"\xb8",Cedilla:"\xb8",cemptyv:"⦲",cent:"\xa2",CenterDot:"\xb7",centerdot:"\xb7",Cfr:"ℭ",cfr:"\uD835\uDD20",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"\xae",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"\uD835\uDD54",coprod:"∐",Coproduct:"∐",COPY:"\xa9",copy:"\xa9",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"\uD835\uDC9E",cscr:"\uD835\uDCB8",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"\xa4",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"\xb0",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"\uD835\uDD07",dfr:"\uD835\uDD21",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"\xb4",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"\xa8",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"\xf7",divide:"\xf7",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"\uD835\uDD3B",dopf:"\uD835\uDD55",Dot:"\xa8",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"\xa8",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"\uD835\uDC9F",dscr:"\uD835\uDCB9",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"\xc9",eacute:"\xe9",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"\xca",ecirc:"\xea",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"\uD835\uDD08",efr:"\uD835\uDD22",eg:"⪚",Egrave:"\xc8",egrave:"\xe8",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"\uD835\uDD3C",eopf:"\uD835\uDD56",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"\xd0",eth:"\xf0",Euml:"\xcb",euml:"\xeb",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"\uD835\uDD09",ffr:"\uD835\uDD23",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"\uD835\uDD3D",fopf:"\uD835\uDD57",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"\xbd",frac13:"⅓",frac14:"\xbc",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"\xbe",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"\uD835\uDCBB",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"\uD835\uDD0A",gfr:"\uD835\uDD24",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"\uD835\uDD3E",gopf:"\uD835\uDD58",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"\uD835\uDCA2",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"\xbd",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"\uD835\uDD25",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"\uD835\uDD59",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"\uD835\uDCBD",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"\xcd",iacute:"\xed",ic:"⁣",Icirc:"\xce",icirc:"\xee",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"\xa1",iff:"⇔",Ifr:"ℑ",ifr:"\uD835\uDD26",Igrave:"\xcc",igrave:"\xec",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"\uD835\uDD40",iopf:"\uD835\uDD5A",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"\xbf",Iscr:"ℐ",iscr:"\uD835\uDCBE",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"\xcf",iuml:"\xef",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"\uD835\uDD0D",jfr:"\uD835\uDD27",jmath:"ȷ",Jopf:"\uD835\uDD41",jopf:"\uD835\uDD5B",Jscr:"\uD835\uDCA5",jscr:"\uD835\uDCBF",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"\uD835\uDD0E",kfr:"\uD835\uDD28",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"\uD835\uDD42",kopf:"\uD835\uDD5C",Kscr:"\uD835\uDCA6",kscr:"\uD835\uDCC0",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"\xab",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"\uD835\uDD0F",lfr:"\uD835\uDD29",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"\uD835\uDD43",lopf:"\uD835\uDD5D",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"\uD835\uDCC1",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"\xaf",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"\uD835\uDD10",mfr:"\uD835\uDD2A",mho:"℧",micro:"\xb5",mid:"∣",midast:"*",midcir:"⫰",middot:"\xb7",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"\uD835\uDD44",mopf:"\uD835\uDD5E",mp:"∓",Mscr:"ℳ",mscr:"\uD835\uDCC2",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:"\xa0",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"\uD835\uDD11",nfr:"\uD835\uDD2B",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:"\xa0",Nopf:"ℕ",nopf:"\uD835\uDD5F",Not:"⫬",not:"\xac",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"\uD835\uDCA9",nscr:"\uD835\uDCC3",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"\xd1",ntilde:"\xf1",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"\xd3",oacute:"\xf3",oast:"⊛",ocir:"⊚",Ocirc:"\xd4",ocirc:"\xf4",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"\uD835\uDD12",ofr:"\uD835\uDD2C",ogon:"˛",Ograve:"\xd2",ograve:"\xf2",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"\uD835\uDD46",oopf:"\uD835\uDD60",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"\xaa",ordm:"\xba",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"\uD835\uDCAA",oscr:"ℴ",Oslash:"\xd8",oslash:"\xf8",osol:"⊘",Otilde:"\xd5",otilde:"\xf5",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"\xd6",ouml:"\xf6",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"\xb6",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"\uD835\uDD13",pfr:"\uD835\uDD2D",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"\xb1",plusmn:"\xb1",plussim:"⨦",plustwo:"⨧",pm:"\xb1",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"\uD835\uDD61",pound:"\xa3",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"\uD835\uDCAB",pscr:"\uD835\uDCC5",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"\uD835\uDD14",qfr:"\uD835\uDD2E",qint:"⨌",Qopf:"ℚ",qopf:"\uD835\uDD62",qprime:"⁗",Qscr:"\uD835\uDCAC",qscr:"\uD835\uDCC6",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"\xbb",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"\xae",reg:"\xae",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"\uD835\uDD2F",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"\uD835\uDD63",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"\uD835\uDCC7",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"\xa7",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"\uD835\uDD16",sfr:"\uD835\uDD30",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"\xad",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"\uD835\uDD4A",sopf:"\uD835\uDD64",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"\uD835\uDCAE",sscr:"\uD835\uDCC8",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"\xaf",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"\xb9",sup2:"\xb2",sup3:"\xb3",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"\xdf",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"\uD835\uDD17",tfr:"\uD835\uDD31",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"\xde",thorn:"\xfe",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"\xd7",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"\uD835\uDD4B",topf:"\uD835\uDD65",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"\uD835\uDCAF",tscr:"\uD835\uDCC9",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"\xda",uacute:"\xfa",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"\xdb",ucirc:"\xfb",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"\uD835\uDD18",ufr:"\uD835\uDD32",Ugrave:"\xd9",ugrave:"\xf9",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"\xa8",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"\uD835\uDD4C",uopf:"\uD835\uDD66",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"\uD835\uDCB0",uscr:"\uD835\uDCCA",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"\xdc",uuml:"\xfc",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"\uD835\uDD19",vfr:"\uD835\uDD33",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"\uD835\uDD4D",vopf:"\uD835\uDD67",vprop:"∝",vrtri:"⊳",Vscr:"\uD835\uDCB1",vscr:"\uD835\uDCCB",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"\uD835\uDD1A",wfr:"\uD835\uDD34",Wopf:"\uD835\uDD4E",wopf:"\uD835\uDD68",wp:"℘",wr:"≀",wreath:"≀",Wscr:"\uD835\uDCB2",wscr:"\uD835\uDCCC",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"\uD835\uDD1B",xfr:"\uD835\uDD35",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"\uD835\uDD4F",xopf:"\uD835\uDD69",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"\uD835\uDCB3",xscr:"\uD835\uDCCD",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"\xdd",yacute:"\xfd",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"\xa5",Yfr:"\uD835\uDD1C",yfr:"\uD835\uDD36",YIcy:"Ї",yicy:"ї",Yopf:"\uD835\uDD50",yopf:"\uD835\uDD6A",Yscr:"\uD835\uDCB4",yscr:"\uD835\uDCCE",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"\xff",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"\uD835\uDD37",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"\uD835\uDD6B",Zscr:"\uD835\uDCB5",zscr:"\uD835\uDCCF",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES},3093:(e,t,i)=>{var r=i(6869);r.DOMImplementation,r.XMLSerializer,t.DOMParser=i(7875).DOMParser},7093:(e,t,i)=>{var r=i(2965).NAMESPACE,s=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=RegExp("[\\-\\.0-9"+s.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=RegExp("^"+s.source+n.source+"*(?::"+s.source+n.source+"*)?$");function a(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,a)}function l(){}function h(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function c(e,t,i){for(var s=e.tagName,n=null,o=e.length;o--;){var a=e[o],l=a.qName,h=a.value,c=l.indexOf(":");if(c>0)var d=a.prefix=l.slice(0,c),f=l.slice(c+1),p="xmlns"===d&&f;else f=l,d=null,p="xmlns"===l&&"";a.localName=f,!1!==p&&(null==n&&(n={},u(i,i={})),i[p]=n[p]=h,a.uri=r.XMLNS,t.startPrefixMapping(p,h))}for(var o=e.length;o--;){var d=(a=e[o]).prefix;d&&("xml"===d&&(a.uri=r.XML),"xmlns"!==d&&(a.uri=i[d||""]))}var c=s.indexOf(":");c>0?(d=e.prefix=s.slice(0,c),f=e.localName=s.slice(c+1)):(d=null,f=e.localName=s);var g=e.uri=i[d||""];if(t.startElement(g,f,s,e),!e.closed)return e.currentNSMap=i,e.localNSMap=n,!0;if(t.endElement(g,f,s),n)for(d in n)Object.prototype.hasOwnProperty.call(n,d)&&t.endPrefixMapping(d)}function u(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}function d(){this.attributeNames={}}a.prototype=Error(),a.prototype.name=a.name,l.prototype={parse:function(e,t,i){var s=this.domBuilder;s.startDocument(),u(t,t={}),function(e,t,i,s,n){function o(e){var t,r=e.slice(1,-1);return r in i?i[r]:"#"!==r.charAt(0)?(n.error("entity not found:"+e),e):(t=parseInt(r.substr(1).replace("x","0x")))>65535?String.fromCharCode(55296+((t-=65536)>>10),56320+(1023&t)):String.fromCharCode(t)}function l(t){if(t>b){var i=e.substring(b,t).replace(/&#?\w+;/g,o);m&&u(b),s.characters(i,0,t-b),b=t}}function u(t,i){for(;t>=p&&(i=g.exec(e));)p=(f=i.index)+i[0].length,m.lineNumber++;m.columnNumber=t-f+1}for(var f=0,p=0,g=/.*(?:\r\n?|\n)|.*$/g,m=s.locator,v=[{currentNSMap:t}],y={},b=0;;){try{var w=e.indexOf("<",b);if(w<0){if(!e.substr(b).match(/^\s*$/)){var _=s.doc,E=_.createTextNode(e.substr(b));_.appendChild(E),s.currentElement=E}return}switch(w>b&&l(w),e.charAt(w+1)){case"/":var S=e.indexOf(">",w+3),T=e.substring(w+2,S).replace(/[ \t\n\r]+$/g,""),k=v.pop();S<0?(T=e.substring(w+2).replace(/[\s<].*/,""),n.error("end tag name: "+T+" is not complete:"+k.tagName),S=w+1+T.length):T.match(/\s</)&&(T=T.replace(/[\s<].*/,""),n.error("end tag name: "+T+" maybe not complete"),S=w+1+T.length);var x=k.localNSMap,C=k.tagName==T;if(C||k.tagName&&k.tagName.toLowerCase()==T.toLowerCase()){if(s.endElement(k.uri,k.localName,T),x)for(var A in x)Object.prototype.hasOwnProperty.call(x,A)&&s.endPrefixMapping(A);C||n.fatalError("end tag name: "+T+" is not match the current start tagName:"+k.tagName)}else v.push(k);S++;break;case"?":m&&u(w),S=function(e,t,i){var r=e.indexOf("?>",t);if(r){var s=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(s)return s[0].length,i.processingInstruction(s[1],s[2]),r+2}return -1}(e,w,s);break;case"!":m&&u(w),S=function(e,t,i,r){if("-"===e.charAt(t+2)){if("-"===e.charAt(t+3)){var s=e.indexOf("--\x3e",t+4);if(s>t)return i.comment(e,t+4,s-t-4),s+3;r.error("Unclosed comment")}}else{if("CDATA["==e.substr(t+3,6)){var s=e.indexOf("]]>",t+9);return i.startCDATA(),i.characters(e,t+9,s-t-9),i.endCDATA(),s+3}var n=function(e,t){var i,r=[],s=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(s.lastIndex=t,s.exec(e);i=s.exec(e);)if(r.push(i),i[1])return r}(e,t),o=n.length;if(o>1&&/!doctype/i.test(n[0][0])){var a=n[1][0],l=!1,h=!1;o>3&&(/^public$/i.test(n[2][0])?(l=n[3][0],h=o>4&&n[4][0]):/^system$/i.test(n[2][0])&&(h=n[3][0]));var c=n[o-1];return i.startDTD(a,l,h),i.endDTD(),c.index+c[0].length}}return -1}(e,w,s,n);break;default:m&&u(w);var R=new d,D=v[v.length-1].currentNSMap,S=function(e,t,i,s,n,o){function a(e,t,r){i.attributeNames.hasOwnProperty(e)&&o.fatalError("Attribute "+e+" redefined"),i.addValue(e,t,r)}for(var l,h,c=++t,u=0;;){var d=e.charAt(c);switch(d){case"=":if(1===u)l=e.slice(t,c),u=3;else if(2===u)u=3;else throw Error("attribute equal must after attrName");break;case"'":case'"':if(3===u||1===u){if(1===u&&(o.warning('attribute value must after "="'),l=e.slice(t,c)),t=c+1,(c=e.indexOf(d,t))>0)a(l,h=e.slice(t,c).replace(/&#?\w+;/g,n),t-1),u=5;else throw Error("attribute value no end '"+d+"' match")}else if(4==u)a(l,h=e.slice(t,c).replace(/&#?\w+;/g,n),t),o.warning('attribute "'+l+'" missed start quot('+d+")!!"),t=c+1,u=5;else throw Error('attribute value must after "="');break;case"/":switch(u){case 0:i.setTagName(e.slice(t,c));case 5:case 6:case 7:u=7,i.closed=!0;case 4:case 1:break;case 2:i.closed=!0;break;default:throw Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),0==u&&i.setTagName(e.slice(t,c)),c;case">":switch(u){case 0:i.setTagName(e.slice(t,c));case 5:case 6:case 7:break;case 4:case 1:"/"===(h=e.slice(t,c)).slice(-1)&&(i.closed=!0,h=h.slice(0,-1));case 2:2===u&&(h=l),4==u?(o.warning('attribute "'+h+'" missed quot(")!'),a(l,h.replace(/&#?\w+;/g,n),t)):(r.isHTML(s[""])&&h.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+h+'" missed value!! "'+h+'" instead!!'),a(h,h,t));break;case 3:throw Error("attribute value missed!!")}return c;case"\x80":d=" ";default:if(d<=" ")switch(u){case 0:i.setTagName(e.slice(t,c)),u=6;break;case 1:l=e.slice(t,c),u=2;break;case 4:var h=e.slice(t,c).replace(/&#?\w+;/g,n);o.warning('attribute "'+h+'" missed quot(")!!'),a(l,h,t);case 5:u=6}else switch(u){case 2:i.tagName,r.isHTML(s[""])&&l.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),a(l,l,t),t=c,u=1;break;case 5:o.warning('attribute space is required"'+l+'"!!');case 6:u=1,t=c;break;case 3:u=4,t=c;break;case 7:throw Error("elements closed character '/' and '>' must be connected to")}}c++}}(e,w,R,D,o,n),O=R.length;if(!R.closed&&function(e,t,i,r){var s=r[i];return null==s&&((s=e.lastIndexOf("</"+i+">"))<t&&(s=e.lastIndexOf("</"+i)),r[i]=s),s<t}(e,S,R.tagName,y)&&(R.closed=!0,i.nbsp||n.warning("unclosed xml attribute")),m&&O){for(var N=h(m,{}),I=0;I<O;I++){var L=R[I];u(L.offset),L.locator=h(m,{})}s.locator=N,c(R,s,D)&&v.push(R),s.locator=m}else c(R,s,D)&&v.push(R);r.isHTML(R.uri)&&!R.closed?S=function(e,t,i,r,s){if(/^(?:script|textarea)$/i.test(i)){var n=e.indexOf("</"+i+">",t),o=e.substring(t+1,n);if(/[&<]/.test(o))return/^script$/i.test(i)||(o=o.replace(/&#?\w+;/g,r)),s.characters(o,0,o.length),n}return t+1}(e,S,R.tagName,o,s):S++}}catch(e){if(e instanceof a)throw e;n.error("element parse error: "+e),S=-1}S>b?b=S:l(Math.max(w,b)+1)}}(e,t,i,s,this.errorHandler),s.endDocument()}},d.prototype={setTagName:function(e){if(!o.test(e))throw Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,i){if(!o.test(e))throw Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:i}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=l,t.ParseError=a},589:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),i=t[0],r=t[1];return(i+r)*3/4-r},t.toByteArray=function(e){var t,i,n=l(e),o=n[0],a=n[1],h=new s((o+a)*3/4-a),c=0,u=a>0?o-4:o;for(i=0;i<u;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],h[c++]=t>>16&255,h[c++]=t>>8&255,h[c++]=255&t;return 2===a&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,h[c++]=255&t),1===a&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,h[c++]=t>>8&255,h[c++]=255&t),h},t.fromByteArray=function(e){for(var t,r=e.length,s=r%3,n=[],o=0,a=r-s;o<a;o+=16383)n.push(function(e,t,r){for(var s,n=[],o=t;o<r;o+=3)n.push(i[(s=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return n.join("")}(e,o,o+16383>a?a:o+16383));return 1===s?n.push(i[(t=e[r-1])>>2]+i[t<<4&63]+"=="):2===s&&n.push(i[(t=(e[r-2]<<8)+e[r-1])>>10]+i[t>>4&63]+i[t<<2&63]+"="),n.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)i[o]=n[o],r[n.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var r=i===t?0:4-i%4;return[i,r]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},3388:(e,t,i)=>{"use strict";var r=i(589),s=i(8056),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,i){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return l(e,t,i)}function l(e,t,i){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw TypeError("Unknown encoding: "+t);var i=0|p(e,t),r=o(i),s=r.write(e,t);return s!==i&&(r=r.slice(0,s)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(R(e,Uint8Array)){var t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(R(e,ArrayBuffer)||e&&R(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(R(e,SharedArrayBuffer)||e&&R(e.buffer,SharedArrayBuffer)))return d(e,t,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return a.from(r,t,i);var s=function(e){if(a.isBuffer(e)){var t,i=0|f(e.length),r=o(i);return 0===r.length||e.copy(r,0,0,i),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?o(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return h(e),o(e<0?0:0|f(e))}function u(e){for(var t=e.length<0?0:0|f(e.length),i=o(t),r=0;r<t;r+=1)i[r]=255&e[r];return i}function d(e,t,i){var r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),a.prototype),r}function f(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||R(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;for(var s=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return C(e).length;default:if(s)return r?-1:x(e).length;t=(""+t).toLowerCase(),s=!0}}function g(e,t,i){var s,n,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0||(i>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,i){var r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);for(var s="",n=t;n<i;++n)s+=D[e[n]];return s}(this,t,i);case"utf8":case"utf-8":return b(this,t,i);case"ascii":return function(e,t,i){var r="";i=Math.min(e.length,i);for(var s=t;s<i;++s)r+=String.fromCharCode(127&e[s]);return r}(this,t,i);case"latin1":case"binary":return function(e,t,i){var r="";i=Math.min(e.length,i);for(var s=t;s<i;++s)r+=String.fromCharCode(e[s]);return r}(this,t,i);case"base64":return s=t,n=i,0===s&&n===this.length?r.fromByteArray(this):r.fromByteArray(this.slice(s,n));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,i){for(var r=e.slice(t,i),s="",n=0;n<r.length-1;n+=2)s+=String.fromCharCode(r[n]+256*r[n+1]);return s}(this,t,i);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function m(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function v(e,t,i,r,s){var n;if(0===e.length)return -1;if("string"==typeof i?(r=i,i=0):i>0x7fffffff?i=0x7fffffff:i<-0x80000000&&(i=-0x80000000),(n=i=+i)!=n&&(i=s?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(s)return -1;i=e.length-1}else if(i<0){if(!s)return -1;i=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:y(e,t,i,r,s);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?s?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):y(e,[t],i,r,s);throw TypeError("val must be string, number or Buffer")}function y(e,t,i,r,s){var n,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,i/=2}function h(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){var c=-1;for(n=i;n<a;n++)if(h(e,n)===h(t,-1===c?0:n-c)){if(-1===c&&(c=n),n-c+1===l)return c*o}else -1!==c&&(n-=n-c),c=-1}else for(i+l>a&&(i=a-l),n=i;n>=0;n--){for(var u=!0,d=0;d<l;d++)if(h(e,n+d)!==h(t,d)){u=!1;break}if(u)return n}return -1}function b(e,t,i){i=Math.min(e.length,i);for(var r=[],s=t;s<i;){var n,o,a,l,h=e[s],c=null,u=h>239?4:h>223?3:h>191?2:1;if(s+u<=i)switch(u){case 1:h<128&&(c=h);break;case 2:(192&(n=e[s+1]))==128&&(l=(31&h)<<6|63&n)>127&&(c=l);break;case 3:n=e[s+1],o=e[s+2],(192&n)==128&&(192&o)==128&&(l=(15&h)<<12|(63&n)<<6|63&o)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:n=e[s+1],o=e[s+2],a=e[s+3],(192&n)==128&&(192&o)==128&&(192&a)==128&&(l=(15&h)<<18|(63&n)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,u=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),s+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var i="",r=0;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return i}(r)}function w(e,t,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>i)throw RangeError("Trying to access beyond buffer length")}function _(e,t,i,r,s,n){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<n)throw RangeError('"value" argument is out of bounds');if(i+r>e.length)throw RangeError("Index out of range")}function E(e,t,i,r,s,n){if(i+r>e.length||i<0)throw RangeError("Index out of range")}function S(e,t,i,r,n){return t=+t,i>>>=0,n||E(e,t,i,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,i,r,23,4),i+4}function T(e,t,i,r,n){return t=+t,i>>>=0,n||E(e,t,i,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,i,r,52,8),i+8}t.hp=a,t.IS=50,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,i){return l(e,t,i)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,i){return(h(e),e<=0)?o(e):void 0!==t?"string"==typeof i?o(e).fill(t,i):o(e).fill(t):o(e)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(R(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),R(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,r=t.length,s=0,n=Math.min(i,r);s<n;++s)if(e[s]!==t[s]){i=e[s],r=t[s];break}return i<r?-1:r<i?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(i=0,t=0;i<e.length;++i)t+=e[i].length;var i,r=a.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){var n=e[i];if(R(n,Uint8Array))s+n.length>r.length?a.from(n).copy(r,s):Uint8Array.prototype.set.call(r,n,s);else if(a.isBuffer(n))n.copy(r,s);else throw TypeError('"list" argument must be an Array of Buffers');s+=n.length}return r},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?b(this,0,e):g.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",i=t.IS;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,i,r,s){if(R(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||i>e.length||r<0||s>this.length)throw RangeError("out of range index");if(r>=s&&t>=i)return 0;if(r>=s)return -1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,s>>>=0,this===e)return 0;for(var n=s-r,o=i-t,l=Math.min(n,o),h=this.slice(r,s),c=e.slice(t,i),u=0;u<l;++u)if(h[u]!==c[u]){n=h[u],o=c[u];break}return n<o?-1:o<n?1:0},a.prototype.includes=function(e,t,i){return -1!==this.indexOf(e,t,i)},a.prototype.indexOf=function(e,t,i){return v(this,e,t,i,!0)},a.prototype.lastIndexOf=function(e,t,i){return v(this,e,t,i,!1)},a.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s,n,o,a,l,h,c,u,d=this.length-t;if((void 0===i||i>d)&&(i=d),e.length>0&&(i<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var f=!1;;)switch(r){case"hex":return function(e,t,i,r){i=Number(i)||0;var s=e.length-i;r?(r=Number(r))>s&&(r=s):r=s;var n=t.length;r>n/2&&(r=n/2);for(var o=0;o<r;++o){var a=parseInt(t.substr(2*o,2),16);if(a!=a)break;e[i+o]=a}return o}(this,e,t,i);case"utf8":case"utf-8":return s=t,n=i,A(x(e,this.length-s),this,s,n);case"ascii":case"latin1":case"binary":return o=t,a=i,A(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(e),this,o,a);case"base64":return l=t,h=i,A(C(e),this,l,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c=t,u=i,A(function(e,t){for(var i,r,s=[],n=0;n<e.length&&!((t-=2)<0);++n)r=(i=e.charCodeAt(n))>>8,s.push(i%256),s.push(r);return s}(e,this.length-c),this,c,u);default:if(f)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){var i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var r=this[e],s=1,n=0;++n<t&&(s*=256);)r+=this[e+n]*s;return r},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var r=this[e+--t],s=1;t>0&&(s*=256);)r+=this[e+--t]*s;return r},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var r=this[e],s=1,n=0;++n<t&&(s*=256);)r+=this[e+n]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var r=t,s=1,n=this[e+--r];r>0&&(s*=256);)n+=this[e+--r]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readInt8=function(e,t){return(e>>>=0,t||w(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?0xffff0000|i:i},a.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?0xffff0000|i:i},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),s.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),s.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),s.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),s.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,i,r){if(e=+e,t>>>=0,i>>>=0,!r){var s=Math.pow(2,8*i)-1;_(this,e,t,i,s,0)}var n=1,o=0;for(this[t]=255&e;++o<i&&(n*=256);)this[t+o]=e/n&255;return t+i},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,i,r){if(e=+e,t>>>=0,i>>>=0,!r){var s=Math.pow(2,8*i)-1;_(this,e,t,i,s,0)}var n=i-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+i},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var s=Math.pow(2,8*i-1);_(this,e,t,i,s-1,-s)}var n=0,o=1,a=0;for(this[t]=255&e;++n<i&&(o*=256);)e<0&&0===a&&0!==this[t+n-1]&&(a=1),this[t+n]=(e/o>>0)-a&255;return t+i},a.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var s=Math.pow(2,8*i-1);_(this,e,t,i,s-1,-s)}var n=i-1,o=1,a=0;for(this[t+n]=255&e;--n>=0&&(o*=256);)e<0&&0===a&&0!==this[t+n+1]&&(a=1),this[t+n]=(e/o>>0)-a&255;return t+i},a.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||_(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,i){return S(this,e,t,!0,i)},a.prototype.writeFloatBE=function(e,t,i){return S(this,e,t,!1,i)},a.prototype.writeDoubleLE=function(e,t,i){return T(this,e,t,!0,i)},a.prototype.writeDoubleBE=function(e,t,i){return T(this,e,t,!1,i)},a.prototype.copy=function(e,t,i,r){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var s=r-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),s},a.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){var s,n=e.charCodeAt(0);("utf8"===r&&n<128||"latin1"===r)&&(e=n)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var o=a.isBuffer(e)?e:a.from(e,r),l=o.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%l]}return this};var k=/[^+/0-9A-Za-z-_]/g;function x(e,t){t=t||1/0;for(var i,r=e.length,s=null,n=[],o=0;o<r;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!s){if(i>56319||o+1===r){(t-=3)>-1&&n.push(239,191,189);continue}s=i;continue}if(i<56320){(t-=3)>-1&&n.push(239,191,189),s=i;continue}i=(s-55296<<10|i-56320)+65536}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,i<128){if((t-=1)<0)break;n.push(i)}else if(i<2048){if((t-=2)<0)break;n.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;n.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((t-=4)<0)break;n.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return n}function C(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,i,r){for(var s=0;s<r&&!(s+i>=t.length)&&!(s>=e.length);++s)t[s+i]=e[s];return s}function R(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var D=function(){for(var e="0123456789abcdef",t=Array(256),i=0;i<16;++i)for(var r=16*i,s=0;s<16;++s)t[r+s]=e[i]+e[s];return t}()},560:(e,t,i)=>{"use strict";var r=i(136),s=i(9674),n=i(5171),o=i(6293),a=i(4605);(e.exports=function(e,t){var i,s,l,h,c;return arguments.length<2||"string"!=typeof e?(h=t,t=e,e=null):h=arguments[2],r(e)?(i=a.call(e,"c"),s=a.call(e,"e"),l=a.call(e,"w")):(i=l=!0,s=!1),c={value:t,configurable:i,enumerable:s,writable:l},h?n(o(h),c):c}).gs=function(e,t,i){var l,h,c,u;return"string"!=typeof e?(c=i,i=t,t=e,e=null):c=arguments[3],r(t)?s(t)?r(i)?s(i)||(c=i,i=void 0):i=void 0:(c=t,t=i=void 0):t=void 0,r(e)?(l=a.call(e,"c"),h=a.call(e,"e")):(l=!0,h=!1),u={get:t,set:i,configurable:l,enumerable:h},c?n(o(c),u):u}},2569:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>eQ});var r={};i.r(r),i.d(r,{RangeObject:()=>G,blob2base64:()=>$,borders:()=>_,bounds:()=>w,createBase64Url:()=>O,createBlob:()=>A,createBlobUrl:()=>R,defaults:()=>g,defer:()=>M,documentHeight:()=>c,extend:()=>m,filterChildren:()=>V,findChildren:()=>F,getParentByTagName:()=>H,indexOfElementNode:()=>x,indexOfNode:()=>T,indexOfSorted:()=>b,indexOfTextNode:()=>k,insert:()=>v,isElement:()=>u,isFloat:()=>f,isNumber:()=>d,isXml:()=>C,locationOf:()=>y,nodeBounds:()=>E,parents:()=>W,parse:()=>I,prefixed:()=>p,qs:()=>L,qsa:()=>P,qsp:()=>j,querySelectorByType:()=>z,requestAnimationFrame:()=>a,revokeBlobUrl:()=>D,sprint:()=>U,treeWalker:()=>q,type:()=>N,uuid:()=>h,walk:()=>B,windowBounds:()=>S});var s=i(2235),n=i.n(s),o=i(3093);let a="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),l="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function h(){var e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:7&i|8).toString(16)})}function c(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function u(e){return!!(e&&1==e.nodeType)}function d(e){return!isNaN(parseFloat(e))&&isFinite(e)}function f(e){let t=parseFloat(e);return!1!==d(e)&&(!!("string"==typeof e&&e.indexOf(".")>-1)||Math.floor(t)!==t)}function p(e){var t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=e.toLowerCase();if("undefined"==typeof document||void 0!==document.body.style[i])return e;for(var r=0;r<5;r++)if(void 0!==document.body.style[t[r]+i])return t[r]+i;return e}function g(e){for(var t=1,i=arguments.length;t<i;t++){var r=arguments[t];for(var s in r)void 0===e[s]&&(e[s]=r[s])}return e}function m(e){var t=[].slice.call(arguments,1);return t.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}),e}function v(e,t,i){var r=y(e,t,i);return t.splice(r,0,e),r}function y(e,t,i,r,s){var n,o=r||0,a=s||t.length,l=parseInt(o+(a-o)/2);return(i||(i=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0}),a-o<=0)?l:(n=i(t[l],e),a-o==1)?n>=0?l:l+1:0===n?l:-1===n?y(e,t,i,l,a):y(e,t,i,o,l)}function b(e,t,i,r,s){var n,o=r||0,a=s||t.length,l=parseInt(o+(a-o)/2);return(i||(i=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0}),a-o<=0)?-1:(n=i(t[l],e),a-o==1)?0===n?l:-1:0===n?l:-1===n?b(e,t,i,l,a):b(e,t,i,o,l)}function w(e){var t=window.getComputedStyle(e),i=0,r=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach(function(e){i+=parseFloat(t[e])||0}),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach(function(e){r+=parseFloat(t[e])||0}),{height:r,width:i}}function _(e){var t=window.getComputedStyle(e),i=0,r=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach(function(e){i+=parseFloat(t[e])||0}),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach(function(e){r+=parseFloat(t[e])||0}),{height:r,width:i}}function E(e){let t;let i=e.ownerDocument;if(e.nodeType==Node.TEXT_NODE){let r=i.createRange();r.selectNodeContents(e),t=r.getBoundingClientRect()}else t=e.getBoundingClientRect();return t}function S(){var e=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function T(e,t){for(var i,r=e.parentNode.childNodes,s=-1,n=0;n<r.length&&((i=r[n]).nodeType===t&&s++,i!=e);n++);return s}function k(e){return T(e,3)}function x(e){return T(e,1)}function C(e){return["xml","opf","ncx"].indexOf(e)>-1}function A(e,t){return new Blob([e],{type:t})}function R(e,t){var i=A(e,t);return l.createObjectURL(i)}function D(e){return l.revokeObjectURL(e)}function O(e,t){if("string"==typeof e)return"data:"+t+";base64,"+btoa(e)}function N(e){return Object.prototype.toString.call(e).slice(8,-1)}function I(e,t,i){var r;return"undefined"==typeof DOMParser||i?r=o.DOMParser:r=DOMParser,65279===e.charCodeAt(0)&&(e=e.slice(1)),new r().parseFromString(e,t)}function L(e,t){var i;if(!e)throw Error("No Element Provided");return void 0!==e.querySelector?e.querySelector(t):(i=e.getElementsByTagName(t)).length?i[0]:void 0}function P(e,t){return void 0!==e.querySelector?e.querySelectorAll(t):e.getElementsByTagName(t)}function j(e,t,i){var r,s;if(void 0!==e.querySelector){for(var n in t+="[",i)t+=n+"~='"+i[n]+"'";return t+="]",e.querySelector(t)}if(r=e.getElementsByTagName(t),s=Array.prototype.slice.call(r,0).filter(function(e){for(var t in i)if(e.getAttribute(t)===i[t])return!0;return!1}))return s[0]}function U(e,t){void 0!==(e.ownerDocument||e).createTreeWalker?q(e,t,NodeFilter.SHOW_TEXT):B(e,function(e){e&&3===e.nodeType&&t(e)},!0)}function q(e,t,i){let r;for(var s=document.createTreeWalker(e,i,null,!1);r=s.nextNode();)t(r)}function B(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(B(e,t))return!0;e=e.nextSibling}while(e)}function $(e){return new Promise(function(t,i){var r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t(r.result)}})}function M(){this.resolve=null,this.reject=null,this.id=h(),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),Object.freeze(this)}function z(e,t,i){var r;if(void 0!==e.querySelector&&(r=e.querySelector(`${t}[*|type="${i}"]`)),r&&0!==r.length)return r;r=P(e,t);for(var s=0;s<r.length;s++)if(r[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===i||r[s].getAttribute("epub:type")===i)return r[s]}function F(e){for(var t=[],i=e.childNodes,r=0;r<i.length;r++){let e=i[r];1===e.nodeType&&t.push(e)}return t}function W(e){for(var t=[e];e;e=e.parentNode)t.unshift(e);return t}function V(e,t,i){for(var r=[],s=e.childNodes,n=0;n<s.length;n++){let e=s[n];if(1===e.nodeType&&e.nodeName.toLowerCase()===t){if(i)return e;r.push(e)}}if(!i)return r}function H(e,t){let i;if(null!==e&&""!==t)for(i=e.parentNode;1===i.nodeType;){if(i.tagName.toLowerCase()===t)return i;i=i.parentNode}}class G{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,i=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,i),this.setEnd(t,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=3===e.nodeType?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var i=W(e||this.startContainer),r=W(t||this.endContainer);if(i[0]==r[0]){for(var s=0;s<i.length;s++)if(i[s]!=r[s])return i[s-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}var K=i(8462),J=i.n(K);class X{constructor(e){var t;e.indexOf("://")>-1&&(e=new URL(e).pathname),t=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=t.dir+"/",this.filename=t.base,this.extension=t.ext.slice(1)}parse(e){return J().parse(e)}isAbsolute(e){return J().isAbsolute(e||this.path)}isDirectory(e){return"/"===e.charAt(e.length-1)}resolve(e){return J().resolve(this.directory,e)}relative(e){return e&&e.indexOf("://")>-1?e:J().relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class Y{constructor(e,t){var i=e.indexOf("://")>-1,r=e;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!i&&!1!==t&&"string"!=typeof t&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,r=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(e){this.Url=void 0,this.base&&(r=new X(this.base).resolve(r))}this.Path=new X(r),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t;return e.indexOf("://")>-1?e:(t=J().resolve(this.directory,e),this.origin+t)}relative(e){return J().relative(e,this.directory)}toString(){return this.href}}class Z{constructor(e,t,i){var r;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Z))return new Z(e,t,i);if("string"==typeof t?this.base=this.parseComponent(t):"object"==typeof t&&t.steps&&(this.base=t),"string"===(r=this.checkType(e)))return this.str=e,m(this,this.parse(e));if("range"===r)return m(this,this.fromRange(e,this.base,i));if("node"===r)return m(this,this.fromNode(e,this.base,i));if("EpubCFI"===r&&e.path)return e;else if(!e)return this;else throw TypeError("not a valid argument for EpubCFI")}checkType(e){return this.isCfiString(e)?"string":e&&"object"==typeof e&&("Range"===N(e)||void 0!==e.startContainer)?"range":e&&"object"==typeof e&&void 0!==e.nodeType?"node":!!e&&"object"==typeof e&&e instanceof Z&&"EpubCFI"}parse(e){var t,i,r,s={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof e?{spinePos:-1}:(0===e.indexOf("epubcfi(")&&")"===e[e.length-1]&&(e=e.slice(8,e.length-1)),t=this.getChapterComponent(e))?(s.base=this.parseComponent(t),i=this.getPathComponent(e),s.path=this.parseComponent(i),(r=this.getRange(e))&&(s.range=!0,s.start=this.parseComponent(r[0]),s.end=this.parseComponent(r[1])),s.spinePos=s.base.steps[1].index,s):{spinePos:-1}}parseComponent(e){var t,i={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),s=r[0].split("/");return r.length>1&&(t=r[1],i.terminal=this.parseTerminal(t)),""===s[0]&&s.shift(),i.steps=s.map((function(e){return this.parseStep(e)}).bind(this)),i}parseStep(e){var t,i,r,s,n;if((s=e.match(/\[(.*)\]/))&&s[1]&&(n=s[1]),!isNaN(i=parseInt(e)))return i%2==0?(t="element",r=i/2-1):(t="text",r=(i-1)/2),{type:t,index:r,id:n||null}}parseTerminal(e){var t,i,r=e.match(/\[(.*)\]/);return r&&r[1]?(t=parseInt(e.split("[")[0]),i=r[1]):t=parseInt(e),d(t)||(t=null),{offset:t,assertion:i}}getChapterComponent(e){return e.split("!")[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return 3===t.length&&[t[1],t[2]]}getCharecterOffsetComponent(e){return e.split(":")[1]||""}joinSteps(e){return e?e.map(function(e){var t="";return"element"===e.type&&(t+=(e.index+1)*2),"text"===e.type&&(t+=1+2*e.index),e.id&&(t+="["+e.id+"]"),t}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&null!=e.terminal.offset&&(t+=":"+e.terminal.offset),e.terminal&&null!=e.terminal.assertion&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")"}compare(e,t){if("string"==typeof e&&(e=new Z(e)),"string"==typeof t&&(t=new Z(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return -1;e.range?(i=e.path.steps.concat(e.start.steps),s=e.start.terminal):(i=e.path.steps,s=e.path.terminal),t.range?(r=t.path.steps.concat(t.start.steps),n=t.start.terminal):(r=t.path.steps,n=t.path.terminal);for(var i,r,s,n,o=0;o<i.length;o++){if(!i[o])return -1;if(!r[o]||i[o].index>r[o].index)return 1;if(i[o].index<r[o].index)return -1}return i.length<r.length?-1:s.offset>n.offset?1:s.offset<n.offset?-1:0}step(e){var t=3===e.nodeType?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var i,r=this.filter(e,t);if(r)return i=3===r.nodeType?"text":"element",{id:r.id,tagName:r.tagName,type:i,index:this.filteredPosition(r,t)}}pathTo(e,t,i){for(var r,s={steps:[],terminal:{offset:null,assertion:null}},n=e;n&&n.parentNode&&9!=n.parentNode.nodeType;)(r=i?this.filteredStep(n,i):this.step(n))&&s.steps.unshift(r),n=n.parentNode;return null!=t&&t>=0&&(s.terminal.offset=t,"text"!=s.steps[s.steps.length-1].type&&s.steps.push({type:"text",index:0})),s}equalStep(e,t){return!!e&&!!t&&e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,i){var r={range:!1,base:{},path:{},start:null,end:null},s=e.startContainer,n=e.endContainer,o=e.startOffset,a=e.endOffset,l=!1;if(i&&(l=null!=s.ownerDocument.querySelector("."+i)),"string"==typeof t?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):"object"==typeof t&&(r.base=t),e.collapsed)l&&(o=this.patchOffset(s,o,i)),r.path=this.pathTo(s,o,i);else{r.range=!0,l&&(o=this.patchOffset(s,o,i)),r.start=this.pathTo(s,o,i),l&&(a=this.patchOffset(n,a,i)),r.end=this.pathTo(n,a,i),r.path={steps:[],terminal:null};var h,c=r.start.steps.length;for(h=0;h<c;h++)if(this.equalStep(r.start.steps[h],r.end.steps[h]))h===c-1?r.start.terminal===r.end.terminal&&(r.path.steps.push(r.start.steps[h]),r.range=!1):r.path.steps.push(r.start.steps[h]);else break;r.start.steps=r.start.steps.slice(r.path.steps.length),r.end.steps=r.end.steps.slice(r.path.steps.length)}return r}fromNode(e,t,i){var r={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof t?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):"object"==typeof t&&(r.base=t),r.path=this.pathTo(e,null,i),r}filter(e,t){var i,r,s,n,o,a=!1;return(3===e.nodeType?(a=!0,s=e.parentNode,i=e.parentNode.classList.contains(t)):(a=!1,i=e.classList.contains(t)),i&&a)?(n=s.previousSibling,o=s.nextSibling,n&&3===n.nodeType?r=n:o&&3===o.nodeType&&(r=o),r)?r:e:(!i||!!a)&&e}patchOffset(e,t,i){if(3!=e.nodeType)throw Error("Anchor must be a text node");var r=e,s=t;for(e.parentNode.classList.contains(i)&&(r=e.parentNode);r.previousSibling;){if(1===r.previousSibling.nodeType){if(r.previousSibling.classList.contains(i))s+=r.previousSibling.textContent.length;else break}else s+=r.previousSibling.textContent.length;r=r.previousSibling}return s}normalizedMap(e,t,i){var r,s,n,o={},a=-1,l=e.length;for(n=0;n<l;n++)1===(r=e[n].nodeType)&&e[n].classList.contains(i)&&(r=3),n>0&&3===r&&3===s?o[n]=a:t===r&&(a+=1,o[n]=a),s=r;return o}position(e){var t,i;return 1===e.nodeType?((t=e.parentNode.children)||(t=F(e.parentNode)),i=Array.prototype.indexOf.call(t,e)):i=(t=this.textNodes(e.parentNode)).indexOf(e),i}filteredPosition(e,t){var i,r;return 1===e.nodeType?(i=e.parentNode.children,r=this.normalizedMap(i,1,t)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(i=(e=e.parentNode).parentNode.childNodes),r=this.normalizedMap(i,3,t)),r[Array.prototype.indexOf.call(i,e)]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(e){var i=e.index+1;e.id?t.push("*[position()="+i+" and @id='"+e.id+"']"):"text"===e.type?t.push("text()["+i+"]"):t.push("*["+i+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(e){var i=e.index+1;e.id?t.push("#"+e.id):"text"===e.type||t.push("*:nth-child("+i+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(e){return 3===e.nodeType||!!(t&&e.classList.contains(t))})}walkToNode(e,t,i){var r,s,n=t||document,o=n.documentElement,a=e.length;for(s=0;s<a&&("element"===(r=e[s]).type?o=r.id?n.getElementById(r.id):(o.children||F(o))[r.index]:"text"===r.type&&(o=this.textNodes(o,i)[r.index]),o);s++);return o}findNode(e,t,i){var r,s,n=t||document;return i||void 0===n.evaluate?r=i?this.walkToNode(e,n,i):this.walkToNode(e,n):(s=this.stepsToXpath(e),r=n.evaluate(s,n,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),r}fixMiss(e,t,i,r){var s,n,o=this.findNode(e.slice(0,-1),i,r),a=o.childNodes,l=this.normalizedMap(a,3,r),h=e[e.length-1].index;for(let e in l){if(!l.hasOwnProperty(e))return;if(l[e]===h){if(n=(s=a[e]).textContent.length,t>n)t-=n;else{o=1===s.nodeType?s.childNodes[0]:s;break}}}return{container:o,offset:t}}toRange(e,t){var i,r,s,n,o,a,l,h,c=e||document,u=!!t&&null!=c.querySelector("."+t);if(i=void 0!==c.createRange?c.createRange():new G,this.range?(r=this.start,a=this.path.steps.concat(r.steps),n=this.findNode(a,c,u?t:null),s=this.end,l=this.path.steps.concat(s.steps),o=this.findNode(l,c,u?t:null)):(r=this.path,a=this.path.steps,n=this.findNode(this.path.steps,c,u?t:null)),!n)return console.log("No startContainer found for",this.toString()),null;try{null!=r.terminal.offset?i.setStart(n,r.terminal.offset):i.setStart(n,0)}catch(e){h=this.fixMiss(a,r.terminal.offset,c,u?t:null),i.setStart(h.container,h.offset)}if(o)try{null!=s.terminal.offset?i.setEnd(o,s.terminal.offset):i.setEnd(o,0)}catch(e){h=this.fixMiss(l,this.end.terminal.offset,c,u?t:null),i.setEnd(h.container,h.offset)}return i}isCfiString(e){return"string"==typeof e&&0===e.indexOf("epubcfi(")&&")"===e[e.length-1]}generateChapterComponent(e,t,i){var r=parseInt(t),s="/"+(e+1)*2+"/";return s+=(r+1)*2,i&&(s+="["+i+"]"),s}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class Q{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if("function"==typeof arguments[e])this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){for(let t=0;t<this.hooks.length;t++)if(this.hooks[t]===e){this.hooks.splice(t,1);break}}trigger(){var e=arguments,t=this.context,i=[];return this.hooks.forEach(function(r){try{var s=r.apply(t,e)}catch(e){console.log(e)}s&&"function"==typeof s.then&&i.push(s)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}function ee(e,t){var i,r,s=t.url,n=s.indexOf("://")>-1;e&&(r=L(e,"head"),(i=L(r,"base"))||(i=e.createElement("base"),r.insertBefore(i,r.firstChild)),!n&&window&&window.location&&(s=window.location.origin+s),i.setAttribute("href",s))}function et(e,t){var i,r,s=t.canonical;e&&(i=L(e,"head"),(r=L(i,"link[rel='canonical']"))?r.setAttribute("href",s):((r=e.createElement("link")).setAttribute("rel","canonical"),r.setAttribute("href",s),i.appendChild(r)))}function ei(e,t){var i,r,s=t.idref;e&&(i=L(e,"head"),(r=L(i,"link[property='dc.identifier']"))?r.setAttribute("content",s):((r=e.createElement("meta")).setAttribute("name","dc.identifier"),r.setAttribute("content",s),i.appendChild(r)))}function er(e,t,i){return t.forEach(function(t,r){t&&i[r]&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=e.replace(RegExp(t,"g"),i[r]))}),e}let es=function(e,t,i,r){var s,n="undefined"!=typeof window&&window.URL,o=new M,a=new XMLHttpRequest,l=XMLHttpRequest.prototype;for(s in"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),i&&(a.withCredentials=!0),a.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e,i=!1;if((""===this.responseType||"document"===this.responseType)&&(i=this.responseXML),200===this.status||0===this.status||i){if(!this.response&&!i)return o.reject({status:this.status,message:"Empty Response",stack:Error().stack}),o.promise;if(403===this.status)return o.reject({status:this.status,response:this.response,message:"Forbidden",stack:Error().stack}),o.promise;e=i?this.responseXML:C(t)?I(this.response,"text/xml"):"xhtml"==t?I(this.response,"application/xhtml+xml"):"html"==t||"htm"==t?I(this.response,"text/html"):"json"==t?JSON.parse(this.response):"blob"==t?n?this.response:new Blob([this.response]):this.response,o.resolve(e)}else o.reject({status:this.status,message:this.response,stack:Error().stack})}},a.onerror=function(e){o.reject(e)},a.open("GET",e,!0),r)a.setRequestHeader(s,r[s]);return"json"==t&&a.setRequestHeader("Accept","application/json"),t||(t=new X(e).extension),"blob"==t&&(a.responseType=n?"blob":"arraybuffer"),C(t)&&a.overrideMimeType("text/xml"),"binary"==t&&(a.responseType="arraybuffer"),a.send(),o.promise};class en{constructor(e,t){this.idref=e.idref,this.linear="yes"===e.linear,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new Q(this),this.hooks.content=new Q(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||es,i=new M,r=i.promise;return this.contents?i.resolve(this.contents):t(this.url).then((function(e){return this.document=e,this.contents=e.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){i.resolve(this.contents)}).bind(this)).catch(function(e){i.reject(e)}),r}base(){return ee(this.document,this)}render(e){var t=new M,i=t.promise;return this.output,this.load(e).then((function(e){var t,i=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0;"undefined"==typeof XMLSerializer||i?t=o.DOMParser:t=XMLSerializer;var r=new t;return this.output=r.serializeToString(e),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(e){t.reject(e)}),i}find(e){var t=this,i=[],r=e.toLowerCase(),s=function(e){for(var s,n,o,a=e.textContent.toLowerCase(),l=t.document.createRange(),h=-1;-1!=n;)-1!=(n=a.indexOf(r,h+1))&&((l=t.document.createRange()).setStart(e,n),l.setEnd(e,n+r.length),s=t.cfiFromRange(l),o=e.textContent.length<150?e.textContent:"..."+(o=e.textContent.substring(n-75,n+75))+"...",i.push({cfi:s,excerpt:o})),h=n};return U(t.document,function(e){s(e)}),i}search(e,t=5){if(void 0===document.createTreeWalker)return this.find(e);let i=[],r=this,s=e.toLowerCase(),n=function(e){let t=e.reduce((e,t)=>e+t.textContent,"").toLowerCase().indexOf(s);if(-1!=t){let n=t+s.length,o=0,a=0;if(t<e[0].length){let s;for(;o<e.length-1&&!(n<=(a+=e[o].length));)o+=1;let l=e[0],h=e[o],c=r.document.createRange();c.setStart(l,t);let u=e.slice(0,o).reduce((e,t)=>e+t.textContent.length,0);c.setEnd(h,u>n?n:n-u),s=r.cfiFromRange(c);let d=e.slice(0,o+1).reduce((e,t)=>e+t.textContent,"");d.length>150&&(d="..."+(d=d.substring(t-75,t+75))+"..."),i.push({cfi:s,excerpt:d})}}},o=document.createTreeWalker(r.document,NodeFilter.SHOW_TEXT,null,!1),a,l=[];for(;a=o.nextNode();)l.push(a),l.length==t&&(n(l.slice(0,t)),l=l.slice(1,t));return l.length>0&&n(l),i}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(e){var i,r,s=e.replace("rendition:",""),n=s.indexOf("-");-1!=n&&(i=s.slice(0,n),r=s.slice(n+1),t[i]=r)}),t}cfiFromRange(e){return new Z(e,this.cfiBase).toString()}cfiFromElement(e){return new Z(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class eo{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new Q,this.hooks.content=new Q,this.hooks.content.register(ee),this.hooks.content.register(et),this.hooks.content.register(ei),this.epubcfi=new Z,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((e,r)=>{var s,n=this.manifest[e.idref];e.index=r,e.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,e.index,e.id),e.href&&(e.url=t(e.href,!0),e.canonical=i(e.href)),n&&(e.href=n.href,e.url=t(e.href,!0),e.canonical=i(e.href),n.properties.length&&e.properties.push.apply(e.properties,n.properties)),"yes"===e.linear?(e.prev=(function(){let t=e.index;for(;t>0;){let e=this.get(t-1);if(e&&e.linear)return e;t-=1}}).bind(this),e.next=(function(){let t=e.index;for(;t<this.spineItems.length-1;){let e=this.get(t+1);if(e&&e.linear)return e;t+=1}}).bind(this)):(e.prev=function(){},e.next=function(){}),s=new en(e,this.hooks),this.append(s)}),this.loaded=!0}get(e){var t=0;if(void 0===e)for(;t<this.spineItems.length;){let e=this.spineItems[t];if(e&&e.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new Z(e).spinePos:"number"==typeof e||!1===isNaN(e)?t=e:"string"==typeof e&&0===e.indexOf("#")?t=this.spineById[e.substring(1)]:"string"==typeof e&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(e,t){e.index=t}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class ea{constructor(e){this._q=[],this.context=e,this.tick=a,this.running=!1,this.paused=!1}enqueue(){var e,t,i,r=[].shift.call(arguments),s=arguments;if(!r)throw Error("No Task Provided");return"function"==typeof r?(t=(e=new M).promise,i={task:r,args:s,deferred:e,promise:t}):i={promise:r},this._q.push(i),!1!=this.paused||this.running||this.run(),i.promise}dequeue(){var e,t,i;return!this._q.length||this.paused?((e=new M).deferred.resolve(),e.promise):(t=(e=this._q.shift()).task)?(i=t.apply(this.context,e.args))&&"function"==typeof i.then?i.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise):e.promise?e.promise:void 0}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new M),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),!0==this.paused&&(this.paused=!1),this.defered.promise}flush(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running):void 0}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}let el=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],eh={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class ec{constructor(e,t,i){this.spine=e,this.request=t,this.pause=i||100,this.q=new ea(this),this.epubcfi=new Z,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(e){e.linear&&this.q.enqueue(this.process.bind(this),e)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var i=new M,r=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(r),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(r),this.pause),i.promise}).bind(this))}parse(e,t,i){var r,s,n=[],o=L(e.ownerDocument,"body"),a=0,l=i||this.break;if(U(o,(function(e){var i,o=e.length,h=0;if(0===e.textContent.trim().length)return!1;for(0==a&&((r=this.createRange()).startContainer=e,r.startOffset=0),(i=l-a)>o&&(a+=o,h=o);h<o;)if(i=l-a,0===a&&(h+=1,(r=this.createRange()).startContainer=e,r.startOffset=h),h+i>=o)a+=o-h,h=o;else{h+=i,r.endContainer=e,r.endOffset=h;let s=new Z(r,t).toString();n.push(s),a=0}s=e}).bind(this)),r&&r.startContainer&&s){r.endContainer=s,r.endOffset=s.length;let e=new Z(r,t).toString();n.push(e),a=0}return n}generateFromWords(e,t,i){var r=e?new Z(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(e){e.linear&&(r?e.index>=r.spinePos&&this.q.enqueue(this.processWords.bind(this),e,t,r,i):this.q.enqueue(this.processWords.bind(this),e,t,r,i))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,i,r){return r&&this._locationsWords.length>=r?Promise.resolve():e.load(this.request).then((function(s){var n=new M,o=this.parseWords(s,e,t,i),a=r-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=r?o.slice(0,a):o),e.unload(),this.processingTimeout=setTimeout(()=>n.resolve(o),this.pause),n.promise}).bind(this))}countWords(e){return(e=(e=(e=e.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\n /,"\n")).split(" ").length}parseWords(e,t,i,r){var s,n=t.cfiBase,o=[],a=L(e.ownerDocument,"body"),l=!r||r.spinePos!==t.index;return r&&t.index===r.spinePos&&(s=r.findNode(r.range?r.path.steps.concat(r.start.steps):r.path.steps,e.ownerDocument)),U(a,(function(e){if(!l){if(e!==s)return!1;l=!0}if(e.textContent.length<10&&0===e.textContent.trim().length)return!1;var t,r=this.countWords(e.textContent),a=0;if(0===r)return!1;for((t=i-this._wordCounter)>r&&(this._wordCounter+=r,a=r);a<r;)if(a+(t=i-this._wordCounter)>=r)this._wordCounter+=r-a,a=r;else{a+=t;let i=new Z(e,n);o.push({cfi:i.toString(),wordCount:this._wordCounter}),this._wordCounter=0}}).bind(this)),o}locationFromCfi(e){let t;return(Z.prototype.isCfiString(e)&&(e=new Z(e)),0===this._locations.length)?-1:(t=y(e,this._locations,this.epubcfi.compare))>this.total?this.total:t}percentageFromCfi(e){if(0===this._locations.length)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return e&&this.total?e/this.total:0}cfiFromLocation(e){var t=-1;return"number"!=typeof e&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let e=new Z(this._locations[this.total]);return e.collapse(),e.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return"string"==typeof e?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if("string"==typeof e)this._currentCfi=e;else{if("number"!=typeof e)return;this._current=e}0!==this._locations.length&&("string"==typeof e?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(eh.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}n()(ec.prototype);class eu{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw Error("Container File Not Found");if(!(t=L(e,"rootfile")))throw Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=J().dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class ed{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,i,r;if(!e)throw Error("Package File Not Found");if(!(t=L(e,"metadata")))throw Error("No Metadata Found");if(!(i=L(e,"manifest")))throw Error("No Manifest Found");if(!(r=L(e,"spine")))throw Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,r),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=x(r),this.spine=this.parseSpine(r,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=r.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},i=P(e,"item");return Array.prototype.slice.call(i).forEach(function(e){var i=e.getAttribute("id"),r=e.getAttribute("href")||"",s=e.getAttribute("media-type")||"",n=e.getAttribute("media-overlay")||"",o=e.getAttribute("properties")||"";t[i]={href:r,type:s,overlay:n,properties:o.length?o.split(" "):[]}}),t}parseSpine(e,t){var i=[],r=P(e,"itemref");return Array.prototype.slice.call(r).forEach(function(e,t){var r=e.getAttribute("idref"),s=e.getAttribute("properties")||"",n=s.length?s.split(" "):[],o={id:e.getAttribute("id"),idref:r,linear:e.getAttribute("linear")||"yes",properties:n,index:t};i.push(o)}),i}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var i=e.getElementById(t);return i&&"identifier"===i.localName&&"http://purl.org/dc/elements/1.1/"===i.namespaceURI&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=j(e,"item",{properties:"nav"});return!!t&&t.getAttribute("href")}findNcxPath(e,t){var i,r=j(e,"item",{"media-type":"application/x-dtbncx+xml"});return!r&&(i=t.getAttribute("toc"))&&(r=e.querySelector(`#${i}`)),!!r&&r.getAttribute("href")}findCoverPath(e){L(e,"package").getAttribute("version");var t=j(e,"item",{properties:"cover-image"});if(t)return t.getAttribute("href");var i=j(e,"meta",{name:"cover"});if(!i)return!1;var r=i.getAttribute("content"),s=e.getElementById(r);return s?s.getAttribute("href"):""}getElementText(e,t){var i,r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t);return r&&0!==r.length&&(i=r[0]).childNodes.length?i.childNodes[0].nodeValue:""}getPropertyText(e,t){var i=j(e,"meta",{property:t});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((e,t)=>(e.index=t,e.linear=e.linear||"yes",e)),e.resources.forEach((e,t)=>{this.manifest[t]=e,e.rel&&"cover"===e.rel[0]&&(this.coverPath=e.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((e,t)=>(e.label=e.title,e)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class ef{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t,i,r=e.nodeType;r&&(t=L(e,"html"),i=L(e,"ncx")),r?t?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):i&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,i=0;i<e.length;i++)(t=e[i]).href&&(this.tocByHref[t.href]=i),t.id&&(this.tocById[t.id]=i),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(0===e.indexOf("#")?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,i){if(0===i.length)return;let r=i[t];if(r&&(e===r.id||e===r.href))return r;{let r;for(let s=0;s<i.length&&!(r=this.getByIndex(e,t,i[s].subitems));++s);return r}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=z(e,"nav","toc"),i=[];if(!t)return i;let r=V(t,"ol",!0);return r?i=this.parseNavList(r):i}parseNavList(e,t){let i=[];if(!e||!e.children)return i;for(let r=0;r<e.children.length;r++){let s=this.navItem(e.children[r],t);s&&i.push(s)}return i}navItem(e,t){let i=e.getAttribute("id")||void 0,r=V(e,"a",!0)||V(e,"span",!0);if(!r)return;let s=r.getAttribute("href")||"";i||(i=s);let n=r.textContent||"",o=[],a=V(e,"ol",!0);return a&&(o=this.parseNavList(a,i)),{id:i,href:s,label:n,subitems:o,parent:t}}parseLandmarks(e){var t,i,r=z(e,"nav","landmarks"),s=r?P(r,"li"):[],n=s.length,o=[];if(!s||0===n)return o;for(t=0;t<n;++t)(i=this.landmarkItem(s[t]))&&(o.push(i),this.landmarksByType[i.type]=t);return o}landmarkItem(e){let t=V(e,"a",!0);if(!t)return;let i=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:t.getAttribute("href")||"",label:t.textContent||"",type:i}}parseNcx(e){var t,i,r=P(e,"navPoint"),s=r.length,n={},o=[];if(!r||0===s)return o;for(t=0;t<s;++t)n[(i=this.ncxItem(r[t])).id]=i,i.parent?n[i.parent].subitems.push(i):o.push(i);return o}ncxItem(e){var t,i=e.getAttribute("id")||!1,r=L(e,"content").getAttribute("src"),s=L(e,"navLabel"),n=s.textContent?s.textContent:"",o=e.parentNode;return o&&("navPoint"===o.nodeName||"navPoint"===o.nodeName.split(":").slice(-1)[0])&&(t=o.getAttribute("id")),{id:i,href:r,label:n,subitems:[],parent:t}}load(e){return e.map(e=>(e.label=e.title,e.subitems=e.children?this.load(e.children):[],e))}forEach(e){return this.toc.forEach(e)}}var ep={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},eg=function(){var e,t,i,r,s={};for(e in ep)if(ep.hasOwnProperty(e)){for(t in ep[e])if(ep[e].hasOwnProperty(t)){if("string"==typeof(i=ep[e][t]))s[i]=e+"/"+t;else for(r=0;r<i.length;r++)s[i[r]]=e+"/"+t}}return s}();let em={lookup:function(e){return e&&eg[e.split(".").pop().toLowerCase()]||"text/plain"}};class ev{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if("application/xhtml+xml"===e.type||"text/html"===e.type)return!0}),this.assets=this.resources.filter(function(e){if("application/xhtml+xml"!==e.type&&"text/html"!==e.type)return!0}),this.css=this.resources.filter(function(e){if("text/css"===e.type)return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Y(e),i=em.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(e,"blob").then(e=>$(e)).then(e=>O(e,i)):this.settings.request(e,"blob").then(e=>R(e,i))}replacements(){return"none"===this.settings.replacements?new Promise((function(e){e(this.urls)}).bind(this)):Promise.all(this.urls.map(e=>{var t=this.settings.resolver(e);return this.createUrl(t).catch(e=>(console.error(e),null))})).then(e=>(this.replacementUrls=e.filter(e=>"string"==typeof e),e))}replaceCss(e,t){var i=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(r){var s=this.createCssFile(r,e,t).then((function(e){var t=this.urls.indexOf(r);t>-1&&(this.replacementUrls[t]=e)}).bind(this));i.push(s)}).bind(this)),Promise.all(i)}createCssFile(e){if(J().isAbsolute(e))return new Promise(function(e){e()});var t,i=this.settings.resolver(e);t=this.settings.archive?this.settings.archive.getText(i):this.settings.request(i,"text");var r=this.urls.map(e=>{var t=this.settings.resolver(e);return new X(i).relative(t)});return t?t.then(e=>(e=er(e,r,this.replacementUrls),"base64"===this.settings.replacements?O(e,"text/css"):R(e,"text/css")),e=>new Promise(function(e){e()})):new Promise(function(e){e()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(i){var r=t(i);return new X(e).relative(r)}).bind(this))}get(e){var t=this.urls.indexOf(e);return -1===t?void 0:this.replacementUrls.length?new Promise((function(e,i){e(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){return er(e,t?this.relativeTo(t):this.urls,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class ey{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new Z,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=L(e,"html"),i=L(e,"ncx");return t?this.parseNav(e):i?this.parseNcx(e):void 0}parseNav(e){var t,i=z(e,"nav","page-list"),r=i?P(i,"li"):[],s=r.length,n=[];if(!r||0===s)return n;for(t=0;t<s;++t)n.push(this.item(r[t]));return n}parseNcx(e){var t,i,r=[],s=0,n=0;if(!(t=L(e,"pageList"))||(n=(i=P(t,"pageTarget")).length,!i||0===i.length))return r;for(s=0;s<n;++s)r.push(this.ncxItem(i[s]));return r}ncxItem(e){var t=L(e,"navLabel"),i=L(t,"text").textContent;return{href:L(e,"content").getAttribute("src"),page:parseInt(i,10)}}item(e){var t,i,r=L(e,"a"),s=r.getAttribute("href")||"",n=parseInt(r.textContent||"");return -1!=s.indexOf("epubcfi")?(i=(t=s.split("#"))[0],{cfi:t.length>1&&t[1],href:s,packageUrl:i,page:n}):{href:s,page:n}}process(e){e.forEach(function(e){this.pages.push(e.page),e.cfi&&this.locations.push(e.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(0===this.locations.length)return -1;var i=b(e,this.locations,this.epubcfi.compare);return -1!=i?t=this.pages[i]:void 0!==(t=(i=y(e,this.locations,this.epubcfi.compare))-1>=0?this.pages[i-1]:this.pages[0])||(t=-1),t}cfiFromPage(e){var t=-1;"number"!=typeof e&&(e=parseInt(e));var i=this.pages.indexOf(e);return -1!=i&&(t=this.locations[i]),t}pageFromPercentage(e){return Math.round(this.totalPages*e)}percentageFromPage(e){return Math.round(1e3*((e-this.firstPage)/this.totalPages))/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e);return this.percentageFromPage(t)}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class eb{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread="none"!==e.spread,this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,"scrolled"===e.flow||"scrolled-continuous"===e.flow||"scrolled-doc"===e.flow?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return void 0!==e&&("scrolled"===e||"scrolled-continuous"===e||"scrolled-doc"===e?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread="none"!==e,this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,i){var r,s,n,o,a=1,l=i||0,h=e,c=Math.floor(h/12);a=this._spread&&h>=this._minSpreadWidth?2:1,"reflowable"!==this.name||"paginated"!==this._flow||i>=0||(l=c%2==0?c:c-1),"pre-paginated"===this.name&&(l=0),a>1?n=(r=h/a-l)+l:(r=h,n=h),"pre-paginated"===this.name&&a>1&&(h=r),s=r*a+l,o=h,this.width=h,this.height=t,this.spreadWidth=s,this.pageWidth=n,this.delta=o,this.columnWidth=r,this.gap=l,this.divisor=a,this.update({width:h,height:t,spreadWidth:s,pageWidth:n,delta:o,columnWidth:r,gap:l,divisor:a})}format(e,t,i){return"pre-paginated"===this.name?e.fit(this.columnWidth,this.height,t):"paginated"===this._flow?e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&"horizontal"===i?e.size(null,this.height):e.size(this.width,null)}count(e,t){let i,r;return"pre-paginated"===this.name?(i=1,r=1):r="paginated"===this._flow?(i=Math.ceil(e/(t=t||this.delta)))*this.divisor:i=Math.ceil(e/(t=t||this.height)),{spreads:i,pages:r}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=m(this.props,e);this.emit(eh.LAYOUT.UPDATED,t,e)}}}n()(eb.prototype);class ew{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){return 0==arguments.length?void 0:1==arguments.length&&"object"==typeof arguments[0]?this.registerThemes(arguments[0]):1==arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2==arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2==arguments.length&&"object"==typeof arguments[1]?this.registerRules(arguments[0],arguments[1]):void 0}default(e){return e?"string"==typeof e?this.registerUrl("default",e):"object"==typeof e?this.registerRules("default",e):void 0:void 0}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&("string"==typeof e[t]?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||"default"==e)&&this.update(e)}registerUrl(e,t){var i=new Y(t);this._themes[e]={url:i.toString()},(this._injected[e]||"default"==e)&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||"default"==e)&&this.update(e)}select(e){var t=this._current;this._current=e,this.update(e),this.rendition.getContents().forEach(i=>{i.removeClass(t),i.addClass(e)})}update(e){this.rendition.getContents().forEach(t=>{this.add(e,t)})}inject(e){var t,i=[],r=this._themes;for(var s in r)r.hasOwnProperty(s)&&(s===this._current||"default"===s)&&(((t=r[s]).rules&&Object.keys(t.rules).length>0||t.url&&-1===i.indexOf(t.url))&&this.add(s,e),this._injected.push(s));"default"!=this._current&&e.addClass(this._current)}add(e,t){var i=this._themes[e];i&&t&&(i.url?t.addStylesheet(i.url):i.serialized?(t.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(t.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,t,i){var r=this.rendition.getContents();this._overrides[e]={value:t,priority:!0===i},r.forEach(t=>{t.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(t=>{t.css(e)})}overrides(e){var t=this._overrides;for(var i in t)t.hasOwnProperty(i)&&e.css(i,t[i].value,t[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class e_{constructor(e,t,i,r=!1){this.layout=e,this.horizontal="horizontal"===i,this.direction=t||"ltr",this._dev=r}section(e){var t=this.findRanges(e);return this.rangeListToCfiList(e.section.cfiBase,t)}page(e,t,i,r){var s,n=!!e&&!!e.document&&e.document.body;if(n){if(s=this.rangePairToCfiPair(t,{start:this.findStart(n,i,r),end:this.findEnd(n,i,r)}),!0===this._dev){let t=e.document,i=new Z(s.start).toRange(t),r=new Z(s.end).toRange(t),n=t.defaultView.getSelection(),o=t.createRange();n.removeAllRanges(),o.setStart(i.startContainer,i.startOffset),o.setEnd(r.endContainer,r.endOffset),n.addRange(o)}return s}}walk(e,t){if(!e||e.nodeType!==Node.TEXT_NODE){var i,r,s=function(e){return e.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT};s.acceptNode=s;for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,s,!1);(i=n.nextNode())&&!(r=t(i)););return r}}findRanges(e){for(var t,i,r=[],s=Math.ceil(e.contents.scrollWidth()/this.layout.spreadWidth)*this.layout.divisor,n=this.layout.columnWidth,o=this.layout.gap,a=0;a<s.pages;a++)t=(n+o)*a,i=n*(a+1)+o*a,r.push({start:this.findStart(e.document.body,t,i),end:this.findEnd(e.document.body,t,i)});return r}findStart(e,t,i){for(var r,s,n=[e],o=e;n.length;)if(r=n.shift(),s=this.walk(r,e=>{var r,s,a,l,h;if(h=E(e),this.horizontal&&"ltr"===this.direction){if(r=this.horizontal?h.left:h.top,s=this.horizontal?h.right:h.bottom,r>=t&&r<=i||s>t)return e;o=e,n.push(e)}else if(this.horizontal&&"rtl"===this.direction){if(r=h.left,(s=h.right)<=i&&s>=t||r<i)return e;o=e,n.push(e)}else{if(a=h.top,l=h.bottom,a>=t&&a<=i||l>t)return e;o=e,n.push(e)}}))return this.findTextStartRange(s,t,i);return this.findTextStartRange(o,t,i)}findEnd(e,t,i){for(var r,s,n=[e],o=e;n.length;)if(r=n.shift(),s=this.walk(r,e=>{var r,s,a,l,h;if(h=E(e),this.horizontal&&"ltr"===this.direction){if(r=Math.round(h.left),s=Math.round(h.right),r>i&&o)return o;if(s>i)return e;o=e,n.push(e)}else if(this.horizontal&&"rtl"===this.direction){if(r=Math.round(this.horizontal?h.left:h.top),(s=Math.round(this.horizontal?h.right:h.bottom))<t&&o)return o;if(r<t)return e;o=e,n.push(e)}else{if(a=Math.round(h.top),l=Math.round(h.bottom),a>i&&o)return o;if(l>i)return e;o=e,n.push(e)}}))return this.findTextEndRange(s,t,i);return this.findTextEndRange(o,t,i)}findTextStartRange(e,t,i){for(var r,s,n=this.splitTextNodeIntoRanges(e),o=0;o<n.length;o++)if(s=(r=n[o]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(s.left>=t)return r}else if(this.horizontal&&"rtl"===this.direction){if(s.right<=i)return r}else if(s.top>=t)return r;return n[0]}findTextEndRange(e,t,i){for(var r,s,n,o,a,l,h,c=this.splitTextNodeIntoRanges(e),u=0;u<c.length;u++){if(n=(s=c[u]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(o=n.left,a=n.right,o>i&&r)return r;if(a>i)return s}else if(this.horizontal&&"rtl"===this.direction){if(o=n.left,(a=n.right)<t&&r)return r;if(o<t)return s}else{if(l=n.top,h=n.bottom,l>i&&r)return r;if(h>i)return s}r=s}return c[c.length-1]}splitTextNodeIntoRanges(e,t){var i,r=[],s=(e.textContent||"").trim(),n=e.ownerDocument,o=t||" ",a=s.indexOf(o);if(-1===a||e.nodeType!=Node.TEXT_NODE)return(i=n.createRange()).selectNodeContents(e),[i];for((i=n.createRange()).setStart(e,0),i.setEnd(e,a),r.push(i),i=!1;-1!=a;)(a=s.indexOf(o,a+1))>0&&(i&&(i.setEnd(e,a),r.push(i)),(i=n.createRange()).setStart(e,a+1));return i&&(i.setEnd(e,s.length),r.push(i)),r}rangePairToCfiPair(e,t){var i=t.start,r=t.end;return i.collapse(!0),r.collapse(!1),{start:new Z(i,e).toString(),end:new Z(r,e).toString()}}rangeListToCfiList(e,t){for(var i=[],r=0;r<t.length;r++)i.push(this.rangePairToCfiPair(e,t[r]));return i}axis(e){return e&&(this.horizontal="horizontal"===e),this.horizontal}}let eE="undefined"!=typeof navigator,eS=eE&&/Chrome/.test(navigator.userAgent),eT=eE&&!eS&&/AppleWebKit/.test(navigator.userAgent);class ek{constructor(e,t,i,r){this.epubcfi=new Z,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=r||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js","0.3"),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return el}width(e){var t=this.content;return e&&d(e)&&(e+="px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&d(e)&&(e+="px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&d(e)&&(e+="px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&d(e)&&(e+="px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e;let t=this.document.createRange(),i=this.content||this.document.body,r=_(i);return t.selectNodeContents(i),e=t.getBoundingClientRect().width,r&&r.width&&(e+=r.width),Math.round(e)}textHeight(){let e=this.document.createRange(),t=this.content||this.document.body;return e.selectNodeContents(t),Math.round(e.getBoundingClientRect().bottom)}scrollWidth(){return this.documentElement.scrollWidth}scrollHeight(){return this.documentElement.scrollHeight}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,i){var r=this.content||this.document.body;return t?r.style.setProperty(e,t,i?"important":""):r.style.removeProperty(e),this.window.getComputedStyle(r)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},r=[],s={};if(t&&t.hasAttribute("content")){let e=t.getAttribute("content"),r=e.match(/width\s*=\s*([^,]*)/),s=e.match(/height\s*=\s*([^,]*)/),n=e.match(/initial-scale\s*=\s*([^,]*)/),o=e.match(/minimum-scale\s*=\s*([^,]*)/),a=e.match(/maximum-scale\s*=\s*([^,]*)/),l=e.match(/user-scalable\s*=\s*([^,]*)/);r&&r.length&&void 0!==r[1]&&(i.width=r[1]),s&&s.length&&void 0!==s[1]&&(i.height=s[1]),n&&n.length&&void 0!==n[1]&&(i.scale=n[1]),o&&o.length&&void 0!==o[1]&&(i.minimum=o[1]),a&&a.length&&void 0!==a[1]&&(i.maximum=a[1]),l&&l.length&&void 0!==l[1]&&(i.scalable=l[1])}return s=g(e||{},i),e&&(s.width&&r.push("width="+s.width),s.height&&r.push("height="+s.height),s.scale&&r.push("initial-scale="+s.scale),"no"===s.scalable?(r.push("minimum-scale="+s.scale),r.push("maximum-scale="+s.scale),r.push("user-scalable="+s.scalable)):(s.scalable&&r.push("user-scalable="+s.scalable),s.minimum&&r.push("minimum-scale="+s.minimum),s.maximum&&r.push("minimum-scale="+s.maximum)),t||((t=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",r.join(", ")),this.window.scrollTo(0,0)),s}expand(){this.emit(eh.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),"undefined"==typeof ResizeObserver?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(eh.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&!1===this.active?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e,t=this.document.styleSheets,i=(function(e){e.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<t.length;r+=1){try{e=t[r].cssRules}catch(e){return}if(!e)return;for(var s=0;s<e.length;s+=1)e[s].media&&this.window.matchMedia(e[s].media.mediaText).addListener(i)}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(e=>{this.resizeCheck()}),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}imageLoadListeners(){for(var e,t=this.document.querySelectorAll("img"),i=0;i<t.length;i++)void 0!==(e=t[i]).naturalWidth&&0===e.naturalWidth&&(e.onload=this.expand.bind(this))}fontLoadListeners(){this.document&&this.document.fonts&&this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var i,r={left:0,top:0};if(!this.document)return r;if(this.epubcfi.isCfiString(e)){let s=new Z(e).toRange(this.document,t);if(s){try{if(!s.endContainer||s.startContainer==s.endContainer&&s.startOffset==s.endOffset){let e=s.startContainer.textContent.indexOf(" ",s.startOffset);-1==e&&(e=s.startContainer.textContent.length),s.setEnd(s.startContainer,e)}}catch(e){console.error("setting end offset to start container length failed",e)}if(s.startContainer.nodeType===Node.ELEMENT_NODE)i=s.startContainer.getBoundingClientRect(),r.left=i.left,r.top=i.top;else if(eT){let e=s.startContainer,t=new Range;try{1===e.nodeType?i=e.getBoundingClientRect():s.startOffset+2<e.length?(t.setStart(e,s.startOffset),t.setEnd(e,s.startOffset+2),i=t.getBoundingClientRect()):s.startOffset-2>0?(t.setStart(e,s.startOffset-2),t.setEnd(e,s.startOffset),i=t.getBoundingClientRect()):i=e.parentNode.getBoundingClientRect()}catch(e){console.error(e,e.stack)}}else i=s.getBoundingClientRect()}}else if("string"==typeof e&&e.indexOf("#")>-1){let t=e.substring(e.indexOf("#")+1),r=this.document.getElementById(t);if(r){if(eT){let e=new Range;e.selectNode(r),i=e.getBoundingClientRect()}else i=r.getBoundingClientRect()}}return i&&(r.left=i.left,r.top=i.top),r}addStylesheet(e){return new Promise((function(t,i){var r,s=!1;if(!this.document){t(!1);return}if(r=this.document.querySelector("link[href='"+e+"']")){t(!0);return}(r=this.document.createElement("link")).type="text/css",r.rel="stylesheet",r.href=e,r.onload=r.onreadystatechange=function(){s||this.readyState&&"complete"!=this.readyState||(s=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(r)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),!!this.document&&((t=this.document.getElementById(e))||((t=this.document.createElement("style")).id=e,this.document.head.appendChild(t)),t)}addStylesheetCss(e,t){return!!this.document&&!!e&&(this._getStylesheetNode(t).innerHTML=e,!0)}addStylesheetRules(e,t){var i;if(this.document&&e&&0!==e.length){if(i=this._getStylesheetNode(t).sheet,"[object Array]"===Object.prototype.toString.call(e))for(var r=0,s=e.length;r<s;r++){var n=1,o=e[r],a=e[r][0],l="";"[object Array]"===Object.prototype.toString.call(o[1][0])&&(o=o[1],n=0);for(var h=o.length;n<h;n++){var c=o[n];l+=c[0]+":"+c[1]+(c[2]?" !important":"")+";\n"}i.insertRule(a+"{"+l+"}",i.cssRules.length)}else Object.keys(e).forEach(t=>{let r=e[t];if(Array.isArray(r))r.forEach(e=>{let r=Object.keys(e).map(t=>`${t}:${e[t]}`).join(";");i.insertRule(`${t}{${r}}`,i.cssRules.length)});else{let e=Object.keys(r).map(e=>`${e}:${r[e]}`).join(";");i.insertRule(`${t}{${e}}`,i.cssRules.length)}})}}addScript(e){return new Promise((function(t,i){var r,s=!1;if(!this.document){t(!1);return}(r=this.document.createElement("script")).type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){s||this.readyState&&"complete"!=this.readyState||(s=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(r)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body)&&t.classList.add(e)}removeClass(e){var t;this.document&&(t=this.content||this.document.body)&&t.classList.remove(e)}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),el.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(el.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var e=this.window.getSelection();this.triggerSelectedEvent(e)}).bind(this),250)}triggerSelectedEvent(e){var t,i;e&&e.rangeCount>0&&!(t=e.getRangeAt(0)).collapsed&&(i=new Z(t,this.cfiBase).toString(),this.emit(eh.CONTENTS.SELECTED,i),this.emit(eh.CONTENTS.SELECTED_RANGE,t))}range(e,t){return new Z(e).toRange(this.document,t)}cfiFromRange(e,t){return new Z(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new Z(e,this.cfiBase,t).toString()}map(e){return new e_(e).section()}size(e,t){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),i.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,t,i,r,s){let n=p("column-axis"),o=p("column-gap"),a=p("column-width"),l=p("column-fill"),h=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===s&&"horizontal"===h&&this.direction(s),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===h?(this.css("padding-top",r/2+"px",!0),this.css("padding-bottom",r/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(n,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",r/2+"px",!0),this.css("padding-right",r/2+"px",!0),this.css(n,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(l,"auto"),this.css(o,r+"px"),this.css(a,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,i){var r="";this.css("transform-origin","top left"),(t>=0||i>=0)&&(r=" translate("+(t||0)+"px, "+(i||0)+"px )"),this.css("transform","scale("+e+")"+r)}fit(e,t,i){var r=this.viewport(),s=parseInt(r.width),n=parseInt(r.height),o=e/s,a=t/n,l=o<a?o:a;if(this.layoutStyle("paginated"),this.width(s),this.height(n),this.overflow("hidden"),this.scaler(l,0,0),this.css("background-size",s*l+"px "+n*l+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var h=e-s*l;this.css("margin-left",h+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,i,r,s){return new e_(t,s).page(this,e,i,r)}linksHandler(){!function(e,t){var i=e.querySelectorAll("a[href]");if(i.length)for(var r=L(e.ownerDocument,"base"),s=r?r.getAttribute("href"):void 0,n=(function(e){var i,r=e.getAttribute("href");if(0!==r.indexOf("mailto:")){if(r.indexOf("://")>-1)e.setAttribute("target","_blank");else{try{i=new Y(r,s)}catch(e){}e.onclick=function(){return i&&i.hash?t(i.Path.path+i.hash):i?t(i.Path.path):t(r),!1}}}}).bind(this),o=0;o<i.length;o++)n(i[o])}(this.content,e=>{this.emit(eh.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=p("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(e){switch(e){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}n()(ek.prototype);class ex{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,i,r,s,n){let o=encodeURI(t+e),a=new Z(t).spinePos,l=new eC({type:e,cfiRange:t,data:i,sectionIndex:a,cb:r,className:s,styles:n});return this._annotations[o]=l,a in this._annotationsBySectionIndex?this._annotationsBySectionIndex[a].push(o):this._annotationsBySectionIndex[a]=[o],this.rendition.views().forEach(e=>{l.sectionIndex===e.index&&l.attach(e)}),l}remove(e,t){let i=encodeURI(e+t);if(i in this._annotations){let e=this._annotations[i];if(t&&e.type!==t)return;this.rendition.views().forEach(t=>{this._removeFromAnnotationBySectionIndex(e.sectionIndex,i),e.sectionIndex===t.index&&e.detach(t)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(e=>e!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,i,r,s){return this.add("highlight",e,t,i,r,s)}underline(e,t,i,r,s){return this.add("underline",e,t,i,r,s)}mark(e,t,i){return this.add("mark",e,t,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(t=>{this._annotations[t].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(t=>{this._annotations[t].detach(e)})}show(){}hide(){}}class eC{constructor({type:e,cfiRange:t,data:i,sectionIndex:r,cb:s,className:n,styles:o}){this.type=e,this.cfiRange=t,this.data=i,this.sectionIndex=r,this.mark=void 0,this.cb=s,this.className=n,this.styles=o}update(e){this.data=e}attach(e){let t,{cfiRange:i,data:r,type:s,mark:n,cb:o,className:a,styles:l}=this;return"highlight"===s?t=e.highlight(i,r,o,a,l):"underline"===s?t=e.underline(i,r,o,a,l):"mark"===s&&(t=e.mark(i,r,o)),this.mark=t,this.emit(eh.ANNOTATION.ATTACH,t),t}detach(e){let t,{cfiRange:i,type:r}=this;return e&&("highlight"===r?t=e.unhighlight(i):"underline"===r?t=e.ununderline(i):"mark"===r&&(t=e.unmark(i))),this.mark=void 0,this.emit(eh.ANNOTATION.DETACH,t),t}text(){}}n()(eC.prototype);var eA=i(6659);class eR{constructor(e,t){this.settings=m({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+h(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new Z,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&"horizontal"==e?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe||(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=w(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write")),this.iframe}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(e){return this.load(e)}).bind(this)).then((function(){let e,t=this.contents.writingMode();return e="scrolled"===this.settings.flow?0===t.indexOf("vertical")?"horizontal":"vertical":0===t.indexOf("vertical")?"vertical":"horizontal",0===t.indexOf("vertical")&&"paginated"===this.settings.flow&&(this.layout.delta=this.layout.height),this.setAxis(e),this.emit(eh.VIEWS.AXIS,e),this.setWritingMode(t),this.emit(eh.VIEWS.WRITING_MODE,t),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((e,t)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),e()})}).bind(this),(function(e){return this.emit(eh.VIEWS.LOAD_ERROR,e),new Promise((t,i)=>{i(e)})}).bind(this)).then((function(){this.emit(eh.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var i=e||this.settings.width,r=t||this.settings.height;"pre-paginated"===this.layout.name?this.lock("both",i,r):"horizontal"===this.settings.axis?this.lock("height",i,r):this.lock("width",i,r),this.settings.width=i,this.settings.height=r}lock(e,t,i){var r,s=_(this.element);r=this.iframe?_(this.iframe):{width:0,height:0},"width"==e&&d(t)&&(this.lockedWidth=t-s.width-r.width),"height"==e&&d(i)&&(this.lockedHeight=i-s.height-r.height),"both"===e&&d(t)&&d(i)&&(this.lockedWidth=t-s.width-r.width,this.lockedHeight=i-s.height-r.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t,i=this.lockedWidth,r=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(i=this.layout.columnWidth,r=this.layout.height):"horizontal"===this.settings.axis?((i=this.contents.textWidth())%this.layout.pageWidth>0&&(i=Math.ceil(i/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(t=i/this.layout.pageWidth,this.layout.divisor>1&&"reflowable"===this.layout.name&&t%2>0&&(i+=this.layout.pageWidth))):"vertical"===this.settings.axis&&(r=this.contents.textHeight(),"paginated"===this.settings.flow&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||i!=this._width||r!=this._height)&&this.reframe(i,r),this._expanding=!1)}reframe(e,t){var i;d(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),d(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let r=this.prevBounds?e-this.prevBounds.width:e,s=this.prevBounds?t-this.prevBounds.height:t;i={width:e,height:t,widthDelta:r,heightDelta:s},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let e;for(let t in this.marks)this.marks.hasOwnProperty(t)&&(e=this.marks[t],this.placeMark(e.element,e.range))}),this.onResize(this,i),this.emit(eh.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=w(this.element)}load(e){var t=new M,i=t.promise;if(!this.iframe)return t.reject(Error("No Iframe Available")),i;if(this.iframe.onload=(function(e){this.onLoad(e,t)}).bind(this),"blobUrl"===this.settings.method)this.blobUrl=R(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var r=this;MSApp.execUnsafeLocalFunction(function(){r.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new ek(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):((i=this.document.createElement("link")).setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(eh.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(eh.CONTENTS.RESIZE,e=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,"horizontal"==e?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new M;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(eh.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(e){t.reject(e,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(eh.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(eh.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=w(this.element)),this.elementBounds}highlight(e,t={},i,r="epubjs-hl",s={}){if(!this.contents)return;let n=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},s),o=this.contents.range(e),a=()=>{this.emit(eh.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new eA.Zv(this.iframe,this.element));let l=new eA.f4(o,r,t,n),h=this.pane.addMark(l);return this.highlights[e]={mark:h,element:h.element,listeners:[a,i]},h.element.setAttribute("ref",r),h.element.addEventListener("click",a),h.element.addEventListener("touchstart",a),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}underline(e,t={},i,r="epubjs-ul",s={}){if(!this.contents)return;let n=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},s),o=this.contents.range(e),a=()=>{this.emit(eh.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new eA.Zv(this.iframe,this.element));let l=new eA.z2(o,r,t,n),h=this.pane.addMark(l);return this.underlines[e]={mark:h,element:h.element,listeners:[a,i]},h.element.setAttribute("ref",r),h.element.addEventListener("click",a),h.element.addEventListener("touchstart",a),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}mark(e,t={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let r=this.contents.range(e);if(!r)return;let s=r.commonAncestorContainer,n=1===s.nodeType?s:s.parentNode,o=i=>{this.emit(eh.VIEWS.MARK_CLICKED,e,t)};r.collapsed&&1===s.nodeType?(r=new Range).selectNodeContents(s):r.collapsed&&(r=new Range).selectNodeContents(n);let a=this.document.createElement("a");return a.setAttribute("ref","epubjs-mk"),a.style.position="absolute",a.dataset.epubcfi=e,t&&Object.keys(t).forEach(e=>{a.dataset[e]=t[e]}),i&&(a.addEventListener("click",i),a.addEventListener("touchstart",i)),a.addEventListener("click",o),a.addEventListener("touchstart",o),this.placeMark(a,r),this.element.appendChild(a),this.marks[e]={element:a,range:r,listeners:[o,i]},n}placeMark(e,t){let i,r,s;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){let e=t.getBoundingClientRect();i=e.top,r=e.right}else{let e,o=t.getClientRects();for(var n=0;n!=o.length;n++)e=o[n],(!s||e.left<s)&&(r=Math.ceil((s=e.left)/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=e.top)}e.style.top=`${i}px`,e.style.left=`${r}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(e=>{e&&(t.element.removeEventListener("click",e),t.element.removeEventListener("touchstart",e))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(e=>{e&&(t.element.removeEventListener("click",e),t.element.removeEventListener("touchstart",e))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(e=>{e&&(t.element.removeEventListener("click",e),t.element.removeEventListener("touchstart",e))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&D(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}n()(eR.prototype);var eD=i(629),eO=i.n(eD);class eN{constructor(e){this.settings=e||{},this.id="epubjs-container-"+h(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,i=e.width,r=e.overflow||!1,s=e.axis||"vertical",n=e.direction;m(this.settings,e),e.height&&d(e.height)&&(t=e.height+"px"),e.width&&d(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative","horizontal"===s&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),t&&(o.style.height=t),r&&("scroll"===r&&"vertical"===s?(o.style["overflow-y"]=r,o.style["overflow-x"]="hidden"):"scroll"===r&&"horizontal"===s?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=r):o.style.overflow=r),n&&(o.dir=n,o.style.direction=n),n&&this.settings.fullsize&&(document.body.style.direction=n),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(u(e)?t=e:"string"==typeof e&&(t=document.getElementById(e)),!t)throw Error("Not an Element");return t}attachTo(e){var t,i=this.getElement(e);if(i)return t=this.settings.hidden?this.wrapper:this.container,i.appendChild(t),this.element=i,i}getContainer(){return this.container}onResize(e){d(this.settings.width)&&d(this.settings.height)||(this.resizeFunc=eO()(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var i;let r=e||this.settings.width,s=t||this.settings.height;null===e?(i=this.element.getBoundingClientRect()).width&&(e=Math.floor(i.width),this.container.style.width=e+"px"):d(e)?this.container.style.width=e+"px":this.container.style.width=e,null===t?(i=i||this.element.getBoundingClientRect()).height&&(t=i.height,this.container.style.height=t+"px"):d(t)?this.container.style.height=t+"px":this.container.style.height=t,d(e)||(e=this.container.clientWidth),d(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let n=S(),o=window.getComputedStyle(document.body),a={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return r||(e=n.width-a.left-a.right),(!this.settings.fullsize||s)&&s||(t=n.height-a.top-a.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return("visible"!==this.container.style.overflow&&(e=this.container&&this.container.getBoundingClientRect()),e&&e.width&&e.height)?e:S()}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var i="#"+this.id+" ",r="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(e){for(var t in e)e.hasOwnProperty(t)&&(r+=t+":"+e[t]+";")}),this.sheet.insertRule(i+e+" {"+r+"}",0)}axis(e){"horizontal"===e?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&("scroll"===e&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):"scroll"===e&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class eI{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var i=0;i<t;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,i=this.length,r=0;r<i;r++)if((t=this._views[r]).displayed&&t.section.index==e.index)return t}displayed(){for(var e,t=[],i=this.length,r=0;r<i;r++)(e=this._views[r]).displayed&&t.push(e);return t}show(){for(var e,t=this.length,i=0;i<t;i++)(e=this._views[i]).displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,i=0;i<t;i++)(e=this._views[i]).displayed&&e.hide();this.hidden=!0}}class eL{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new ea(this),this.settings=m(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),m(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){var i,r,s,n,o;let a=e.tagName;void 0===this.settings.fullsize&&a&&("body"==a.toLowerCase()||"html"==a.toLowerCase())&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=(i="reverse",(r=document.createElement("div")).dir="rtl",r.style.position="fixed",r.style.width="1px",r.style.height="1px",r.style.top="0px",r.style.left="0px",r.style.overflow="hidden",(s=document.createElement("div")).style.width="2px",(n=document.createElement("span")).style.width="1px",n.style.display="inline-block",(o=document.createElement("span")).style.width="1px",o.style.display="inline-block",s.appendChild(n),s.appendChild(o),r.appendChild(s),document.body.appendChild(r),r.scrollLeft>0?i="default":"undefined"!=typeof Element&&Element.prototype.scrollIntoView?(r.children[0].children[1].scrollIntoView(),r.scrollLeft<0&&(i="negative")):(r.scrollLeft=1,0===r.scrollLeft&&(i="negative")),document.body.removeChild(r),i),this.stage=new eN({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new eI(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(e){this.destroy()}).bind(this)),e=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(eh.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,i){let r=this.stage.size(e,t);if(this.winBounds=S(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===r.width&&this._stageSize.height===r.height||(this._stageSize=r,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(eh.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,t){return new this.View(e,m(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,i){let r;if("pre-paginated"===this.layout.name&&this.layout.divisor>1){if(e||0===t.index)return;if((r=t.next())&&!r.properties.includes("page-spread-left"))return i.call(this,r)}}display(e,t){var i=new M,r=i.promise;(t===e.href||d(t))&&(t=void 0);var s=this.views.find(e);if(s&&e&&"pre-paginated"!==this.layout.name){let e=s.offset();if("ltr"===this.settings.direction)this.scrollTo(e.left,e.top,!0);else{let t=s.width();this.scrollTo(e.left+t,e.top,!0)}if(t){let e=s.locationOf(t),i=s.width();this.moveTo(e,i)}return i.resolve(),r}this.clear();let n=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&e.properties.includes("page-spread-right")&&(n=!0),this.add(e,n).then((function(e){if(t){let i=e.locationOf(t),r=e.width();this.moveTo(i,r)}}).bind(this),e=>{i.reject(e)}).then((function(){return this.handleNextPrePaginated(n,e,this.add)}).bind(this)).then((function(){this.views.show(),i.resolve()}).bind(this)),r}afterDisplayed(e){this.emit(eh.MANAGERS.ADDED,e)}afterResized(e){this.emit(eh.MANAGERS.RESIZE,e.section)}moveTo(e,t){var i=0,r=0;this.isPaginated?((i=Math.floor(e.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),(r=Math.floor(e.top/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollHeight&&(r=this.container.scrollHeight-this.layout.delta)):r=e.top,"rtl"===this.settings.direction&&(i+=this.layout.delta,i-=t),this.scrollTo(i,r,!0)}add(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(eh.VIEWS.AXIS,e=>{this.updateAxis(e)}),i.on(eh.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),i.display(this.request)}append(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(eh.VIEWS.AXIS,e=>{this.updateAxis(e)}),i.on(eh.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),i.display(this.request)}prepend(e,t){var i=this.createView(e,t);return i.on(eh.VIEWS.RESIZED,e=>{this.counter(e)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(eh.VIEWS.AXIS,e=>{this.updateAxis(e)}),i.on(eh.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),i.display(this.request)}counter(e){"vertical"===this.settings.axis?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e;let t=this.settings.direction;if(this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis&&(!t||"ltr"===t)?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===t?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next():this.container.scrollLeft+-1*this.layout.delta>-1*this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let t=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&e.properties.includes("page-spread-right")&&(t=!0),this.append(e,t).then((function(){return this.handleNextPrePaginated(t,e,this.append)}).bind(this),e=>e).then((function(){this.isPaginated||"horizontal"!==this.settings.axis||"rtl"!==this.settings.direction||"default"!==this.settings.rtlScrollType||this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e;let t=this.settings.direction;if(this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis&&(!t||"ltr"===t)?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===t?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft+this.container.offsetWidth<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev():this.container.scrollLeft<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let t=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&"object"!=typeof e.prev()&&(t=!0),this.prepend(e,t).then((function(){var t;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(t=e.prev()))return this.prepend(t)}).bind(this),e=>e).then((function(){this.isPaginated&&"horizontal"===this.settings.axis&&("rtl"===this.settings.direction?"default"===this.settings.rtlScrollType?this.scrollTo(0,0,!0):this.scrollTo(-1*this.container.scrollWidth+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&"horizontal"===this.settings.axis?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=t.height<window.innerHeight?t.height:window.innerHeight,r=t.width<window.innerWidth?t.width:window.innerWidth,s="vertical"===this.settings.axis;this.settings.direction;let n=0;return this.settings.fullsize&&(n=s?window.scrollY:window.scrollX),e.map(e=>{let o,a,l,h,{index:c,href:u}=e.section,d=e.position(),f=e.width(),p=e.height();s?(a=(o=n+t.top-d.top+0)+i-0,h=this.layout.count(p,i).pages,l=i):(a=(o=n+t.left-d.left+0)+r-0,h=this.layout.count(f,r).pages,l=r);let g=Math.ceil(o/l),m=[],v=Math.ceil(a/l);if("rtl"===this.settings.direction&&!s){let e=g;g=h-v,v=h-e}m=[];for(var y=g;y<=v;y++){let e=y+1;m.push(e)}return{index:c,href:u,pages:m,totalPages:h,mapping:this.mapping.page(e.contents,e.section.cfiBase,o,a)}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=0,r=0;return this.settings.fullsize&&(i=window.scrollX),e.map(e=>{let s,n,o,a,{index:l,href:h}=e.section,c=e.position(),u=e.width();"rtl"===this.settings.direction?(a=Math.min(Math.abs((s=t.right-i)-c.left),this.layout.width)-r,n=(o=c.width-(c.right-s)-r)-a):(s=t.left+i,a=Math.min(c.right-s,this.layout.width)-r,o=(n=s-c.left+r)+a),r+=a;let d=this.mapping.page(e.contents,e.section.cfiBase,n,o),f=this.layout.count(u).pages,p=Math.floor(n/this.layout.pageWidth),g=[],m=Math.floor(o/this.layout.pageWidth);if(p<0&&(p=0,m+=1),"rtl"===this.settings.direction){let e=p;p=f-m,m=f-e}for(var v=p+1;v<=m;v++){let e=v;g.push(e)}return{index:l,href:h,pages:g,totalPages:f,mapping:d}})}isVisible(e,t,i,r){var s=e.position(),n=r||this.bounds();return"horizontal"===this.settings.axis&&s.right>n.left-t&&s.left<n.right+i||"vertical"===this.settings.axis&&s.bottom>n.top-t&&s.top<n.bottom+i}visible(){for(var e,t=this.bounds(),i=this.views.displayed(),r=i.length,s=[],n=0;n<r;n++)e=i[n],!0===this.isVisible(e,0,0,t)&&s.push(e);return s}scrollBy(e,t,i){let r="rtl"===this.settings.direction?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*r,t*r):(e&&(this.container.scrollLeft+=e*r),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(eh.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(eh.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){return this.stage.bounds()}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&"pre-paginated"===this.layout.name&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new e_(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){(t||e!==this.settings.axis)&&(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new e_(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&("vertical"===e?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let i="paginated"===e||"auto"===e;this.isPaginated=i,"scrolled-doc"===e||"scrolled-continuous"===e||"scrolled"===e?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){let i=t&&t.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}n()(eL.prototype);let eP=eL,ej={easeInCubic:function(e){return Math.pow(e,3)}};class eU{constructor(e,t){this.settings=m({duration:80,minVelocity:.2,minDistance:10,easing:ej.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(eh.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(eh.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(e=>{t.on(e,e=>this.triggerViewEvent(e,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:i}=e.touches[0],r=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&r<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();0!==t?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,i=Math.abs(t),r=t/(this.endTime-this.startTime),s=this.settings.minVelocity;return i<=this.settings.minDistance||i>=e?0:r>s?-1:r<-s?1:void 0}needsSnap(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!=0}snap(e=0){let t=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,r=Math.round(t/i)*i;return e&&(r+=e*i),this.smoothScrollTo(r)}smoothScrollTo(e){let t=new M,i=this.scrollLeft,r=this.now(),s=this.settings.duration,n=this.settings.easing;return this.snapping=!0,(function o(){let a=Math.min(1,(this.now()-r)/s);if(n(a),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}a<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*a,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}).call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}n()(eU.prototype);var eq=i(7610),eB=i.n(eq);class e$ extends eP{constructor(e){super(e),this.name="continuous",this.settings=m(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),m(this.settings,e.settings||{}),"undefined"!=e.settings.gap&&0===e.settings.gap&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return eP.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new M;return this.q.enqueue(()=>this.check()).then(e=>{e?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,i=0;this.isPaginated?t=Math.floor(e.left/this.layout.delta)*this.layout.delta:(i=e.top,e.top),this.settings.offsetDelta,(t>0||i>0)&&this.scrollBy(t,i,!0)}afterResized(e){this.emit(eh.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(eh.VIEWS.RESIZED,e=>{t.expanded=!0}),t.on(eh.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on(eh.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(eh.VIEWS.RESIZED,e=>{t.expanded=!0}),t.on(eh.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on(eh.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(eh.VIEWS.RESIZED,e=>{this.counter(e),t.expanded=!0}),t.on(eh.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on(eh.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){"vertical"===this.settings.axis?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t,i=this.bounds(),r=this.views.all(),s=r.length,n=[],o=void 0!==e?e:this.settings.offset||0,a=new M,l=[],h=0;h<s;h++)if(t=r[h],!0===this.isVisible(t,o,o,i)){if(t.displayed)t.show();else{let e=t.display(this.request).then(function(e){e.show()},e=>{t.hide()});l.push(e)}n.push(t)}else this.q.enqueue(t.destroy.bind(t)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return l.length?Promise.all(l).catch(e=>{a.reject(e)}):(a.resolve(),a.promise)}check(e,t){var i=new M,r=[],s="horizontal"===this.settings.axis,n=this.settings.offset||0;e&&s&&(n=e),t&&!s&&(n=t);var o=this._bounds;let a=s?this.scrollLeft:this.scrollTop,l=s?Math.floor(o.width):o.height,h=s?this.container.scrollWidth:this.container.scrollHeight,c=this.writingMode&&0===this.writingMode.indexOf("vertical")?"vertical":"horizontal",u=this.settings.rtlScrollType,d="rtl"===this.settings.direction;this.settings.fullsize?(s&&d&&"negative"===u||!s&&d&&"default"===u)&&(a*=-1):(d&&"default"===u&&"horizontal"===c&&(a=h-l-a),d&&"negative"===u&&"horizontal"===c&&(a*=-1));let f=a+l+n,p=a-n;f>=h&&(()=>{let e=this.views.last(),t=e&&e.section.next();t&&r.push(this.append(t))})(),p<0&&(()=>{let e=this.views.first(),t=e&&e.section.prev();t&&r.push(this.prepend(t))})();let g=r.map(e=>e.display(this.request));return r.length?Promise.all(g).then(()=>this.check()).then(()=>this.update(n),e=>e):(this.q.enqueue((function(){this.update()}).bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new M,t=this.views.displayed(),i=t[0],r=t[t.length-1],s=this.views.indexOf(i),n=this.views.indexOf(r),o=this.views.slice(0,s),a=this.views.slice(n+1),l=0;l<o.length-1;l++)this.erase(o[l],o);for(var h=1;h<a.length;h++)this.erase(a[h]);return e.resolve(),e.promise}erase(e,t){this.settings.fullsize?(i=window.scrollY,r=window.scrollX):(i=this.container.scrollTop,r=this.container.scrollLeft);var i,r,s=e.bounds();this.views.remove(e),t&&("vertical"===this.settings.axis?this.scrollTo(0,i-s.height,!0):"rtl"===this.settings.direction?this.settings.fullsize?this.scrollTo(r+Math.floor(s.width),0,!0):this.scrollTo(r,0,!0):this.scrollTo(r-Math.floor(s.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(e){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new eU(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap))}addScrollListeners(){var e;this.tick=a;let t="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=eB()(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t;let i="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.settings.fullsize?(e=window.scrollY*i,t=window.scrollX*i):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(eh.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(eh.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new eU(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class eM{constructor(e,t){this.settings=m(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),m(this.settings,t),"object"==typeof this.settings.manager&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new Q(this),this.hooks.serialize=new Q(this),this.hooks.content=new Q(this),this.hooks.unloaded=new Q(this),this.hooks.layout=new Q(this),this.hooks.render=new Q(this),this.hooks.show=new Q(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new ew(this),this.annotations=new ex(this),this.epubcfi=new Z,this.q=new ea(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new M,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){return"string"==typeof e&&"default"===e?eP:"string"==typeof e&&"continuous"===e?e$:e}requireView(e){return"string"==typeof e&&"iframe"===e?eR:e}start(){switch(this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(eh.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(eh.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(eh.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(eh.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(eh.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(eh.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(eh.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t,i=new M,r=i.promise;return(this.displaying=i,this.book.locations.length()&&f(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),t=this.book.spine.get(e))?this.manager.display(t,e).then(()=>{i.resolve(t),this.displaying=void 0,this.emit(eh.RENDITION.DISPLAYED,t),this.reportLocation()},e=>{this.emit(eh.RENDITION.DISPLAY_ERROR,e)}):i.reject(Error("No Section Found")),r}}afterDisplayed(e){e.on(eh.VIEWS.MARK_CLICKED,(t,i)=>this.triggerMarkEvent(t,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(eh.RENDITION.RENDERED,e.section,e)}):this.emit(eh.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(eh.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(eh.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(eh.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,i){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t=this.settings.layout||e.layout||"reflowable",i=this.settings.spread||e.spread||"auto",r=this.settings.orientation||e.orientation||"auto",s=this.settings.flow||e.flow||"auto",n=e.viewport||"",o=this.settings.minSpreadWidth||e.minSpreadWidth||800,a=this.settings.direction||e.direction||"ltr";return(0===this.settings.width||this.settings.width>0)&&(0===this.settings.height||this.settings.height),{layout:t,spread:i,orientation:r,flow:s,viewport:n,minSpreadWidth:o,direction:a}}flow(e){var t=e;("scrolled"===e||"scrolled-doc"===e||"scrolled-continuous"===e)&&(t="scrolled"),("auto"===e||"paginated"===e)&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new eb(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(eh.LAYOUT.UPDATED,(e,t)=>{this.emit(eh.RENDITION.LAYOUT,e,t)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var e=this.manager.currentLocation();if(e&&e.then&&"function"==typeof e.then)e.then((function(e){let t=this.located(e);t&&t.start&&t.end&&(this.location=t,this.emit(eh.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(eh.RENDITION.RELOCATED,this.location))}).bind(this));else if(e){let t=this.located(e);if(!t||!t.start||!t.end)return;this.location=t,this.emit(eh.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(eh.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&"function"==typeof e.then)e.then((function(e){return this.located(e)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],i=e[e.length-1],r={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},s=this.book.locations.locationFromCfi(t.mapping.start),n=this.book.locations.locationFromCfi(i.mapping.end);null!=s&&(r.start.location=s,r.start.percentage=this.book.locations.percentageFromLocation(s)),null!=n&&(r.end.location=n,r.end.percentage=this.book.locations.percentageFromLocation(n));let o=this.book.pageList.pageFromCfi(t.mapping.start),a=this.book.pageList.pageFromCfi(i.mapping.end);return -1!=o&&(r.start.page=o),-1!=a&&(r.end.page=a),i.index===this.book.spine.last().index&&r.end.displayed.page>=r.end.displayed.total&&(r.atEnd=!0),t.index===this.book.spine.first().index&&1===r.start.displayed.page&&(r.atStart=!0),r}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){el.forEach(t=>{e.on(t,t=>this.triggerViewEvent(t,e))}),e.on(eh.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(eh.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,i){this.emit(eh.RENDITION.MARK_CLICKED,e,t,i)}getRange(e,t){var i=new Z(e),r=this.manager.visible().filter(function(e){if(i.spinePos===e.index)return!0});if(r.length)return r[0].contents.range(i,t)}adjustImages(e){if("pre-paginated"===this._layout.name)return new Promise(function(e){e()});let t=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,r=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(e,t){setTimeout(function(){e()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(eh.CONTENTS.LINK_CLICKED,e=>{let t=this.book.path.relative(e);this.display(t)})}injectStylesheet(e,t){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,t){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,t){let i=this.book.packaging.metadata.identifier,r=e.createElement("meta");r.setAttribute("name","dc.relation.ispartof"),i&&r.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(r)}}n()(eM.prototype);var ez=i(2503),eF=i.n(ez);class eW{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new(eF())}catch(e){throw Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return es(e,"binary").then((function(e){return this.zip.loadAsync(e,{base64:t})}).bind(this))}request(e,t){var i,r=new M,s=new X(e);return t||(t=s.extension),(i="blob"==t?this.getBlob(e):this.getText(e))?i.then((function(e){let i=this.handleResponse(e,t);r.resolve(i)}).bind(this)):r.reject({message:"File not found in the epub: "+e,stack:Error().stack}),r.promise}handleResponse(e,t){return"json"==t?JSON.parse(e):C(t)?I(e,"text/xml"):"xhtml"==t?I(e,"application/xhtml+xml"):"html"==t||"htm"==t?I(e,"text/html"):e}getBlob(e,t){var i=window.decodeURIComponent(e.substr(1)),r=this.zip.file(i);if(r)return t=t||em.lookup(r.name),r.async("uint8array").then(function(e){return new Blob([e],{type:t})})}getText(e,t){var i=window.decodeURIComponent(e.substr(1)),r=this.zip.file(i);if(r)return r.async("string").then(function(e){return e})}getBase64(e,t){var i=window.decodeURIComponent(e.substr(1)),r=this.zip.file(i);if(r)return t=t||em.lookup(r.name),r.async("base64").then(function(e){return"data:"+t+";base64,"+e})}createUrl(e,t){var i,r,s=new M,n=window.URL||window.webkitURL||window.mozURL,o=t&&t.base64;return e in this.urlCache?s.resolve(this.urlCache[e]):(o?(r=this.getBase64(e))&&r.then((function(t){this.urlCache[e]=t,s.resolve(t)}).bind(this)):(r=this.getBlob(e))&&r.then((function(t){i=n.createObjectURL(t),this.urlCache[e]=i,s.resolve(i)}).bind(this)),r||s.reject({message:"File not found in the epub: "+e,stack:Error().stack})),s.promise}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var eV=i(1873),eH=i.n(eV);class eG{constructor(e,t,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||es,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;void 0===eH()&&(e=eH()),this.storage=e.createInstance({name:this.name})}catch(e){throw Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){return Promise.all(e.resources.map(e=>{let{href:i}=e,r=this.resolver(i),s=window.encodeURIComponent(r);return this.storage.getItem(s).then(e=>!e||t?this.requester(r,"binary").then(e=>this.storage.setItem(s,e)):e)}))}put(e,t,i){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(s=>s||this.requester(e,"binary",t,i).then(e=>this.storage.setItem(r,e)))}request(e,t,i,r){return this.online?this.requester(e,t,i,r).then(t=>(this.put(e),t)):this.retrieve(e,t)}retrieve(e,t){new M;var i=new X(e);return t||(t=i.extension),("blob"==t?this.getBlob(e):this.getText(e)).then(i=>{var r,s=new M;return i?(r=this.handleResponse(i,t),s.resolve(r)):s.reject({message:"File not found in storage: "+e,stack:Error().stack}),s.promise})}handleResponse(e,t){return"json"==t?JSON.parse(e):C(t)?I(e,"text/xml"):"xhtml"==t?I(e,"application/xhtml+xml"):"html"==t||"htm"==t?I(e,"text/html"):e}getBlob(e,t){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(i){if(i)return new Blob([i],{type:t=t||em.lookup(e)})})}getText(e,t){let i=window.encodeURIComponent(e);return t=t||em.lookup(e),this.storage.getItem(i).then(function(e){var i,r=new M,s=new FileReader;if(e)return i=new Blob([e],{type:t}),s.addEventListener("loadend",()=>{r.resolve(s.result)}),s.readAsText(i,t),r.promise})}getBase64(e,t){let i=window.encodeURIComponent(e);return t=t||em.lookup(e),this.storage.getItem(i).then(e=>{var i,r=new M,s=new FileReader;if(e)return i=new Blob([e],{type:t}),s.addEventListener("loadend",()=>{r.resolve(s.result)}),s.readAsDataURL(i,t),r.promise})}createUrl(e,t){var i,r,s=new M,n=window.URL||window.webkitURL||window.mozURL,o=t&&t.base64;return e in this.urlCache?s.resolve(this.urlCache[e]):(o?(r=this.getBase64(e))&&r.then((function(t){this.urlCache[e]=t,s.resolve(t)}).bind(this)):(r=this.getBlob(e))&&r.then((function(t){i=n.createObjectURL(t),this.urlCache[e]=i,s.resolve(i)}).bind(this)),r||s.reject({message:"File not found in storage: "+e,stack:Error().stack})),s.promise}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}n()(eG.prototype);class eK{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;let t=L(e,"display_options");return t&&P(t,"option").forEach(e=>{let t="";switch(e.childNodes.length&&(t=e.childNodes[0].nodeValue),e.attributes.name.value){case"interactive":this.interactive=t;break;case"fixed-layout":this.fixedLayout=t;break;case"open-to-spread":this.openToSpread=t;break;case"orientation-lock":this.orientationLock=t}}),this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}let eJ="META-INF/container.xml",eX={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class eY{constructor(e,t){void 0===t&&"string"!=typeof e&&e instanceof Blob==!1&&e instanceof ArrayBuffer==!1&&(t=e,e=void 0),this.settings=m(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),m(this.settings,t),this.opening=new M,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new M,spine:new M,metadata:new M,cover:new M,navigation:new M,pageList:new M,resources:new M,displayOptions:new M},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||es,this.spine=new eo,this.locations=new ec(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(t=>{var i=Error("Cannot load book at "+e);this.emit(eh.BOOK.OPEN_FAILED,i)})}open(e,t){var i,r=t||this.determineType(e);return r===eX.BINARY?(this.archived=!0,this.url=new Y("/",""),i=this.openEpub(e)):r===eX.BASE64?(this.archived=!0,this.url=new Y("/",""),i=this.openEpub(e,r)):r===eX.EPUB?(this.archived=!0,this.url=new Y("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):r==eX.OPF?(this.url=new Y(e),i=this.openPackaging(this.url.Path.toString())):r==eX.MANIFEST?(this.url=new Y(e),i=this.openManifest(this.url.Path.toString())):(this.url=new Y(e),i=this.openContainer(eJ).then(this.openPackaging.bind(this))),i}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(eJ)).then(e=>this.openPackaging(e))}openContainer(e){return this.load(e).then(e=>(this.container=new eu(e),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new X(e),this.load(e).then(e=>(this.packaging=new ed(e),this.unpack(this.packaging)))}openManifest(e){return this.path=new X(e),this.load(e).then(e=>(this.packaging=new ed,this.packaging.load(e),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var i=e;return e.indexOf("://")>-1?e:(this.path&&(i=this.path.resolve(e)),!1!=t&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){return e?this.settings.canonical?this.settings.canonical(e):this.resolve(e,!0):""}determineType(e){var t;return"base64"===this.settings.encoding?eX.BASE64:"string"!=typeof e?eX.BINARY:((t=new Y(e).path().extension)&&(t=t.replace(/\?.*$/,"")),t)?"epub"===t?eX.EPUB:"opf"===t?eX.OPF:"json"===t?eX.MANIFEST:void 0:eX.DIRECTORY}unpack(e){this.package=e,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then(e=>{this.displayOptions=new eK(e),this.loading.displayOptions.resolve(this.displayOptions)}).catch(e=>{this.displayOptions=new eK,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new eK,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new ev(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(e=>{console.error(e)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((t,r)=>{this.navigation=new ef(i),e.pageList&&(this.pageList=new ey(e.pageList)),t(this.navigation)}):t?this.load(t,"xml").then(e=>(this.navigation=new ef(e),this.pageList=new ey(e),this.navigation)):new Promise((e,t)=>{this.navigation=new ef,this.pageList=new ey,e(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new eM(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new eW,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&"none"!==this.settings.replacements,i=this.url,r=this.settings.requestMethod||es.bind(this);return this.storage=new eG(e,r,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let e=(e,t)=>{t.output=this.resources.substitute(e,t.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Y("/",""),this.spine.hooks.serialize.register(e)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(e)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new Z(e),i=this.spine.get(t.spinePos),r=this.load.bind(this);return i?i.load(r).then(function(e){return t.toRange(i.document)}):new Promise((e,t)=>{t("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:0.3:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}function eZ(e,t){return new eY(e,t)}n()(eY.prototype),eZ.VERSION="0.3",void 0!==i.g&&(i.g.EPUBJS_VERSION="0.3"),eZ.Book=eY,eZ.Rendition=eM,eZ.Contents=ek,eZ.CFI=Z,eZ.utils=r;let eQ=eZ},0:e=>{"use strict";e.exports=function(){}},5171:(e,t,i)=>{"use strict";e.exports=i(5048)()?Object.assign:i(6924)},5048:e=>{"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},6924:(e,t,i)=>{"use strict";var r=i(5514),s=i(4345),n=Math.max;e.exports=function(e,t){var i,o,a,l=n(arguments.length,2);for(o=1,e=Object(s(e)),a=function(r){try{e[r]=t[r]}catch(e){i||(i=e)}};o<l;++o)t=arguments[o],r(t).forEach(a);if(void 0!==i)throw i;return e}},8289:(e,t,i)=>{"use strict";var r=i(0)();e.exports=function(e){return e!==r&&null!==e}},5514:(e,t,i)=>{"use strict";e.exports=i(3411)()?Object.keys:i(7883)},3411:e=>{"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},7883:(e,t,i)=>{"use strict";var r=i(8289),s=Object.keys;e.exports=function(e){return s(r(e)?Object(e):e)}},6293:(e,t,i)=>{"use strict";var r=i(8289),s=Array.prototype.forEach,n=Object.create,o=function(e,t){var i;for(i in e)t[i]=e[i]};e.exports=function(e){var t=n(null);return s.call(arguments,function(e){r(e)&&o(Object(e),t)}),t}},9284:e=>{"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function");return e}},4345:(e,t,i)=>{"use strict";var r=i(8289);e.exports=function(e){if(!r(e))throw TypeError("Cannot use null or undefined");return e}},4605:(e,t,i)=>{"use strict";e.exports=i(994)()?String.prototype.contains:i(1562)},994:e=>{"use strict";var t="razdwatrzy";e.exports=function(){return"function"==typeof t.contains&&!0===t.contains("dwa")&&!1===t.contains("foo")}},1562:e=>{"use strict";var t=String.prototype.indexOf;e.exports=function(e){return t.call(this,e,arguments[1])>-1}},2235:(e,t,i)=>{"use strict";var r,s,n,o,a,l,h,c=i(560),u=i(9284),d=Function.prototype.apply,f=Function.prototype.call,p=Object.create,g=Object.defineProperty,m=Object.defineProperties,v=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var i;return u(t),v.call(this,"__ee__")?i=this.__ee__:(i=y.value=p(null),g(this,"__ee__",y),y.value=null),i[e]?"object"==typeof i[e]?i[e].push(t):i[e]=[i[e],t]:i[e]=t,this},s=function(e,t){var i,s;return u(t),s=this,r.call(this,e,i=function(){n.call(s,e,i),d.call(t,this,arguments)}),i.__eeOnceListener__=t,this},a={on:r,once:s,off:n=function(e,t){var i,r,s,n;if(u(t),!v.call(this,"__ee__")||!(i=this.__ee__)[e])return this;if("object"==typeof(r=i[e]))for(n=0;s=r[n];++n)(s===t||s.__eeOnceListener__===t)&&(2===r.length?i[e]=r[n?0:1]:r.splice(n,1));else(r===t||r.__eeOnceListener__===t)&&delete i[e];return this},emit:o=function(e){var t,i,r,s,n;if(v.call(this,"__ee__")&&(s=this.__ee__[e])){if("object"==typeof s){for(t=1,i=arguments.length,n=Array(i-1);t<i;++t)n[t-1]=arguments[t];for(t=0,s=s.slice();r=s[t];++t)d.call(r,this,n)}else switch(arguments.length){case 1:f.call(s,this);break;case 2:f.call(s,this,arguments[1]);break;case 3:f.call(s,this,arguments[1],arguments[2]);break;default:for(t=1,i=arguments.length,n=Array(i-1);t<i;++t)n[t-1]=arguments[t];d.call(s,this,n)}}}},h=m({},l={on:c(r),once:c(s),off:c(n),emit:c(o)}),e.exports=t=function(e){return null==e?p(h):m(Object(e),l)},t.methods=a},8056:(e,t)=>{t.read=function(e,t,i,r,s){var n,o,a=8*s-r-1,l=(1<<a)-1,h=l>>1,c=-7,u=i?s-1:0,d=i?-1:1,f=e[t+u];for(u+=d,n=f&(1<<-c)-1,f>>=-c,c+=a;c>0;n=256*n+e[t+u],u+=d,c-=8);for(o=n&(1<<-c)-1,n>>=-c,c+=r;c>0;o=256*o+e[t+u],u+=d,c-=8);if(0===n)n=1-h;else{if(n===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),n-=h}return(f?-1:1)*o*Math.pow(2,n-r)},t.write=function(e,t,i,r,s,n){var o,a,l,h=8*n-s-1,c=(1<<h)-1,u=c>>1,d=23===s?5960464477539062e-23:0,f=r?0:n-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+u>=1?t+=d/l:t+=d*Math.pow(2,1-u),t*l>=2&&(o++,l/=2),o+u>=c?(a=0,o=c):o+u>=1?(a=(t*l-1)*Math.pow(2,s),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,s),o=0));s>=8;e[i+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,h+=s;h>0;e[i+f]=255&o,f+=p,o/=256,h-=8);e[i+f-p]|=128*g}},1873:(e,t,i)=>{var r;r=function(){return(function e(t,i,r){function s(o,a){if(!i[o]){if(!t[o]){if(n)return n(o,!0);var l=Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};t[o][0].call(h.exports,function(e){return s(t[o][1][e]||e)},h,h.exports,e,t,i,r)}return i[o].exports}for(var n=void 0,o=0;o<r.length;o++)s(r[o]);return s})({1:[function(e,t,r){(function(e){"use strict";var i,r,s=e.MutationObserver||e.WebKitMutationObserver;if(s){var n=0,o=new s(c),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),i=function(){a.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,i=function(){l.port2.postMessage(0)}}var h=[];function c(){r=!0;for(var e,t,i=h.length;i;){for(t=h,h=[],e=-1;++e<i;)t[e]();i=h.length}r=!1}t.exports=function(e){1!==h.push(e)||r||i()}}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){"use strict";var r=e(1);function s(){}var n={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function h(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==s&&f(this,e)}function c(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function u(e,t,i){r(function(){var r;try{r=t(i)}catch(t){return n.reject(e,t)}r===e?n.reject(e,TypeError("Cannot resolve promise with itself")):n.resolve(e,r)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var i=!1;function r(t){i||(i=!0,n.reject(e,t))}function s(t){i||(i=!0,n.resolve(e,t))}var o=p(function(){t(s,r)});"error"===o.status&&r(o.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}t.exports=h,h.prototype.catch=function(e){return this.then(null,e)},h.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(s);return this.state!==l?u(i,this.state===a?e:t,this.outcome):this.queue.push(new c(i,e,t)),i},c.prototype.callFulfilled=function(e){n.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){n.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},n.resolve=function(e,t){var i=p(d,t);if("error"===i.status)return n.reject(e,i.value);var r=i.value;if(r)f(e,r);else{e.state=a,e.outcome=t;for(var s=-1,o=e.queue.length;++s<o;)e.queue[s].callFulfilled(t)}return e},n.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e},h.resolve=function(e){return e instanceof this?e:n.resolve(new this(s),e)},h.reject=function(e){var t=new this(s);return n.reject(t,e)},h.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=Array(i),a=0,l=-1,h=new this(s);++l<i;)(function(e,s){t.resolve(e).then(function(e){o[s]=e,++a!==i||r||(r=!0,n.resolve(h,o))},function(e){r||(r=!0,n.reject(h,e))})})(e[l],l);return h},h.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=-1,a=new this(s);++o<i;)(function(e){t.resolve(e).then(function(e){r||(r=!0,n.resolve(a,e))},function(e){r||(r=!0,n.reject(a,e))})})(e[o]);return a}},{1:1}],3:[function(e,t,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(s){if("TypeError"!==s.name)throw s;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)i.append(e[r]);return i.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var o=Promise;function a(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function l(e,t,i){"function"==typeof t&&e.then(t),"function"==typeof i&&e.catch(i)}function h(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function c(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var u="local-forage-detect-blob-support",d=void 0,f={},p=Object.prototype.toString,g="readonly",m="readwrite";function v(e){var t=f[e.name],i={};i.promise=new o(function(e,t){i.resolve=e,i.reject=t}),t.deferredOperations.push(i),t.dbReady?t.dbReady=t.dbReady.then(function(){return i.promise}):t.dbReady=i.promise}function y(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function b(e,t){var i=f[e.name].deferredOperations.pop();if(i)return i.reject(t),i.promise}function w(e,t){return new o(function(i,r){if(f[e.name]=f[e.name]||x(),e.db){if(!t)return i(e.db);v(e),e.db.close()}var n=[e.name];t&&n.push(e.version);var o=s.open.apply(s,n);t&&(o.onupgradeneeded=function(t){var i=o.result;try{i.createObjectStore(e.storeName),t.oldVersion<=1&&i.createObjectStore(u)}catch(i){if("ConstraintError"===i.name)console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw i}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},i(t),y(e)}})}function _(e,t){if(!e.db)return!0;var i=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,s=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||i){if(i){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function E(e){return n([function(e){for(var t=e.length,i=new ArrayBuffer(t),r=new Uint8Array(i),s=0;s<t;s++)r[s]=e.charCodeAt(s);return i}(atob(e.data))],{type:e.type})}function S(e){return e&&e.__local_forage_encoded_blob}function T(e){var t=this,i=t._initReady().then(function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return l(i,e,e),i}function k(e,t,i,r){void 0===r&&(r=1);try{var s=e.db.transaction(e.storeName,t);i(null,s)}catch(s){if(r>0&&(!e.db||"InvalidStateError"===s.name||"NotFoundError"===s.name))return o.resolve().then(function(){if(!e.db||"NotFoundError"===s.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),w(e,!0)}).then(function(){return(function(e){v(e);for(var t=f[e.name],i=t.forages,r=0;r<i.length;r++){var s=i[r];s._dbInfo.db&&(s._dbInfo.db.close(),s._dbInfo.db=null)}return e.db=null,w(e,!1).then(function(t){return(e.db=t,_(e))?w(e,!0):t}).then(function(r){e.db=t.db=r;for(var s=0;s<i.length;s++)i[s]._dbInfo.db=r}).catch(function(t){throw b(e,t),t})})(e).then(function(){k(e,t,i,r-1)})}).catch(i);i(s)}}function x(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}var C={_driver:"asyncStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var r in e)i[r]=e[r];var s=f[i.name];s||(s=x(),f[i.name]=s),s.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=T);var n=[];function a(){return o.resolve()}for(var l=0;l<s.forages.length;l++){var h=s.forages[l];h!==t&&n.push(h._initReady().catch(a))}var c=s.forages.slice(0);return o.all(n).then(function(){return i.db=s.db,w(i,!1)}).then(function(e){return(i.db=e,_(i,t._defaultConfig.version))?w(i,!0):e}).then(function(e){i.db=s.db=e,t._dbInfo=i;for(var r=0;r<c.length;r++){var n=c[r];n!==t&&(n._dbInfo.db=i.db,n._dbInfo.version=i.version)}})},_support:function(){try{if(!s||!s.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var i=this,r=new o(function(t,r){i.ready().then(function(){k(i._dbInfo,g,function(s,n){if(s)return r(s);try{var o=n.objectStore(i._dbInfo.storeName).openCursor(),a=1;o.onsuccess=function(){var i=o.result;if(i){var r=i.value;S(r)&&(r=E(r));var s=e(r,i.key,a++);void 0!==s?t(s):i.continue()}else t()},o.onerror=function(){r(o.error)}}catch(e){r(e)}})}).catch(r)});return a(r,t),r},getItem:function(e,t){var i=this;e=h(e);var r=new o(function(t,r){i.ready().then(function(){k(i._dbInfo,g,function(s,n){if(s)return r(s);try{var o=n.objectStore(i._dbInfo.storeName).get(e);o.onsuccess=function(){var e=o.result;void 0===e&&(e=null),S(e)&&(e=E(e)),t(e)},o.onerror=function(){r(o.error)}}catch(e){r(e)}})}).catch(r)});return a(r,t),r},setItem:function(e,t,i){var r=this;e=h(e);var s=new o(function(i,s){var a;r.ready().then(function(){var e;return(a=r._dbInfo,"[object Blob]"===p.call(t))?(e=a.db,"boolean"==typeof d?o.resolve(d):new o(function(t){var i=e.transaction(u,m),r=n([""]);i.objectStore(u).put(r,"key"),i.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},i.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);t(navigator.userAgent.match(/Edge\//)||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1}).then(function(e){return d=e})).then(function(e){return e?t:new o(function(e,i){var r=new FileReader;r.onerror=i,r.onloadend=function(i){e({__local_forage_encoded_blob:!0,data:btoa(i.target.result||""),type:t.type})},r.readAsBinaryString(t)})}):t}).then(function(t){k(r._dbInfo,m,function(n,o){if(n)return s(n);try{var a=o.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);o.oncomplete=function(){void 0===t&&(t=null),i(t)},o.onabort=o.onerror=function(){var e=l.error?l.error:l.transaction.error;s(e)}}catch(e){s(e)}})}).catch(s)});return a(s,i),s},removeItem:function(e,t){var i=this;e=h(e);var r=new o(function(t,r){i.ready().then(function(){k(i._dbInfo,m,function(s,n){if(s)return r(s);try{var o=n.objectStore(i._dbInfo.storeName).delete(e);n.oncomplete=function(){t()},n.onerror=function(){r(o.error)},n.onabort=function(){var e=o.error?o.error:o.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return a(r,t),r},clear:function(e){var t=this,i=new o(function(e,i){t.ready().then(function(){k(t._dbInfo,m,function(r,s){if(r)return i(r);try{var n=s.objectStore(t._dbInfo.storeName).clear();s.oncomplete=function(){e()},s.onabort=s.onerror=function(){var e=n.error?n.error:n.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return a(i,e),i},length:function(e){var t=this,i=new o(function(e,i){t.ready().then(function(){k(t._dbInfo,g,function(r,s){if(r)return i(r);try{var n=s.objectStore(t._dbInfo.storeName).count();n.onsuccess=function(){e(n.result)},n.onerror=function(){i(n.error)}}catch(e){i(e)}})}).catch(i)});return a(i,e),i},key:function(e,t){var i=this,r=new o(function(t,r){if(e<0){t(null);return}i.ready().then(function(){k(i._dbInfo,g,function(s,n){if(s)return r(s);try{var o=n.objectStore(i._dbInfo.storeName),a=!1,l=o.openKeyCursor();l.onsuccess=function(){var i=l.result;if(!i){t(null);return}0===e?t(i.key):a?t(i.key):(a=!0,i.advance(e))},l.onerror=function(){r(l.error)}}catch(e){r(e)}})}).catch(r)});return a(r,t),r},keys:function(e){var t=this,i=new o(function(e,i){t.ready().then(function(){k(t._dbInfo,g,function(r,s){if(r)return i(r);try{var n=s.objectStore(t._dbInfo.storeName).openKeyCursor(),o=[];n.onsuccess=function(){var t=n.result;if(!t){e(o);return}o.push(t.key),t.continue()},n.onerror=function(){i(n.error)}}catch(e){i(e)}})}).catch(i)});return a(i,e),i},dropInstance:function(e,t){t=c.apply(this,arguments);var i,r=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName),e.name){var n=e.name===r.name&&this._dbInfo.db?o.resolve(this._dbInfo.db):w(e,!1).then(function(t){var i=f[e.name],r=i.forages;i.db=t;for(var s=0;s<r.length;s++)r[s]._dbInfo.db=t;return t});i=e.storeName?n.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var i=t.version+1;v(e);var r=f[e.name],n=r.forages;t.close();for(var a=0;a<n.length;a++){var l=n[a];l._dbInfo.db=null,l._dbInfo.version=i}return new o(function(t,r){var n=s.open(e.name,i);n.onerror=function(e){n.result.close(),r(e)},n.onupgradeneeded=function(){n.result.deleteObjectStore(e.storeName)},n.onsuccess=function(){var e=n.result;e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<n.length;t++){var i=n[t];i._dbInfo.db=e,y(i._dbInfo)}}).catch(function(t){throw(b(e,t)||o.resolve()).catch(function(){}),t})}}):n.then(function(t){v(e);var i=f[e.name],r=i.forages;t.close();for(var n=0;n<r.length;n++)r[n]._dbInfo.db=null;return new o(function(t,i){var r=s.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),i(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}).then(function(e){i.db=e;for(var t=0;t<r.length;t++)y(r[t]._dbInfo)}).catch(function(t){throw(b(e,t)||o.resolve()).catch(function(){}),t})})}else i=o.reject("Invalid arguments");return a(i,t),i}},A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=/^~~local_forage_type~([^~]+)~/,D="__lfsc__:",O=D.length,N="arbf",I="blob",L="si08",P="ui08",j="uic8",U="si16",q="si32",B="ur16",$="ui32",M="fl32",z="fl64",F=O+N.length,W=Object.prototype.toString;function V(e){var t,i,r,s,n,o=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var h=new ArrayBuffer(o),c=new Uint8Array(h);for(t=0;t<a;t+=4)i=A.indexOf(e[t]),r=A.indexOf(e[t+1]),s=A.indexOf(e[t+2]),n=A.indexOf(e[t+3]),c[l++]=i<<2|r>>4,c[l++]=(15&r)<<4|s>>2,c[l++]=(3&s)<<6|63&n;return h}function H(e){var t,i=new Uint8Array(e),r="";for(t=0;t<i.length;t+=3)r+=A[i[t]>>2],r+=A[(3&i[t])<<4|i[t+1]>>4],r+=A[(15&i[t+1])<<2|i[t+2]>>6],r+=A[63&i[t+2]];return i.length%3==2?r=r.substring(0,r.length-1)+"=":i.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var G={serialize:function(e,t){var i="";if(e&&(i=W.call(e)),e&&("[object ArrayBuffer]"===i||e.buffer&&"[object ArrayBuffer]"===W.call(e.buffer))){var r,s=D;e instanceof ArrayBuffer?(r=e,s+=N):(r=e.buffer,"[object Int8Array]"===i?s+=L:"[object Uint8Array]"===i?s+=P:"[object Uint8ClampedArray]"===i?s+=j:"[object Int16Array]"===i?s+=U:"[object Uint16Array]"===i?s+=B:"[object Int32Array]"===i?s+=q:"[object Uint32Array]"===i?s+=$:"[object Float32Array]"===i?s+=M:"[object Float64Array]"===i?s+=z:t(Error("Failed to get type for BinaryArray"))),t(s+H(r))}else if("[object Blob]"===i){var n=new FileReader;n.onload=function(){t(D+I+("~~local_forage_type~"+e.type)+"~"+H(this.result))},n.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),t(null,i)}},deserialize:function(e){if(e.substring(0,O)!==D)return JSON.parse(e);var t,i=e.substring(F),r=e.substring(O,F);if(r===I&&R.test(i)){var s=i.match(R);t=s[1],i=i.substring(s[0].length)}var o=V(i);switch(r){case N:return o;case I:return n([o],{type:t});case L:return new Int8Array(o);case P:return new Uint8Array(o);case j:return new Uint8ClampedArray(o);case U:return new Int16Array(o);case B:return new Uint16Array(o);case q:return new Int32Array(o);case $:return new Uint32Array(o);case M:return new Float32Array(o);case z:return new Float64Array(o);default:throw Error("Unkown type: "+r)}},stringToBuffer:V,bufferToString:H};function K(e,t,i,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],i,r)}function J(e,t,i,r,s,n){e.executeSql(i,r,s,function(e,o){o.code===o.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,a){a.rows.length?n(e,o):K(e,t,function(){e.executeSql(i,r,s,n)},n)},n):n(e,o)},n)}function X(e,t,i,r){var s=this;e=h(e);var n=new o(function(n,o){s.ready().then(function(){void 0===t&&(t=null);var a=t,l=s._dbInfo;l.serializer.serialize(t,function(t,h){h?o(h):l.db.transaction(function(i){J(i,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){n(a)},function(e,t){o(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0){n(X.apply(s,[e,a,i,r-1]));return}o(t)}})})}).catch(o)});return a(n,i),n}var Y={_driver:"webSQLStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var r in e)i[r]="string"!=typeof e[r]?e[r].toString():e[r];var s=new o(function(e,r){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return r(e)}i.db.transaction(function(s){K(s,i,function(){t._dbInfo=i,e()},function(e,t){r(t)})},r)});return i.serializer=G,s},_support:"function"==typeof openDatabase,iterate:function(e,t){var i=this,r=new o(function(t,r){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){J(i,s,"SELECT * FROM "+s.storeName,[],function(i,r){for(var n=r.rows,o=n.length,a=0;a<o;a++){var l=n.item(a),h=l.value;if(h&&(h=s.serializer.deserialize(h)),void 0!==(h=e(h,l.key,a+1))){t(h);return}}t()},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},getItem:function(e,t){var i=this;e=h(e);var r=new o(function(t,r){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){J(i,s,"SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],function(e,i){var r=i.rows.length?i.rows.item(0).value:null;r&&(r=s.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},setItem:function(e,t,i){return X.apply(this,[e,t,i,1])},removeItem:function(e,t){var i=this;e=h(e);var r=new o(function(t,r){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){J(i,s,"DELETE FROM "+s.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},clear:function(e){var t=this,i=new o(function(e,i){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){J(t,r,"DELETE FROM "+r.storeName,[],function(){e()},function(e,t){i(t)})})}).catch(i)});return a(i,e),i},length:function(e){var t=this,i=new o(function(e,i){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){J(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,i){e(i.rows.item(0).c)},function(e,t){i(t)})})}).catch(i)});return a(i,e),i},key:function(e,t){var i=this,r=new o(function(t,r){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){J(i,s,"SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,i){t(i.rows.length?i.rows.item(0).key:null)},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},keys:function(e){var t=this,i=new o(function(e,i){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){J(t,r,"SELECT key FROM "+r.storeName,[],function(t,i){for(var r=[],s=0;s<i.rows.length;s++)r.push(i.rows.item(s).key);e(r)},function(e,t){i(t)})})}).catch(i)});return a(i,e),i},dropInstance:function(e,t){t=c.apply(this,arguments);var i,r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var s=this;return a(i=e.name?new o(function(t){var i;(i=e.name===r.name?s._dbInfo.db:openDatabase(e.name,"","",0),e.storeName)?t({db:i,storeNames:[e.storeName]}):t(new o(function(e,t){i.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,r){for(var s=[],n=0;n<r.rows.length;n++)s.push(r.rows.item(n).name);e({db:i,storeNames:s})},function(e,i){t(i)})},function(e){t(e)})}))}).then(function(e){return new o(function(t,i){e.db.transaction(function(r){for(var s=[],n=0,a=e.storeNames.length;n<a;n++)s.push(function(e){return new o(function(t,i){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){i(t)})})}(e.storeNames[n]));o.all(s).then(function(){t()}).catch(function(e){i(e)})},function(e){i(e)})})}):o.reject("Invalid arguments"),t),i}};function Z(e,t){var i=e.name+"/";return e.storeName!==t.storeName&&(i+=e.storeName+"/"),i}var Q={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var i in e)t[i]=e[i];return(t.keyPrefix=Z(e,this._defaultConfig),!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0)?(this._dbInfo=t,t.serializer=G,o.resolve()):o.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var i=this,r=i.ready().then(function(){for(var t=i._dbInfo,r=t.keyPrefix,s=r.length,n=localStorage.length,o=1,a=0;a<n;a++){var l=localStorage.key(a);if(0===l.indexOf(r)){var h=localStorage.getItem(l);if(h&&(h=t.serializer.deserialize(h)),void 0!==(h=e(h,l.substring(s),o++)))return h}}});return a(r,t),r},getItem:function(e,t){var i=this;e=h(e);var r=i.ready().then(function(){var t=i._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return a(r,t),r},setItem:function(e,t,i){var r=this;e=h(e);var s=r.ready().then(function(){void 0===t&&(t=null);var i=t;return new o(function(s,n){var o=r._dbInfo;o.serializer.serialize(t,function(t,r){if(r)n(r);else try{localStorage.setItem(o.keyPrefix+e,t),s(i)}catch(e){("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&n(e),n(e)}})})});return a(s,i),s},removeItem:function(e,t){var i=this;e=h(e);var r=i.ready().then(function(){var t=i._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return a(r,t),r},clear:function(e){var t=this,i=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var r=localStorage.key(i);0===r.indexOf(e)&&localStorage.removeItem(r)}});return a(i,e),i},length:function(e){var t=this.keys().then(function(e){return e.length});return a(t,e),t},key:function(e,t){var i=this,r=i.ready().then(function(){var t,r=i._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return a(r,t),r},keys:function(e){var t=this,i=t.ready().then(function(){for(var e=t._dbInfo,i=localStorage.length,r=[],s=0;s<i;s++){var n=localStorage.key(s);0===n.indexOf(e.keyPrefix)&&r.push(n.substring(e.keyPrefix.length))}return r});return a(i,e),i},dropInstance:function(e,t){if(t=c.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var i,r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var s=this;return a(i=e.name?new o(function(t){t(e.storeName?Z(e,s._defaultConfig):e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var i=localStorage.key(t);0===i.indexOf(e)&&localStorage.removeItem(i)}}):o.reject("Invalid arguments"),t),i}},ee=function(e,t){for(var i,r=e.length,s=0;s<r;){if((i=e[s])===t||"number"==typeof i&&"number"==typeof t&&isNaN(i)&&isNaN(t))return!0;s++}return!1},et=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},ei={},er={},es={INDEXEDDB:C,WEBSQL:Y,LOCALSTORAGE:Q},en=[es.INDEXEDDB._driver,es.WEBSQL._driver,es.LOCALSTORAGE._driver],eo=["dropInstance"],ea=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(eo),el={description:"",driver:en.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function eh(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var i in t)t.hasOwnProperty(i)&&(et(t[i])?arguments[0][i]=t[i].slice():arguments[0][i]=t[i])}return arguments[0]}var ec=new(function(){function e(t){for(var i in function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e),es)if(es.hasOwnProperty(i)){var r=es[i],s=r._driver;this[i]=s,ei[s]||this.defineDriver(r)}this._defaultConfig=eh({},el),this._config=eh({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if((void 0===e?"undefined":r(e))==="object"){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,i){var r=new o(function(t,i){try{var r=e._driver,s=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver){i(s);return}for(var n=ea.concat("_initStorage"),l=0,h=n.length;l<h;l++){var c=n[l];if((!ee(eo,c)||e[c])&&"function"!=typeof e[c]){i(s);return}}!function(){for(var t=function(e){return function(){var t=Error("Method "+e+" is not implemented by the current driver"),i=o.reject(t);return a(i,arguments[arguments.length-1]),i}},i=0,r=eo.length;i<r;i++){var s=eo[i];e[s]||(e[s]=t(s))}}();var u=function(i){ei[r]&&console.info("Redefining LocalForage driver: "+r),ei[r]=e,er[r]=i,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(u,i):u(!!e._support):u(!0)}catch(e){i(e)}});return l(r,t,i),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,i){var r=ei[e]?o.resolve(ei[e]):o.reject(Error("Driver not found."));return l(r,t,i),r},e.prototype.getSerializer=function(e){var t=o.resolve(G);return l(t,e),t},e.prototype.ready=function(e){var t=this,i=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return l(i,e,e),i},e.prototype.setDriver=function(e,t,i){var r=this;et(e)||(e=[e]);var s=this._getSupportedDrivers(e);function n(){r._config.driver=r.driver()}function a(e){return r._extend(e),n(),r._ready=r._initStorage(r._config),r._ready}var h=null!==this._driverSet?this._driverSet.catch(function(){return o.resolve()}):o.resolve();return this._driverSet=h.then(function(){var e=s[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then(function(e){r._driver=e._driver,n(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(){var e=0;return function t(){for(;e<s.length;){var i=s[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(a).catch(t)}n();var l=Error("No available storage method found.");return r._driverSet=o.reject(l),r._driverSet}()}})}).catch(function(){n();var e=Error("No available storage method found.");return r._driverSet=o.reject(e),r._driverSet}),l(this._driverSet,t,i),this._driverSet},e.prototype.supports=function(e){return!!er[e]},e.prototype._extend=function(e){eh(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],i=0,r=e.length;i<r;i++){var s=e[i];this.supports(s)&&t.push(s)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ea.length;e<t;e++)!function(e,t){e[t]=function(){var i=arguments;return e.ready().then(function(){return e[t].apply(e,i)})}}(this,ea[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ec},{3:3}]},{},[4])(4)},e.exports=r()},2522:(e,t,i)=>{var r=i(8294).Symbol;e.exports=r},6351:(e,t,i)=>{var r=i(2522),s=i(828),n=i(6129),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?s(e):n(e)}},2627:(e,t,i)=>{var r=i(9591),s=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(s,""):e}},4131:(e,t,i)=>{var r="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;e.exports=r},828:(e,t,i)=>{var r=i(2522),s=Object.prototype,n=s.hasOwnProperty,o=s.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=n.call(e,a),i=e[a];try{e[a]=void 0;var r=!0}catch(e){}var s=o.call(e);return r&&(t?e[a]=i:delete e[a]),s}},6129:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},8294:(e,t,i)=>{var r=i(4131),s="object"==typeof self&&self&&self.Object===Object&&self,n=r||s||Function("return this")();e.exports=n},9591:e=>{var t=/\s/;e.exports=function(e){for(var i=e.length;i--&&t.test(e.charAt(i)););return i}},7610:(e,t,i)=>{var r=i(5910),s=i(8211),n=i(6453),o=Math.max,a=Math.min;e.exports=function(e,t,i){var l,h,c,u,d,f,p=0,g=!1,m=!1,v=!0;if("function"!=typeof e)throw TypeError("Expected a function");function y(t){var i=l,r=h;return l=h=void 0,p=t,u=e.apply(r,i)}function b(e){var i=e-f,r=e-p;return void 0===f||i>=t||i<0||m&&r>=c}function w(){var e,i,r,n=s();if(b(n))return _(n);d=setTimeout(w,(e=n-f,i=n-p,r=t-e,m?a(r,c-i):r))}function _(e){return(d=void 0,v&&l)?y(e):(l=h=void 0,u)}function E(){var e,i=s(),r=b(i);if(l=arguments,h=this,f=i,r){if(void 0===d)return p=e=f,d=setTimeout(w,t),g?y(e):u;if(m)return clearTimeout(d),d=setTimeout(w,t),y(f)}return void 0===d&&(d=setTimeout(w,t)),u}return t=n(t)||0,r(i)&&(g=!!i.leading,c=(m="maxWait"in i)?o(n(i.maxWait)||0,t):c,v="trailing"in i?!!i.trailing:v),E.cancel=function(){void 0!==d&&clearTimeout(d),p=0,l=f=h=d=void 0},E.flush=function(){return void 0===d?u:_(s())},E}},5910:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3342:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},681:(e,t,i)=>{var r=i(6351),s=i(3342);e.exports=function(e){return"symbol"==typeof e||s(e)&&"[object Symbol]"==r(e)}},8211:(e,t,i)=>{var r=i(8294);e.exports=function(){return r.Date.now()}},629:(e,t,i)=>{var r=i(7610),s=i(5910);e.exports=function(e,t,i){var n=!0,o=!0;if("function"!=typeof e)throw TypeError("Expected a function");return s(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),r(e,t,{leading:n,maxWait:t,trailing:o})}},6453:(e,t,i)=>{var r=i(2627),s=i(5910),n=i(681),o=0/0,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(n(e))return o;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var i=l.test(e);return i||h.test(e)?c(e.slice(2),i?2:8):a.test(e)?o:+e}},5850:(e,t)=>{"use strict";function i(e,t){if("iframe"===e.nodeName||"IFRAME"===e.nodeName)try{this.target=e.contentDocument}catch(t){this.target=e}else this.target=e;for(var i=["mouseup","mousedown","click","touchstart"],s=0;s<i.length;s++){var n=i[s];this.target.addEventListener(n,function(i){return function(i){for(var s=t.length-1;s>=0;s--){var n=t[s],o=i.clientX,a=i.clientY;if(i.touches&&i.touches.length&&(o=i.touches[0].clientX,a=i.touches[0].clientY),function(e,t,i,r){var s=t.getBoundingClientRect();function n(e,t,i){var r=e.top-s.top,n=e.left-s.left,o=r+e.height,a=n+e.width;return r<=i&&n<=t&&o>i&&a>t}if(!n(e.getBoundingClientRect(),i,r))return!1;for(var o=e.getClientRects(),a=0,l=o.length;a<l;a++)if(n(o[a],i,r))return!0;return!1}(n,e,o,a)){n.dispatchEvent(r(i));break}}}(i)},!1)}}function r(e){var t=Object.assign({},e,{bubbles:!1});try{return new MouseEvent(e.type,t)}catch(r){var i=document.createEvent("MouseEvents");return i.initMouseEvent(e.type,!1,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),i}}Object.defineProperty(t,"__esModule",{value:!0}),t.proxyMouse=i,t.clone=r,t.default={proxyMouse:i}},6659:(e,t,i)=>{"use strict";t.z2=t.f4=t.Zv=void 0;var r=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var n=Object.getPrototypeOf(t);if(null===n)return;return e(n,i,r)}if("value"in s)return s.value;var o=s.get;if(void 0!==o)return o.call(r)},s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=a(i(5435)),o=a(i(5850));function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}function h(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}t.Zv=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;c(this,e),this.target=t,this.element=n.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),o.default.proxyMouse(this.target,this.marks),this.container=i,this.container.appendChild(this.element),this.render()}return s(e,[{key:"addMark",value:function(e){var t=n.default.createElement("g");return this.element.appendChild(t),e.bind(t,this.container),this.marks.push(e),e.render(),e}},{key:"removeMark",value:function(e){var t=this.marks.indexOf(e);if(-1!==t){var i=e.unbind();this.element.removeChild(i),this.marks.splice(t,1)}}},{key:"render",value:function(){o=this.element,r=this.target,s=this.container.getBoundingClientRect(),a={top:(n=r.getBoundingClientRect()).top-s.top,left:n.left-s.left,height:r.scrollHeight,width:r.scrollWidth},o.style.setProperty("top",a.top+"px","important"),o.style.setProperty("left",a.left+"px","important"),o.style.setProperty("height",a.height+"px","important"),o.style.setProperty("width",a.width+"px","important");var e=!0,t=!1,i=void 0;try{for(var r,s,n,o,a,l,h=this.marks[Symbol.iterator]();!(e=(l=h.next()).done);e=!0)l.value.render()}catch(e){t=!0,i=e}finally{try{!e&&h.return&&h.return()}finally{if(t)throw i}}}}]),e}();var u=function(){function e(){c(this,e),this.element=null}return s(e,[{key:"bind",value:function(e,t){this.element=e,this.container=t}},{key:"unbind",value:function(){var e=this.element;return this.element=null,e}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(e){this.element&&this.element.dispatchEvent(e)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var e=[],t=this.element.firstChild;t;)e.push(t.getBoundingClientRect()),t=t.nextSibling;return e}},{key:"filteredRanges",value:function(){var e=Array.from(this.range.getClientRects());return e.filter(function(t){for(var i,r=0;r<e.length&&e[r]!==t;r++)if(i=e[r],t.right<=i.right&&t.left>=i.left&&t.top>=i.top&&t.bottom<=i.bottom)return!1;return!0})}}]),e}(),d=t.f4=function(e){function t(e,i,r,s){c(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.range=e,n.className=i,n.data=r||{},n.attributes=s||{},n}return h(t,e),s(t,[{key:"bind",value:function(e,i){for(var s in r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bind",this).call(this,e,i),this.data)this.data.hasOwnProperty(s)&&(this.element.dataset[s]=this.data[s]);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&this.element.setAttribute(s,this.attributes[s]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var e=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),i=this.element.getBoundingClientRect(),r=this.container.getBoundingClientRect(),s=0,o=t.length;s<o;s++){var a=t[s],l=n.default.createElement("rect");l.setAttribute("x",a.left-i.left+r.left),l.setAttribute("y",a.top-i.top+r.top),l.setAttribute("height",a.height),l.setAttribute("width",a.width),e.appendChild(l)}this.element.appendChild(e)}}]),t}(u);t.z2=function(e){function t(e,i,r,s){return c(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,r,s))}return h(t,e),s(t,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var e=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),i=this.element.getBoundingClientRect(),r=this.container.getBoundingClientRect(),s=0,o=t.length;s<o;s++){var a=t[s],l=n.default.createElement("rect");l.setAttribute("x",a.left-i.left+r.left),l.setAttribute("y",a.top-i.top+r.top),l.setAttribute("height",a.height),l.setAttribute("width",a.width),l.setAttribute("fill","none");var h=n.default.createElement("line");h.setAttribute("x1",a.left-i.left+r.left),h.setAttribute("x2",a.left-i.left+r.left+a.width),h.setAttribute("y1",a.top-i.top+r.top+a.height-1),h.setAttribute("y2",a.top-i.top+r.top+a.height-1),h.setAttribute("stroke-width",1),h.setAttribute("stroke","black"),h.setAttribute("stroke-linecap","square"),e.appendChild(l),e.appendChild(h)}this.element.appendChild(e)}}]),t}(d)},5435:(e,t)=>{"use strict";function i(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=i,t.default={createElement:i}},8462:e=>{"use strict";if(!t)var t={cwd:function(){return"/"}};function i(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+e)}function r(e,t){for(var i,r="",s=-1,n=0,o=0;o<=e.length;++o){if(o<e.length)i=e.charCodeAt(o);else if(47===i)break;else i=47;if(47===i){if(s===o-1||1===n);else if(s!==o-1&&2===n){if(r.length<2||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2)){if(r.length>2){for(var a=r.length-1,l=a;l>=0&&47!==r.charCodeAt(l);--l);if(l!==a){r=-1===l?"":r.slice(0,l),s=o,n=0;continue}}else if(2===r.length||1===r.length){r="",s=o,n=0;continue}}t&&(r.length>0?r+="/..":r="..")}else r.length>0?r+="/"+e.slice(s+1,o):r=e.slice(s+1,o);s=o,n=0}else 46===i&&-1!==n?++n:n=-1}return r}var s={resolve:function(){for(var e,s,n="",o=!1,a=arguments.length-1;a>=-1&&!o;a--)a>=0?s=arguments[a]:(void 0===e&&(e=t.cwd()),s=e),i(s),0!==s.length&&(n=s+"/"+n,o=47===s.charCodeAt(0));return(n=r(n,!o),o)?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(e){if(i(e),0===e.length)return".";var t=47===e.charCodeAt(0),s=47===e.charCodeAt(e.length-1);return(0!==(e=r(e,!t)).length||t||(e="."),e.length>0&&s&&(e+="/"),t)?"/"+e:e},isAbsolute:function(e){return i(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0==arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];i(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":s.normalize(e)},relative:function(e,t){if(i(e),i(t),e===t||(e=s.resolve(e))===(t=s.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var n=e.length,o=n-r,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var l=t.length-a,h=o<l?o:l,c=-1,u=0;u<=h;++u){if(u===h){if(l>h){if(47===t.charCodeAt(a+u))return t.slice(a+u+1);if(0===u)return t.slice(a+u)}else o>h&&(47===e.charCodeAt(r+u)?c=u:0===u&&(c=0));break}var d=e.charCodeAt(r+u);if(d!==t.charCodeAt(a+u))break;47===d&&(c=u)}var f="";for(u=r+c+1;u<=n;++u)(u===n||47===e.charCodeAt(u))&&(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(a+c):(a+=c,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(i(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,s=-1,n=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!n){s=o;break}}else n=!1;return -1===s?r?"/":".":r&&1===s?"//":e.slice(0,s)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw TypeError('"ext" argument must be a string');i(e);var r,s=0,n=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(r=e.length-1;r>=0;--r){var h=e.charCodeAt(r);if(47===h){if(!o){s=r+1;break}}else -1===l&&(o=!1,l=r+1),a>=0&&(h===t.charCodeAt(a)?-1==--a&&(n=r):(a=-1,n=l))}return s===n?n=l:-1===n&&(n=e.length),e.slice(s,n)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){s=r+1;break}}else -1===n&&(o=!1,n=r+1);return -1===n?"":e.slice(s,n)},extname:function(e){i(e);for(var t=-1,r=0,s=-1,n=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(47===l){if(!n){r=a+1;break}continue}-1===s&&(n=!1,s=a+1),46===l?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1)}return -1===t||-1===s||0===o||1===o&&t===s-1&&t===r+1?"":e.slice(t,s)},format:function(e){var t,i;if(null===e||"object"!=typeof e)throw TypeError('Parameter "pathObject" must be an object, not '+typeof e);return t=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+i:t+"/"+i:i},parse:function(e){i(e);var t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var s=e.charCodeAt(0),n=47===s;n?(r.root="/",t=1):t=0;for(var o=-1,a=0,l=-1,h=!0,c=e.length-1,u=0;c>=t;--c){if(47===(s=e.charCodeAt(c))){if(!h){a=c+1;break}continue}-1===l&&(h=!1,l=c+1),46===s?-1===o?o=c:1!==u&&(u=1):-1!==o&&(u=-1)}return -1===o||-1===l||0===u||1===u&&o===l-1&&o===a+1?-1!==l&&(0===a&&n?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(a,l)):(0===a&&n?(r.name=e.slice(1,o),r.base=e.slice(1,l)):(r.name=e.slice(a,o),r.base=e.slice(a,l)),r.ext=e.slice(o,l)),a>0?r.dir=e.slice(0,a-1):n&&(r.dir="/"),r},sep:"/",delimiter:":",posix:null};e.exports=s},7111:(e,t,i)=>{"use strict";var r=i(3341);e.exports=function(e){if("function"!=typeof e||!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length||"function"!=typeof e.call||"function"!=typeof e.apply)return!1}catch(e){return!1}return!r(e)}},8865:(e,t,i)=>{"use strict";var r=i(136),s={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!r(e)&&hasOwnProperty.call(s,typeof e)}},9674:(e,t,i)=>{"use strict";var r=i(7111),s=/^\s*class[\s{/}]/,n=Function.prototype.toString;e.exports=function(e){return!(!r(e)||s.test(n.call(e)))}},3341:(e,t,i)=>{"use strict";var r=i(8865);e.exports=function(e){if(!r(e))return!1;try{if(!e.constructor)return!1;return e.constructor.prototype===e}catch(e){return!1}}},136:e=>{"use strict";var t=void 0;e.exports=function(e){return e!==t&&null!==e}},709:(e,t,i)=>{"use strict";i.d(t,{Zr:()=>s});let r=e=>t=>{try{let i=e(t);if(i instanceof Promise)return i;return{then:e=>r(e)(i),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>r(t)(e)}}},s=(e,t)=>(i,s,n)=>{let o,a={storage:function(e,t){let i;try{i=e()}catch(e){return}return{getItem:e=>{var t;let r=e=>null===e?null:JSON.parse(e,void 0),s=null!=(t=i.getItem(e))?t:null;return s instanceof Promise?s.then(r):r(s)},setItem:(e,t)=>i.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>i.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},l=!1,h=0,c=new Set,u=new Set,d=a.storage;if(!d)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),i(...e)},s,n);let f=()=>{let e=a.partialize({...s()});return d.setItem(a.name,{state:e,version:a.version})},p=n.setState;n.setState=(e,t)=>(p(e,t),f());let g=e((...e)=>(i(...e),f()),s,n);n.getInitialState=()=>g;let m=()=>{var e,t;if(!d)return;let n=++h;l=!1,c.forEach(e=>{var t;return e(null!=(t=s())?t:g)});let p=(null==(t=a.onRehydrateStorage)?void 0:t.call(a,null!=(e=s())?e:g))||void 0;return r(d.getItem.bind(d))(a.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===a.version)return[!1,e.state];if(a.migrate){let t=a.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;if(n!==h)return;let[r,l]=e;if(i(o=a.merge(l,null!=(t=s())?t:g),!0),r)return f()}).then(()=>{n===h&&(null==p||p(o,void 0),o=s(),l=!0,u.forEach(e=>e(o)))}).catch(e=>{n===h&&(null==p||p(void 0,e))})};return n.persist={setOptions:e=>{a={...a,...e},e.storage&&(d=e.storage)},clearStorage:()=>{null==d||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>m(),hasHydrated:()=>l,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(u.add(e),()=>{u.delete(e)})},a.skipHydration||m(),o||g}},9827:(e,t,i)=>{"use strict";i.d(t,{v:()=>l});var r=i(2115);let s=e=>{let t;let i=new Set,r=(e,r)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=r?r:"object"!=typeof s||null===s)?s:Object.assign({},t,s),i.forEach(i=>i(t,e))}},s=()=>t,n={setState:r,getState:s,getInitialState:()=>o,subscribe:e=>(i.add(e),()=>i.delete(e))},o=t=e(r,s,n);return n},n=e=>e?s(e):s,o=e=>e,a=e=>{let t=n(e),i=e=>(function(e,t=o){let i=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(i),i})(t,e);return Object.assign(i,t),i},l=e=>e?a(e):a},5453:(e,t,i)=>{"use strict";let r;function s(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i}i.d(t,{UU:()=>im}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let n=e=>e?(...t)=>e(...t):(...e)=>fetch(...e);class o extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class a extends o{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class l extends o{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class h extends o{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(u||(u={}));class c{constructor(e,{headers:t={},customFetch:i,region:r=u.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=n(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){var t,i,r,s;return t=this,i=arguments,r=void 0,s=function*(e,t={}){var i;let r,s;try{let n;let{headers:o,method:c,body:u,signal:d,timeout:f}=t,p={},{region:g}=t;g||(g=this.region);let m=new URL(`${this.url}/${e}`);g&&"any"!==g&&(p["x-region"]=g,m.searchParams.set("forceFunctionRegion",g)),u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?"undefined"!=typeof Blob&&u instanceof Blob||u instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",n=u):"string"==typeof u?(p["Content-Type"]="text/plain",n=u):"undefined"!=typeof FormData&&u instanceof FormData?n=u:(p["Content-Type"]="application/json",n=JSON.stringify(u)):!u||"string"==typeof u||"undefined"!=typeof Blob&&u instanceof Blob||u instanceof ArrayBuffer||"undefined"!=typeof FormData&&u instanceof FormData?n=u:n=JSON.stringify(u);let v=d;f&&(s=new AbortController,r=setTimeout(()=>s.abort(),f),d?(v=s.signal,d.addEventListener("abort",()=>s.abort())):v=s.signal);let y=yield this.fetch(m.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),o),body:n,signal:v}).catch(e=>{throw new a(e)}),b=y.headers.get("x-relay-error");if(b&&"true"===b)throw new l(y);if(!y.ok)throw new h(y);let w=(null!==(i=y.headers.get("Content-Type"))&&void 0!==i?i:"text/plain").split(";")[0].trim();return{data:"application/json"===w?yield y.json():"application/octet-stream"===w||"application/pdf"===w?yield y.blob():"text/event-stream"===w?y:"multipart/form-data"===w?yield y.formData():yield y.text(),error:null,response:y}}catch(e){return{data:null,error:e,response:e instanceof h||e instanceof l?e.context:void 0}}finally{r&&clearTimeout(r)}},new(r||(r=Promise))(function(e,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function a(e){try{l(s.throw(e))}catch(e){n(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof r?i:new r(function(e){e(i)})).then(o,a)}l((s=s.apply(t,i||[])).next())})}}var u,d,f,p,g,m,v,y,b,w,_,E=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},S=class{constructor(e){var t,i;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(i=e.isMaybeSingle)&&void 0!==i&&i,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var i=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,s,n;let o=null,a=null,l=null,h=e.status,c=e.statusText;if(e.ok){if("HEAD"!==i.method){let t=await e.text();""===t||(a="text/csv"===i.headers.get("Accept")?t:i.headers.get("Accept")&&(null===(s=i.headers.get("Accept"))||void 0===s?void 0:s.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}let n=null===(t=i.headers.get("Prefer"))||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),u=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&u&&u.length>1&&(l=parseInt(u[1])),i.isMaybeSingle&&"GET"===i.method&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,h=406,c="Not Acceptable"):a=1===a.length?a[0]:null)}else{let t=await e.text();try{o=JSON.parse(t),Array.isArray(o)&&404===e.status&&(a=[],o=null,h=200,c="OK")}catch(i){404===e.status&&""===t?(h=204,c="No Content"):o={message:t}}if(o&&i.isMaybeSingle&&(null==o||null===(n=o.details)||void 0===n?void 0:n.includes("0 rows"))&&(o=null,h=200,c="OK"),o&&i.shouldThrowOnError)throw new E(o)}return{error:o,data:a,count:l,status:h,statusText:c}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,i,r,s,n,o;let a="",l=null==e?void 0:e.cause;if(l){let t=null!==(i=null==l?void 0:l.message)&&void 0!==i?i:"",o=null!==(r=null==l?void 0:l.code)&&void 0!==r?r:"";a=`${null!==(s=null==e?void 0:e.name)&&void 0!==s?s:"FetchError"}: ${null==e?void 0:e.message}

Caused by: ${null!==(n=null==l?void 0:l.name)&&void 0!==n?n:"Error"}: ${t}`,o&&(a+=` (${o})`),(null==l?void 0:l.stack)&&(a+=`
${l.stack}`)}else a=null!==(o=null==e?void 0:e.stack)&&void 0!==o?o:"";return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}},T=class extends S{select(e){let t=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:i,foreignTable:r,referencedTable:s=r}={}){let n=s?`${s}.order`:"order",o=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===i?"":i?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:i=t}={}){let r=void 0===i?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:i,referencedTable:r=i}={}){let s=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(n,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:i=!1,buffers:r=!1,wal:s=!1,format:n="text"}={}){var o;let a=[e?"analyze":null,t?"verbose":null,i?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${l}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};let k=RegExp("[,()]");var x=class extends T{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){let i=Array.from(new Set(t)).map(e=>"string"==typeof e&&k.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${i})`),this}notIn(e,t){let i=Array.from(new Set(t)).map(e=>"string"==typeof e&&k.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${i})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:i,type:r}={}){let s="";"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w");let n=void 0===i?"":`(${i})`;return this.url.searchParams.append(e,`${s}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,i){return this.url.searchParams.append(e,`not.${t}.${i}`),this}or(e,{foreignTable:t,referencedTable:i=t}={}){let r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,i){return this.url.searchParams.append(e,`${t}.${i}`),this}},C=class{constructor(e,{headers:t={},schema:i,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=i,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){let{head:i=!1,count:r}=null!=t?t:{},s=!1,n=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join(""),{url:o,headers:a}=this.cloneRequestState();return o.searchParams.set("select",n),r&&a.append("Prefer",`count=${r}`),new x({method:i?"HEAD":"GET",url:o,headers:a,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:i=!0}={}){var r;let{url:s,headers:n}=this.cloneRequestState();if(t&&n.append("Prefer",`count=${t}`),i||n.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);s.searchParams.set("columns",e.join(","))}}return new x({method:"POST",url:s,headers:n,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:i=!1,count:r,defaultToNull:s=!0}={}){var n;let{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),void 0!==t&&o.searchParams.set("on_conflict",t),r&&a.append("Prefer",`count=${r}`),s||a.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);o.searchParams.set("columns",e.join(","))}}return new x({method:"POST",url:o,headers:a,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}update(e,{count:t}={}){var i;let{url:r,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new x({method:"PATCH",url:r,headers:s,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}delete({count:e}={}){var t;let{url:i,headers:r}=this.cloneRequestState();return e&&r.append("Prefer",`count=${e}`),new x({method:"DELETE",url:i,headers:r,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},A=class e{constructor(e,{headers:t={},schema:i,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.fetch=r}from(e){if(!e||"string"!=typeof e||""===e.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new C(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:r=!1,count:s}={}){var n;let o,a;let l=new URL(`${this.url}/rpc/${e}`),h=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(h)),c=i&&Object.values(t).some(h);c?(o="POST",a=t):i||r?(o=i?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(o="POST",a=t);let u=new Headers(this.headers);return c?u.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&u.set("Prefer",`count=${s}`),new x({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}};class R{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==i.g&&void 0!==i.g.WebSocket)return{type:"native",constructor:i.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};let t=globalThis.process;if(t){let e=t.versions;if(e&&e.node){let t=parseInt(e.node.replace(/^v/,"").split(".")[0]);return t>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}let D="2.0.0";!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(d||(d={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(f||(f={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(p||(p={})),(g||(g={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(m||(m={}));class O{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){return e.event!==this.BROADCAST_EVENT||e.payload instanceof ArrayBuffer||"string"!=typeof e.payload.event?t(JSON.stringify([e.join_ref,e.ref,e.topic,e.event,e.payload])):t(this._binaryEncodeUserBroadcastPush(e))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;let r=null!==(i=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==i?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var t,i;let r=null!==(i=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==i?i:{},s=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(e,t,i){let r=e.topic,s=null!==(f=e.ref)&&void 0!==f?f:"",n=null!==(p=e.join_ref)&&void 0!==p?p:"",o=e.payload.event,a=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},l=0===Object.keys(a).length?"":JSON.stringify(a);if(n.length>255)throw Error(`joinRef length ${n.length} exceeds maximum of 255`);if(s.length>255)throw Error(`ref length ${s.length} exceeds maximum of 255`);if(r.length>255)throw Error(`topic length ${r.length} exceeds maximum of 255`);if(o.length>255)throw Error(`userEvent length ${o.length} exceeds maximum of 255`);if(l.length>255)throw Error(`metadata length ${l.length} exceeds maximum of 255`);let h=this.USER_BROADCAST_PUSH_META_LENGTH+n.length+s.length+r.length+o.length+l.length,c=new ArrayBuffer(this.HEADER_LENGTH+h),u=new DataView(c),d=0;u.setUint8(d++,this.KINDS.userBroadcastPush),u.setUint8(d++,n.length),u.setUint8(d++,s.length),u.setUint8(d++,r.length),u.setUint8(d++,o.length),u.setUint8(d++,l.length),u.setUint8(d++,t),Array.from(n,e=>u.setUint8(d++,e.charCodeAt(0))),Array.from(s,e=>u.setUint8(d++,e.charCodeAt(0))),Array.from(r,e=>u.setUint8(d++,e.charCodeAt(0))),Array.from(o,e=>u.setUint8(d++,e.charCodeAt(0))),Array.from(l,e=>u.setUint8(d++,e.charCodeAt(0)));var f,p,g=new Uint8Array(c.byteLength+i.byteLength);return g.set(new Uint8Array(c),0),g.set(new Uint8Array(i),c.byteLength),g.buffer}decode(e,t){if(this._isArrayBuffer(e))return t(this._binaryDecode(e));if("string"==typeof e){let[i,r,s,n,o]=JSON.parse(e);return t({join_ref:i,ref:r,topic:s,event:n,payload:o})}return t({})}_binaryDecode(e){let t=new DataView(e),i=t.getUint8(0),r=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,r)}_decodeUserBroadcast(e,t,i){let r=t.getUint8(1),s=t.getUint8(2),n=t.getUint8(3),o=t.getUint8(4),a=this.HEADER_LENGTH+4,l=i.decode(e.slice(a,a+r));a+=r;let h=i.decode(e.slice(a,a+s));a+=s;let c=i.decode(e.slice(a,a+n));a+=n;let u=e.slice(a,e.byteLength),d=o===this.JSON_ENCODING?JSON.parse(i.decode(u)):u,f={type:this.BROADCAST_EVENT,event:h,payload:d};return n>0&&(f.meta=JSON.parse(c)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class N{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(v||(v={}));let I=(e,t,i={})=>{var r;let s=null!==(r=i.skipTypes)&&void 0!==r?r:[];return t?Object.keys(t).reduce((i,r)=>(i[r]=L(r,e,t,s),i),{}):{}},L=(e,t,i,r)=>{let s=t.find(t=>t.name===e),n=null==s?void 0:s.type,o=i[e];return n&&!r.includes(n)?P(n,o):j(o)},P=(e,t)=>{if("_"===e.charAt(0))return $(t,e.slice(1,e.length));switch(e){case v.bool:return U(t);case v.float4:case v.float8:case v.int2:case v.int4:case v.int8:case v.numeric:case v.oid:return q(t);case v.json:case v.jsonb:return B(t);case v.timestamp:return M(t);case v.abstime:case v.date:case v.daterange:case v.int4range:case v.int8range:case v.money:case v.reltime:case v.text:case v.time:case v.timestamptz:case v.timetz:case v.tsrange:case v.tstzrange:default:return j(t)}},j=e=>e,U=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},q=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},B=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},$=(e,t)=>{if("string"!=typeof e)return e;let i=e.length-1,r=e[i];if("{"===e[0]&&"}"===r){let r;let s=e.slice(1,i);try{r=JSON.parse("["+s+"]")}catch(e){r=s?s.split(","):[]}return r.map(e=>P(t,e))}return e},M=e=>"string"==typeof e?e.replace(" ","T"):e,z=e=>{let t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class F{constructor(e,t,i={},r=1e4){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t(null===(i=this.receivedResp)||void 0===i?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(y||(y={}));class W{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let i=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},e=>{let{onJoin:t,onLeave:i,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=W.syncState(this.state,e,t,i),this.pendingDiffs.forEach(e=>{this.state=W.syncDiff(this.state,e,t,i)}),this.pendingDiffs=[],r()}),this.channel._on(i.diff,{},e=>{let{onJoin:t,onLeave:i,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=W.syncDiff(this.state,e,t,i),r())}),this.onJoin((e,t,i)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:i})}),this.onLeave((e,t,i)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){let s=this.cloneDeep(e),n=this.transformState(t),o={},a={};return this.map(s,(e,t)=>{n[e]||(a[e]=t)}),this.map(n,(e,t)=>{let i=s[e];if(i){let r=t.map(e=>e.presence_ref),s=i.map(e=>e.presence_ref),n=t.filter(e=>0>s.indexOf(e.presence_ref)),l=i.filter(e=>0>r.indexOf(e.presence_ref));n.length>0&&(o[e]=n),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(s,{joins:o,leaves:a},i,r)}static syncDiff(e,t,i,r){let{joins:s,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(t,r)=>{var s;let n=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(r),n.length>0){let i=e[t].map(e=>e.presence_ref),r=n.filter(e=>0>i.indexOf(e.presence_ref));e[t].unshift(...r)}i(t,n,r)}),this.map(n,(t,i)=>{let s=e[t];if(!s)return;let n=i.map(e=>e.presence_ref);s=s.filter(e=>0>n.indexOf(e.presence_ref)),e[t]=s,r(t,s,i),0===s.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,i)=>{let r=e[i];return"metas"in r?t[i]=r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(b||(b={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(w||(w={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(_||(_={}));class V{constructor(e,t={config:{}},i){var r,s;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=f.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new F(this,p.join,this.params,this.timeout),this.rejoinTimer=new N(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=f.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=f.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=f.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=f.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=f.errored,this.rejoinTimer.scheduleTimeout())}),this._on(p.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new W(this),this.broadcastEndpointURL=z(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(s=null===(r=this.params.config)||void 0===r?void 0:r.broadcast)||void 0===s?void 0:s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==f.closed){let{config:{broadcast:n,presence:o,private:a}}=this.params,l=null!==(r=null===(i=this.bindings.postgres_changes)||void 0===i?void 0:i.map(e=>e.filter))&&void 0!==r?r:[],h=!!this.bindings[w.PRESENCE]&&this.bindings[w.PRESENCE].length>0||(null===(s=this.params.config.presence)||void 0===s?void 0:s.enabled)===!0,c={},u={broadcast:n,presence:Object.assign(Object.assign({},o),{enabled:h}),postgres_changes:l,private:a};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(_.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(_.CLOSED)),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var i;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===t){null==e||e(_.SUBSCRIBED);return}{let r=this.bindings.postgres_changes,s=null!==(i=null==r?void 0:r.length)&&void 0!==i?i:0,n=[];for(let i=0;i<s;i++){let s=r[i],{filter:{event:o,schema:a,table:l,filter:h}}=s,c=t&&t[i];if(c&&c.event===o&&V.isFilterValueEqual(c.schema,a)&&V.isFilterValueEqual(c.table,l)&&V.isFilterValueEqual(c.filter,h))n.push(Object.assign(Object.assign({},s),{id:c.id}));else{this.unsubscribe(),this.state=f.errored,null==e||e(_.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=n,e&&e(_.SUBSCRIBED);return}}).receive("error",t=>{this.state=f.errored,null==e||e(_.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(_.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===f.joined&&e===w.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var r;if(null==t)return Promise.reject("Payload is required for httpSend()");let s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);let n={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,n,null!==(r=i.timeout)&&void 0!==r?r:this.timeout);if(202===o.status)return{success:!0};let a=o.statusText;try{let e=await o.json();a=e.error||e.message||a}catch(e){}return Promise.reject(Error(a))}async send(e,t={}){var i,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(i=>{var r,s,n;let o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(s=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===s?void 0:s.broadcast)||void 0===n?void 0:n.ack)||i("ok"),o.receive("ok",()=>i("ok")),o.receive("error",()=>i("error")),o.receive("timeout",()=>i("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:s,payload:n}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);let a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(i=t.timeout)&&void 0!==i?i:this.timeout);return await (null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=f.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(p.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{(i=new F(this,p.leave,{},e)).receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{null==i||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=f.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){let r=new AbortController,s=setTimeout(()=>r.abort(),i),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(s),n}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new F(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,s;let n=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:h}=p;if(i&&[o,a,l,h].indexOf(n)>=0&&i!==this._joinRef())return;let c=this._onMessage(n,t,i);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,i,r;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(r=null===(i=e.filter)||void 0===i?void 0:i.event)||void 0===r?void 0:r.toLocaleLowerCase())===n}).map(e=>e.callback(c,i)):null===(s=this.bindings[n])||void 0===s||s.filter(e=>{var i,r,s,o,a,l;if(!["broadcast","presence","postgres_changes"].includes(n))return e.type.toLocaleLowerCase()===n;if("id"in e){let n=e.id,o=null===(i=e.filter)||void 0===i?void 0:i.event;return n&&(null===(r=t.ids)||void 0===r?void 0:r.includes(n))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{let i=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===i||i===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:i,commit_timestamp:r,type:s,errors:n}=e;c=Object.assign(Object.assign({},{schema:t,table:i,commit_timestamp:r,eventType:s,new:{},old:{},errors:n}),this._getPayloadRecords(e))}e.callback(c,i)})}_isClosed(){return this.state===f.closed}_isJoined(){return this.state===f.joined}_isJoining(){return this.state===f.joining}_isLeaving(){return this.state===f.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){let r=e.toLocaleLowerCase(),s={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,t){let i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===i&&V.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(p.close,{},e)}_onError(e){this._on(p.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=f.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=I(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=I(e.columns,e.old_record)),t}}let H=()=>{},G={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},K=[1e3,2e3,5e3,1e4],J=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class X{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=G.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=H,this.ref=0,this.reconnectTimer=null,this.vsn=D,this.logger=H,this.conn=null,this.sendBuffer=[],this.serializer=new O,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(i=null==t?void 0:t.params)||void 0===i?void 0:i.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${g.websocket}`,this.httpEndpoint=z(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=R.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting()){if(this._setConnectionState("disconnecting",!0),this.conn){let i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case d.connecting:return m.Connecting;case d.open:return m.Open;case d.closing:return m.Closing;default:return m.Closed}}isConnected(){return this.connectionState()===m.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let i=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===i);if(r)return r;{let i=new V(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){let{topic:t,event:i,payload:r,ref:s}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${i} (${s})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},G.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){let t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(e){this.log("error","error in heartbeat callback",e)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}let{topic:t,event:i,payload:r,ref:s}=e,n=s?`(${s})`:"",o=r.status||"";this.log("receive",`${o} ${t} ${i} ${n}`.trim(),r),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(i,r,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===d.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===d.open||this.conn.readyState===d.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(e){this.log("error","error in heartbeat callback",e)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(p.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([J],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;let i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(e){this.log("error","Error fetching access token from callback",e),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{let i={access_token:t,version:"realtime-js/2.93.3"};t&&e.updateJoinPayload(i),e.joinedOnce&&e._isJoined()&&e._push(p.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new N(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},G.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,s,n,o,a,l,h,c,u,d;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(i=null==e?void 0:e.timeout)&&void 0!==i?i:1e4,this.heartbeatIntervalMs=null!==(r=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==r?r:G.HEARTBEAT_INTERVAL,this.worker=null!==(s=null==e?void 0:e.worker)&&void 0!==s&&s,this.accessToken=null!==(n=null==e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(o=null==e?void 0:e.heartbeatCallback)&&void 0!==o?o:H,this.vsn=null!==(a=null==e?void 0:e.vsn)&&void 0!==a?a:D,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null==e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>K[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(h=null==e?void 0:e.encode)&&void 0!==h?h:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:(e,t)=>t(JSON.parse(e));break;case D:this.encode=null!==(u=null==e?void 0:e.encode)&&void 0!==u?u:this.serializer.encode.bind(this.serializer),this.decode=null!==(d=null==e?void 0:e.decode)&&void 0!==d?d:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var Y=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function Z(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}function Q(e){return e.join("\x1f")}var ee=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:Q(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){let i={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:i})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Q(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Q(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Q(e.namespace)}`}),!0}catch(e){if(e instanceof Y&&404===e.status)return!1;throw e}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(e){if(e instanceof Y&&409===e.status)return;throw e}}};function et(e){return e.join("\x1f")}var ei=class{constructor(e,t="",i){this.client=e,this.prefix=t,this.accessDelegation=i}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){let i={};return this.accessDelegation&&(i["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables`,body:t,headers:i})).data.metadata}async updateTable(e,t){let i=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":i.data["metadata-location"],metadata:i.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(e){if(e instanceof Y&&404===e.status)return!1;throw e}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(i){if(i instanceof Y&&409===i.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw i}}},er=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);let i=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=function(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:i,path:r,query:s,body:n,headers:o}){let a=function(e,t,i){let r=new URL(t,e);if(i)for(let[e,t]of Object.entries(i))void 0!==t&&r.searchParams.set(e,t);return r.toString()}(e.baseUrl,r,s),l=await Z(e.auth),h=await t(a,{method:i,headers:{...n?{"Content-Type":"application/json"}:{},...l,...o},body:n?JSON.stringify(n):void 0}),c=await h.text(),u=(h.headers.get("content-type")||"").includes("application/json"),d=u&&c?JSON.parse(c):c;if(!h.ok){let e=u?d:void 0,t=e?.error;throw new Y(t?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:h.status,headers:h.headers,data:d}}}}({baseUrl:i,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new ee(this.client,t),this.tableOps=new ei(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},es=i(3388).hp,en=class extends Error{constructor(e,t="storage",i,r){super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=i,this.statusCode=r}};function eo(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var ea=class extends en{constructor(e,t,i,r="storage"){super(e,r,t,i),this.name="vectors"===r?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},el=class extends en{constructor(e,t,i="storage"){super(e,i),this.name="vectors"===i?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};let eh=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),ec=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},eu=e=>{if(Array.isArray(e))return e.map(e=>eu(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,i])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=eu(i)}),t},ed=e=>!(!e||"string"!=typeof e||0===e.length||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function ef(e){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ep(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function eg(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ep(Object(i),!0).forEach(function(t){!function(e,t,i){var r;(r=function(e,t){if("object"!=ef(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ef(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==ef(r)?r:r+"")in e)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ep(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let em=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},ev=async(e,t,i,r)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==i?void 0:i.noResolveJson)){let i=e.status||500;"function"==typeof e.json?e.json().then(e=>{let s=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||i+"";t(new ea(em(e),i,s,r))}).catch(()=>{t(new ea(e.statusText||`HTTP ${i} error`,i,i+"",r))}):t(new ea(e.statusText||`HTTP ${i} error`,i,i+"",r))}else t(new el(em(e),e,r))},ey=(e,t,i,r)=>{let s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&r&&(ec(r)?(s.headers=eg({"Content-Type":"application/json"},null==t?void 0:t.headers),s.body=JSON.stringify(r)):s.body=r,(null==t?void 0:t.duplex)&&(s.duplex=t.duplex)),eg(eg({},s),i)};async function eb(e,t,i,r,s,n,o){return new Promise((a,l)=>{e(i,ey(t,r,s,n)).then(e=>{if(!e.ok)throw e;if(null==r?void 0:r.noResolveJson)return e;if("vectors"===o){let t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status||!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>a(e)).catch(e=>ev(e,l,r,o))})}function ew(e="storage"){return{get:async(t,i,r,s)=>eb(t,"GET",i,r,s,void 0,e),post:async(t,i,r,s,n)=>eb(t,"POST",i,s,n,r,e),put:async(t,i,r,s,n)=>eb(t,"PUT",i,s,n,r,e),head:async(t,i,r,s)=>eb(t,"HEAD",i,eg(eg({},r),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,i,r,s,n)=>eb(t,"DELETE",i,s,n,r,e)}}let{get:e_,post:eE,put:eS,head:eT,remove:ek}=ew("storage"),ex=ew("vectors");var eC=class{constructor(e,t={},i,r="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=eh(i),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eo(e))return{data:null,error:e};throw e}}},eA=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eo(e))return{data:null,error:e};throw e}}};r=Symbol.toStringTag;var eR=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[r]="BlobDownloadBuilder",this.promise=null}asStream(){return new eA(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eo(e))return{data:null,error:e};throw e}}};let eD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eO={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var eN=class extends eC{constructor(e,t={},i,r){super(e,t,r,"storage"),this.bucketId=i}async uploadOrUpdate(e,t,i,r){var s=this;return s.handleOperation(async()=>{let n;let o=eg(eg({},eO),r),a=eg(eg({},s.headers),"POST"===e&&{"x-upsert":String(o.upsert)}),l=o.metadata;"undefined"!=typeof Blob&&i instanceof Blob?((n=new FormData).append("cacheControl",o.cacheControl),l&&n.append("metadata",s.encodeMetadata(l)),n.append("",i)):"undefined"!=typeof FormData&&i instanceof FormData?((n=i).has("cacheControl")||n.append("cacheControl",o.cacheControl),l&&!n.has("metadata")&&n.append("metadata",s.encodeMetadata(l))):(n=i,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=s.toBase64(s.encodeMetadata(l))),("undefined"!=typeof ReadableStream&&n instanceof ReadableStream||n&&"object"==typeof n&&"pipe"in n&&"function"==typeof n.pipe)&&!o.duplex&&(o.duplex="half")),(null==r?void 0:r.headers)&&(a=eg(eg({},a),r.headers));let h=s._removeEmptyFolders(t),c=s._getFinalPath(h),u=await ("PUT"==e?eS:eE)(s.fetch,`${s.url}/object/${c}`,n,eg({headers:a},(null==o?void 0:o.duplex)?{duplex:o.duplex}:{}));return{path:h,id:u.Id,fullPath:u.Key}})}async upload(e,t,i){return this.uploadOrUpdate("POST",e,t,i)}async uploadToSignedUrl(e,t,i,r){var s=this;let n=s._removeEmptyFolders(e),o=s._getFinalPath(n),a=new URL(s.url+`/object/upload/sign/${o}`);return a.searchParams.set("token",t),s.handleOperation(async()=>{let e;let t=eg({upsert:eO.upsert},r),o=eg(eg({},s.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&i instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",i)):"undefined"!=typeof FormData&&i instanceof FormData?(e=i).append("cacheControl",t.cacheControl):(e=i,o["cache-control"]=`max-age=${t.cacheControl}`,o["content-type"]=t.contentType),{path:n,fullPath:(await eS(s.fetch,a.toString(),e,{headers:o})).Key}})}async createSignedUploadUrl(e,t){var i=this;return i.handleOperation(async()=>{let r=i._getFinalPath(e),s=eg({},i.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");let n=await eE(i.fetch,`${i.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(i.url+n.url),a=o.searchParams.get("token");if(!a)throw new en("No token returned by API");return{signedUrl:o.toString(),path:e,token:a}})}async update(e,t,i){return this.uploadOrUpdate("PUT",e,t,i)}async move(e,t,i){var r=this;return r.handleOperation(async()=>await eE(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==i?void 0:i.destinationBucket},{headers:r.headers}))}async copy(e,t,i){var r=this;return r.handleOperation(async()=>({path:(await eE(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==i?void 0:i.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(e,t,i){var r=this;return r.handleOperation(async()=>{let s=r._getFinalPath(e),n=await eE(r.fetch,`${r.url}/object/sign/${s}`,eg({expiresIn:t},(null==i?void 0:i.transform)?{transform:i.transform}:{}),{headers:r.headers}),o=(null==i?void 0:i.download)?`&download=${!0===i.download?"":i.download}`:"";return{signedUrl:encodeURI(`${r.url}${n.signedURL}${o}`)}})}async createSignedUrls(e,t,i){var r=this;return r.handleOperation(async()=>{let s=await eE(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:t,paths:e},{headers:r.headers}),n=(null==i?void 0:i.download)?`&download=${!0===i.download?"":i.download}`:"";return s.map(e=>eg(eg({},e),{},{signedUrl:e.signedURL?encodeURI(`${r.url}${e.signedURL}${n}`):null}))})}download(e,t){let i=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),s=r?`?${r}`:"",n=this._getFinalPath(e);return new eR(()=>e_(this.fetch,`${this.url}/${i}/${n}${s}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;let i=t._getFinalPath(e);return t.handleOperation(async()=>eu(await e_(t.fetch,`${t.url}/object/info/${i}`,{headers:t.headers})))}async exists(e){let t=this._getFinalPath(e);try{return await eT(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eo(e)&&e instanceof el){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}getPublicUrl(e,t){let i=this._getFinalPath(e),r=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&r.push(s);let n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&r.push(o);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${i}${a}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await ek(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,i){var r=this;return r.handleOperation(async()=>{let s=eg(eg(eg({},eD),t),{},{prefix:e||""});return await eE(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},i)})}async listV2(e,t){var i=this;return i.handleOperation(async()=>{let r=eg({},e);return await eE(i.fetch,`${i.url}/object/list-v2/${i.bucketId}`,r,{headers:i.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==es?es.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};let eI={"X-Client-Info":"storage-js/2.93.3"};var eL=class extends eC{constructor(e,t={},i,r){let s=new URL(e);(null==r?void 0:r.useNewHostname)&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),super(s.href.replace(/\/$/,""),eg(eg({},eI),t),i,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let i=t.listBucketOptionsToQueryString(e);return await e_(t.fetch,`${t.url}/bucket${i}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await e_(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var i=this;return i.handleOperation(async()=>await eE(i.fetch,`${i.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:i.headers}))}async updateBucket(e,t){var i=this;return i.handleOperation(async()=>await eS(i.fetch,`${i.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:i.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await eE(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ek(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){let t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},eP=class extends eC{constructor(e,t={},i){super(e.replace(/\/$/,""),eg(eg({},eI),t),i,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await eE(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let i=new URLSearchParams;(null==e?void 0:e.limit)!==void 0&&i.set("limit",e.limit.toString()),(null==e?void 0:e.offset)!==void 0&&i.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&i.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&i.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&i.set("search",e.search);let r=i.toString(),s=r?`${t.url}/bucket?${r}`:`${t.url}/bucket`;return await e_(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ek(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!ed(e))throw new en("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let i=new er({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(i,{get(e,t){let i=e[t];return"function"!=typeof i?i:async(...t)=>{try{return{data:await i.apply(e,t),error:null}}catch(e){if(r)throw e;return{data:null,error:e}}}}})}},ej=class extends eC{constructor(e,t={},i){super(e.replace(/\/$/,""),eg(eg({},eI),{},{"Content-Type":"application/json"},t),i,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var i=this;return i.handleOperation(async()=>await ex.post(i.fetch,`${i.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:i.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var i=this;return i.handleOperation(async()=>await ex.post(i.fetch,`${i.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:i.headers})||{})}},eU=class extends eC{constructor(e,t={},i){super(e.replace(/\/$/,""),eg(eg({},eI),{},{"Content-Type":"application/json"},t),i,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},eq=class extends eC{constructor(e,t={},i){super(e.replace(/\/$/,""),eg(eg({},eI),{},{"Content-Type":"application/json"},t),i,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ex.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},eB=class extends eq{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new e$(this.url,this.headers,e,this.fetch)}async createBucket(e){return super.createBucket.call(this,e)}async getBucket(e){return super.getBucket.call(this,e)}async listBuckets(e={}){return super.listBuckets.call(this,e)}async deleteBucket(e){return super.deleteBucket.call(this,e)}},e$=class extends ej{constructor(e,t,i,r){super(e,t,r),this.vectorBucketName=i}async createIndex(e){return super.createIndex.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return super.listIndexes.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return super.getIndex.call(this,this.vectorBucketName,e)}async deleteIndex(e){return super.deleteIndex.call(this,this.vectorBucketName,e)}index(e){return new eM(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},eM=class extends eU{constructor(e,t,i,r,s){super(e,t,s),this.vectorBucketName=i,this.indexName=r}async putVectors(e){return super.putVectors.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(e){return super.getVectors.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(e={}){return super.listVectors.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(e){return super.queryVectors.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(e){return super.deleteVectors.call(this,eg(eg({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},ez=class extends eL{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new eN(this.url,this.headers,e,this.fetch)}get vectors(){return new eB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new eP(this.url+"/iceberg",this.headers,this.fetch)}};let eF="2.93.3",eW={"X-Client-Info":`gotrue-js/${eF}`},eV="X-Supabase-Api-Version",eH={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eG=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class eK extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function eJ(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class eX extends eK{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}class eY extends eK{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eZ extends eK{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class eQ extends eZ{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function e0(e){return eJ(e)&&"AuthSessionMissingError"===e.name}class e1 extends eZ{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class e2 extends eZ{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class e3 extends eZ{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class e5 extends eZ{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class e8 extends eZ{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class e6 extends eZ{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function e4(e){return eJ(e)&&"AuthRetryableFetchError"===e.name}class e9 extends eZ{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class e7 extends eZ{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tt=" 	\n\r=".split(""),ti=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<tt.length;t+=1)e[tt[t].charCodeAt(0)]=-2;for(let t=0;t<te.length;t+=1)e[te[t].charCodeAt(0)]=t;return e})();function tr(e,t,i){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)i(te[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)i(te[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function ts(e,t,i){let r=ti[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)i(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===r)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function tn(e){let t=[],i=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},n=e=>{!function(e,t,i){if(0===t.utf8seq){if(e<=127){i(e);return}for(let i=1;i<6;i+=1)if((e>>7-i&1)==0){t.utf8seq=i;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&i(t.codepoint)}}(e,r,i)};for(let t=0;t<e.length;t+=1)ts(e.charCodeAt(t),s,n);return t.join("")}function to(e){let t=[],i={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)ts(e.charCodeAt(t),i,r);return new Uint8Array(t)}function ta(e){let t=[],i={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>tr(e,i,r)),tr(null,i,r),t.join("")}let tl=()=>"undefined"!=typeof window&&"undefined"!=typeof document,th={tested:!1,writable:!1},tc=()=>{if(!tl())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(th.tested)return th.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),th.tested=!0,th.writable=!0}catch(e){th.tested=!0,th.writable=!1}return th.writable},tu=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),td=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,tf=async(e,t,i)=>{await e.setItem(t,JSON.stringify(i))},tp=async(e,t)=>{let i=await e.getItem(t);if(!i)return null;try{return JSON.parse(i)}catch(e){return i}},tg=async(e,t)=>{await e.removeItem(t)};class tm{constructor(){this.promise=new tm.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function tv(e){let t=e.split(".");if(3!==t.length)throw new e7("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!eG.test(t[e]))throw new e7("JWT not in base64url format");return{header:JSON.parse(tn(t[0])),payload:JSON.parse(tn(t[1])),signature:to(t[2]),raw:{header:t[0],payload:t[1]}}}async function ty(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function tb(e){return("0"+e.toString(16)).substr(-2)}async function tw(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function t_(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await tw(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function tE(e,t,i=!1){let r=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,i="";for(let r=0;r<56;r++)i+=e.charAt(Math.floor(Math.random()*t));return i}return crypto.getRandomValues(e),Array.from(e,tb).join("")}(),s=r;i&&(s+="/PASSWORD_RECOVERY"),await tf(e,`${t}-code-verifier`,s);let n=await t_(r),o=r===n?"plain":"s256";return[n,o]}tm.promiseConstructor=Promise;let tS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,tT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tk(e){if(!tT.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tx(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tC(e){return JSON.parse(JSON.stringify(e))}let tA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tR=[502,503,504];async function tD(e){var t;let i,r;if(!td(e))throw new e6(tA(e),0);if(tR.includes(e.status))throw new e6(tA(e),e.status);try{i=await e.json()}catch(e){throw new eY(tA(e),e)}let s=function(e){let t=e.headers.get(eV);if(!t||!t.match(tS))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(s&&s.getTime()>=eH["2024-01-01"].timestamp&&"object"==typeof i&&i&&"string"==typeof i.code?r=i.code:"object"==typeof i&&i&&"string"==typeof i.error_code&&(r=i.error_code),r){if("weak_password"===r)throw new e9(tA(i),e.status,(null===(t=i.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new eQ}else if("object"==typeof i&&i&&"object"==typeof i.weak_password&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new e9(tA(i),e.status,i.weak_password.reasons);throw new eX(tA(i),e.status||500,r)}let tO=(e,t,i,r)=>{let s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),i))};async function tN(e,t,i,r){var s;let n=Object.assign({},null==r?void 0:r.headers);n[eV]||(n[eV]=eH["2024-01-01"].name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);let o=null!==(s=null==r?void 0:r.query)&&void 0!==s?s:{};(null==r?void 0:r.redirectTo)&&(o.redirect_to=r.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await tI(e,t,i+a,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function tI(e,t,i,r,s,n){let o;let a=tO(t,r,s,n);try{o=await e(i,Object.assign({},a))}catch(e){throw console.error(e),new e6(tA(e),0)}if(o.ok||await tD(o),null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(e){await tD(e)}}function tL(e){var t,i;let r=null;return e.access_token&&e.refresh_token&&e.expires_in&&(r=Object.assign({},e),!e.expires_at)&&(r.expires_at=(i=e.expires_in,Math.round(Date.now()/1e3)+i)),{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tP(e){let t=tL(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tj(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tU(e){return{data:e,error:null}}function tq(e){let{action_link:t,email_otp:i,hashed_token:r,redirect_to:n,verification_type:o}=e;return{data:{properties:{action_link:t,email_otp:i,hashed_token:r,redirect_to:n,verification_type:o},user:Object.assign({},s(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function tB(e){return e}let t$=["global","local","others"];class tM{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=tu(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=t$[0]){if(0>t$.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${t$.join(", ")}`);try{return await tN(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await tN(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tj})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,i=s(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=null==i?void 0:i.newEmail,delete r.newEmail),await tN(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:tq,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(eJ(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await tN(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tj})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,i,r,s,n,o,a;try{let l={nextPage:null,lastPage:0,total:0},h=await tN(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(i=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==i?i:"",per_page:null!==(s=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:tB});if(h.error)throw h.error;let c=await h.json(),u=null!==(n=h.headers.get("x-total-count"))&&void 0!==n?n:0,d=null!==(a=null===(o=h.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),i=JSON.parse(e.split(";")[1].split("=")[1]);l[`${i}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(eJ(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){tk(e);try{return await tN(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tj})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){tk(e);try{return await tN(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tj})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){tk(e);try{return await tN(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tj})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){tk(e.userId);try{let{data:t,error:i}=await tN(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:i}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _deleteFactor(e){tk(e.userId),tk(e.id);try{return{data:await tN(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _listOAuthClients(e){var t,i,r,s,n,o,a;try{let l={nextPage:null,lastPage:0,total:0},h=await tN(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(i=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==i?i:"",per_page:null!==(s=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:tB});if(h.error)throw h.error;let c=await h.json(),u=null!==(n=h.headers.get("x-total-count"))&&void 0!==n?n:0,d=null!==(a=null===(o=h.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),i=JSON.parse(e.split(";")[1].split("=")[1]);l[`${i}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(eJ(e))return{data:{clients:[]},error:e};throw e}}async _createOAuthClient(e){try{return await tN(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _getOAuthClient(e){try{return await tN(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _updateOAuthClient(e,t){try{return await tN(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(e){try{return await tN(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(e){try{return await tN(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}}function tz(e={}){return{getItem:t=>e[t]||null,setItem:(t,i)=>{e[t]=i},removeItem:t=>{delete e[t]}}}let tF={debug:!!(globalThis&&tc()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tW extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tV extends tW{}async function tH(e,t,i){tF.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),tF.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(r){tF.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await i()}finally{tF.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}else{if(0===t)throw tF.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tV(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(tF.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}}))}function tG(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}class tK extends Error{constructor({message:e,code:t,cause:i,name:r}){var s;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=null!==(s=null!=r?r:i instanceof Error?i.name:void 0)&&void 0!==s?s:"Unknown Error",this.code=t}}class tJ extends tK{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}class tX{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let tY=new tX;function tZ(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function tQ(){var e,t;return!!(tl()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null===(e=null==navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"==typeof(null===(t=null==navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}async function t0(e){try{let t=await navigator.credentials.create(e);if(!t)return{data:null,error:new tJ("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new tJ("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){var i,r,s;let{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tK({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null===(i=n.authenticatorSelection)||void 0===i?void 0:i.requireResidentKey)===!0)return new tK({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&(null===(r=n.authenticatorSelection)||void 0===r?void 0:r.userVerification)==="required")return new tK({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if((null===(s=n.authenticatorSelection)||void 0===s?void 0:s.userVerification)==="required")return new tK({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new tK({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new tK({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new tK(0===n.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!tZ(t))return new tK({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(n.rp.id!==t)return new tK({message:`The RP ID "${n.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new tK({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new tK({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new tK({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}async function t1(e){try{let t=await navigator.credentials.get(e);if(!t)return{data:null,error:new tJ("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new tJ("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tK({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new tK({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!tZ(t))return new tK({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rpId!==t)return new tK({message:`The RP ID "${i.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new tK({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new tK({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}let t2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},t3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function t5(...e){let t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),i=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),r={};for(let s of e)if(s)for(let e in s){let n=s[e];if(void 0!==n){if(Array.isArray(n))r[e]=n;else if(i(n))r[e]=n;else if(t(n)){let i=r[e];t(i)?r[e]=t5(i,n):r[e]=t5(n)}else r[e]=n}}return r}class t8{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:r},s){var n,o,a,l,h;try{let{data:c,error:u}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:u};let d=null!=r?r:tY.createNewAbortSignal();if("create"===c.webauthn.type){let{user:e}=c.webauthn.credential_options.publicKey;if(!e.name){if(i)e.name=`${e.id}:${i}`;else{let t=(await this.client.getUser()).data.user,i=(null===(n=null==t?void 0:t.user_metadata)||void 0===n?void 0:n.name)||(null==t?void 0:t.email)||(null==t?void 0:t.id)||"User";e.name=`${e.id}:${i}`}}e.displayName||(e.displayName=e.name)}switch(c.webauthn.type){case"create":{let t=(o=c.webauthn.credential_options.publicKey,a=null==s?void 0:s.create,t5(t2,o,a||{})),{data:i,error:r}=await t0({publicKey:t,signal:d});if(i)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:i}},error:null};return{data:null,error:r}}case"request":{let t=(l=c.webauthn.credential_options.publicKey,h=null==s?void 0:s.request,t5(t3,l,h||{})),{data:i,error:r}=await t1(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:t,signal:d}));if(i)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:i}},error:null};return{data:null,error:r}}}}catch(e){if(eJ(e))return{data:null,error:e};return{data:null,error:new eY("Unexpected error in challenge",e)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:i="undefined"!=typeof window?[window.location.origin]:void 0,signal:r}={}},s){if(!t)return{data:null,error:new eK("rpId is required for WebAuthn authentication")};try{if(!tQ())return{data:null,error:new eY("Browser does not support WebAuthn",null)};let{data:n,error:o}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:r},{request:s});if(!n)return{data:null,error:o};let{webauthn:a}=n;return this._verify({factorId:e,challengeId:n.challengeId,webauthn:{type:a.type,rpId:t,rpOrigins:i,credential_response:a.credential_response}})}catch(e){if(eJ(e))return{data:null,error:e};return{data:null,error:new eY("Unexpected error in authenticate",e)}}}async _register({friendlyName:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:i="undefined"!=typeof window?[window.location.origin]:void 0,signal:r}={}},s){if(!t)return{data:null,error:new eK("rpId is required for WebAuthn registration")};try{if(!tQ())return{data:null,error:new eY("Browser does not support WebAuthn",null)};let{data:n,error:o}=await this._enroll({friendlyName:e});if(!n)return await this.client.mfa.listFactors().then(t=>{var i;return null===(i=t.data)||void 0===i?void 0:i.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:o};let{data:a,error:l}=await this._challenge({factorId:n.id,friendlyName:n.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:r},{create:s});if(!a)return{data:null,error:l};return this._verify({factorId:n.id,challengeId:a.challengeId,webauthn:{rpId:t,rpOrigins:i,type:a.webauthn.type,credential_response:a.webauthn.credential_response}})}catch(e){if(eJ(e))return{data:null,error:e};return{data:null,error:new eY("Unexpected error in register",e)}}}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let t6={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eW,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function t4(e,t,i){return await i()}let t9={};class t7{get jwks(){var e,t;return null!==(t=null===(e=t9[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){t9[this.storageKey]=Object.assign(Object.assign({},t9[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=t9[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){t9[this.storageKey]=Object.assign(Object.assign({},t9[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;let s=Object.assign(Object.assign({},t6),e);if(this.storageKey=s.storageKey,this.instanceID=null!==(t=t7.nextInstanceID[this.storageKey])&&void 0!==t?t:0,t7.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.instanceID>0&&tl()){let e=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new tM({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=tu(s.fetch),this.lock=s.lock||t4,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&tl()&&(null===(i=null==globalThis?void 0:globalThis.navigator)||void 0===i?void 0:i.locks)?this.lock=tH:this.lock=t4,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new t8(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:tc()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tz(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=tz(this.memoryStorage)),tl()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(e){this._debug("#broadcastChannel","error",e)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${eF}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},i="none";if(tl()&&(t=function(e){let t={},i=new URL(e);if(i.hash&&"#"===i.hash[0])try{new URLSearchParams(i.hash.substring(1)).forEach((e,i)=>{t[i]=e})}catch(e){}return i.searchParams.forEach((e,i)=>{t[i]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),tl()&&this.detectSessionInUrl&&"none"!==i){let{data:r,error:s}=await this._getSessionFromURL(t,i);if(s)return this._debug("#_initialize()","error detecting session from URL",s),eJ(s)&&"AuthImplicitGrantRedirectError"===s.name&&(null===(e=s.details)||void 0===e||e.code),{error:s};let{session:n,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",o),await this._saveSession(n),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(eJ(e))return this._returnResult({error:e});return this._returnResult({error:new eY("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{let{data:s,error:n}=await tN(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(i=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==i?i:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:tL});if(n||!s)return this._returnResult({data:{user:null,session:null},error:n});let o=s.session,a=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:a,session:o},error:null})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signUp(e){var t,i,r;try{let s;if("email"in e){let{email:i,password:r,options:n}=e,o=null,a=null;"pkce"===this.flowType&&([o,a]=await tE(this.storage,this.storageKey)),s=await tN(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:i,password:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:o,code_challenge_method:a},xform:tL})}else if("phone"in e){let{phone:t,password:n,options:o}=e;s=await tN(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(i=null==o?void 0:o.data)&&void 0!==i?i:{},channel:null!==(r=null==o?void 0:o.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:tL})}else throw new e2("You must provide either an email or phone number and a password");let{data:n,error:o}=s;if(o||!n)return await tg(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});let a=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:i,password:r,options:s}=e;t=await tN(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:tP})}else if("phone"in e){let{phone:i,password:r,options:s}=e;t=await tN(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:tP})}else throw new e2("You must provide either an email or phone number and a password");let{data:i,error:r}=t;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!i||!i.session||!i.user){let e=new e1;return this._returnResult({data:{user:null,session:null},error:e})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(e){var t,i,r,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,r,s,n,o,a,l,h,c,u,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{let c;let{chain:u,wallet:g,statement:m,options:v}=e;if(tl()){if("object"==typeof g)c=g;else{let e=window;if("ethereum"in e&&"object"==typeof e.ethereum&&"request"in e.ethereum&&"function"==typeof e.ethereum.request)c=e.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof g||!(null==v?void 0:v.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");c=g}let y=new URL(null!==(t=null==v?void 0:v.url)&&void 0!==t?t:window.location.href),b=await c.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||0===b.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let w=tG(b[0]),_=null===(i=null==v?void 0:v.signInWithEthereum)||void 0===i?void 0:i.chainId;_||(_=parseInt(await c.request({method:"eth_chainId"}),16)),f=function(e){var t;let{chainId:i,domain:r,expirationTime:s,issuedAt:n=new Date,nonce:o,notBefore:a,requestId:l,resources:h,scheme:c,uri:u,version:d}=e;if(!Number.isInteger(i))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${i}`);if(!r)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!u)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==d)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);let f=tG(e.address),p=c?`${c}://${r}`:r,g=e.statement?`${e.statement}
`:"",m=`${p} wants you to sign in with your Ethereum account:
${f}

${g}`,v=`URI: ${u}
Version: ${d}
Chain ID: ${i}${o?`
Nonce: ${o}`:""}
Issued At: ${n.toISOString()}`;if(s&&(v+=`
Expiration Time: ${s.toISOString()}`),a&&(v+=`
Not Before: ${a.toISOString()}`),l&&(v+=`
Request ID: ${l}`),h){let e="\nResources:";for(let t of h){if(!t||"string"!=typeof t)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`
- ${t}`}v+=e}return`${m}
${v}`}({domain:y.host,address:w,statement:m,uri:y.href,version:"1",chainId:_,nonce:null===(r=null==v?void 0:v.signInWithEthereum)||void 0===r?void 0:r.nonce,issuedAt:null!==(n=null===(s=null==v?void 0:v.signInWithEthereum)||void 0===s?void 0:s.issuedAt)&&void 0!==n?n:new Date,expirationTime:null===(o=null==v?void 0:v.signInWithEthereum)||void 0===o?void 0:o.expirationTime,notBefore:null===(a=null==v?void 0:v.signInWithEthereum)||void 0===a?void 0:a.notBefore,requestId:null===(l=null==v?void 0:v.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(h=null==v?void 0:v.signInWithEthereum)||void 0===h?void 0:h.resources}),p=await c.request({method:"personal_sign",params:[(d=f,"0x"+Array.from(new TextEncoder().encode(d),e=>e.toString(16).padStart(2,"0")).join("")),w]})}try{let{data:t,error:i}=await tN(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},(null===(c=e.options)||void 0===c?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:tL});if(i)throw i;if(!t||!t.session||!t.user){let e=new e1;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:i})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSolana(e){var t,i,r,s,n,o,a,l,h,c,u,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{let u;let{chain:d,wallet:g,statement:m,options:v}=e;if(tl()){if("object"==typeof g)u=g;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))u=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof g||!(null==v?void 0:v.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");u=g}let y=new URL(null!==(t=null==v?void 0:v.url)&&void 0!==t?t:window.location.href);if("signIn"in u&&u.signIn){let e;let t=await u.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==v?void 0:v.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),m?{statement:m}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)f="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),p=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in u)||"function"!=typeof u.signMessage||!("publicKey"in u)||"object"!=typeof u||!u.publicKey||!("toBase58"in u.publicKey)||"function"!=typeof u.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${y.host} wants you to sign in with your Solana account:`,u.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${y.href}`,`Issued At: ${null!==(r=null===(i=null==v?void 0:v.signInWithSolana)||void 0===i?void 0:i.issuedAt)&&void 0!==r?r:new Date().toISOString()}`,...(null===(s=null==v?void 0:v.signInWithSolana)||void 0===s?void 0:s.notBefore)?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...(null===(n=null==v?void 0:v.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...(null===(o=null==v?void 0:v.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...(null===(a=null==v?void 0:v.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...(null===(l=null==v?void 0:v.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...(null===(c=null===(h=null==v?void 0:v.signInWithSolana)||void 0===h?void 0:h.resources)||void 0===c?void 0:c.length)?["Resources",...v.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await u.signMessage(new TextEncoder().encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{let{data:t,error:i}=await tN(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:ta(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:tL});if(i)throw i;if(!t||!t.session||!t.user){let e=new e1;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:i})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _exchangeCodeForSession(e){let t=await tp(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(null!=t?t:"").split("/");try{if(!i&&"pkce"===this.flowType)throw new e8;let{data:t,error:s}=await tN(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:tL});if(await tg(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!t||!t.session||!t.user){let e=new e1;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:s})}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:{user:null,session:null,redirectType:null},error:e});throw e}}async signInWithIdToken(e){try{let{options:t,provider:i,token:r,access_token:s,nonce:n}=e,{data:o,error:a}=await tN(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:s,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:tL});if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!o||!o.session||!o.user){let e=new e1;return this._returnResult({data:{user:null,session:null},error:e})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:o,error:a})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(e){var t,i,r,s,n;try{if("email"in e){let{email:r,options:s}=e,n=null,o=null;"pkce"===this.flowType&&([n,o]=await tE(this.storage,this.storageKey));let{error:a}=await tN(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(i=null==s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:n,code_challenge_method:o},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}if("phone"in e){let{phone:t,options:i}=e,{data:o,error:a}=await tN(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==i?void 0:i.data)&&void 0!==r?r:{},create_user:null===(s=null==i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},channel:null!==(n=null==i?void 0:i.channel)&&void 0!==n?n:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a})}throw new e2("You must provide either an email or phone number.")}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async verifyOtp(e){var t,i;try{let r,s;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(i=e.options)||void 0===i?void 0:i.captchaToken);let{data:n,error:o}=await tN(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:tL});if(o)throw o;if(!n)throw Error("An error occurred on token verification.");let a=n.session,l=n.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSSO(e){var t,i,r,s,n;try{let o=null,a=null;"pkce"===this.flowType&&([o,a]=await tE(this.storage,this.storageKey));let l=await tN(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(i=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==i?i:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:tU});return(null===(s=l.data)||void 0===s?void 0:s.url)&&tl()&&!(null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:null,error:e});throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new eQ;let{error:r}=await tN(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:i,type:r,options:s}=e,{error:n}=await tN(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:n})}if("phone"in e){let{phone:i,type:r,options:s}=e,{data:n,error:o}=await tN(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o})}throw new e2("You must provide either an email or phone number and a type")}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch(e){}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let t=null,i=await tp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),null!==i&&(this._isValidSession(i)?t=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};let r=!!t.expires_at&&1e3*t.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){let e=await tp(this.userStorage,this.storageKey+"-user");(null==e?void 0:e.user)?t.user=e.user:t.user=tx()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){var e;let i={value:this.suppressGetSessionWarning};t.user=(e=t.user,new Proxy(e,{get:(e,t,r)=>{if("__isInsecureUserWarningProxy"===t)return!0;if("symbol"==typeof t){let i=t.toString();if("Symbol(Symbol.toPrimitive)"===i||"Symbol(Symbol.toStringTag)"===i||"Symbol(util.inspect.custom)"===i||"Symbol(nodejs.util.inspect.custom)"===i)return Reflect.get(e,t,r)}return i.value||"string"!=typeof t||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i.value=!0),Reflect.get(e,t,r)}})),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}let{data:s,error:n}=await this._callRefreshToken(t.refresh_token);if(n)return this._returnResult({data:{session:null},error:n});return this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;let t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{if(e)return await tN(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tj});return await this._useSession(async e=>{var t,i,r;let{data:s,error:n}=e;if(n)throw n;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await tN(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(i=s.session)||void 0===i?void 0:i.access_token)&&void 0!==r?r:void 0,xform:tj}):{data:{user:null},error:new eQ}})}catch(e){if(eJ(e))return e0(e)&&(await this._removeSession(),await tg(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{let{data:r,error:s}=i;if(s)throw s;if(!r.session)throw new eQ;let n=r.session,o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await tE(this.storage,this.storageKey));let{data:l,error:h}=await tN(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:n.access_token,xform:tj});if(h)throw h;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),this._returnResult({data:{user:n.user},error:null})})}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:{user:null},error:e});throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eQ;let t=Date.now()/1e3,i=t,r=!0,s=null,{payload:n}=tv(e.access_token);if(n.exp&&(r=(i=n.exp)<=t),r){let{data:t,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!t)return{data:{user:null,session:null},error:null};s=t}else{let{data:r,error:n}=await this._getUser(e.access_token);if(n)return this._returnResult({data:{user:null,session:null},error:n});s={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(e){if(eJ(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){let{data:r,error:s}=t;if(s)throw s;e=null!==(i=r.session)&&void 0!==i?i:void 0}if(!(null==e?void 0:e.refresh_token))throw new eQ;let{data:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(e,t){try{if(!tl())throw new e3("No browser detected.");if(e.error||e.error_description||e.error_code)throw new e3(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new e5("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new e3("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new e5("No code detected.");let{data:t,error:i}=await this._exchangeCodeForSession(e.code);if(i)throw i;let r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:i,provider_refresh_token:r,access_token:s,refresh_token:n,expires_in:o,expires_at:a,token_type:l}=e;if(!s||!o||!n||!l)throw new e3("No session defined in URL");let h=Math.round(Date.now()/1e3),c=parseInt(o),u=h+c;a&&(u=parseInt(a));let d=u-h;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${c}s`);let f=u-c;h-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,h):h-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,h);let{data:p,error:g}=await this._getUser(s);if(g)throw g;let m={provider_token:i,provider_refresh_token:r,access_token:s,expires_in:c,expires_at:u,refresh_token:n,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(e){if(eJ(e))return this._returnResult({data:{session:null,redirectType:null},error:e});throw e}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await tp(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;let{data:r,error:s}=t;if(s&&!e0(s))return this._returnResult({error:s});let n=null===(i=r.session)||void 0===i?void 0:i.access_token;if(n){let{error:t}=await this.admin.signOut(n,e);if(t&&!(eJ(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)||e0(t)))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await tg(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){let t=Symbol("auth-callback"),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{let{data:{session:r},error:s}=t;if(s)throw s;await (null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;"pkce"===this.flowType&&([i,r]=await tE(this.storage,this.storageKey,!0));try{return await tN(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:null,error:e});throw e}}async getUserIdentities(){var e;try{let{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{let{data:i,error:r}=await this._useSession(async t=>{var i,r,s,n,o;let{data:a,error:l}=t;if(l)throw l;let h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(i=e.options)||void 0===i?void 0:i.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await tN(this.fetch,"GET",h,{headers:this.headers,jwt:null!==(o=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==o?o:void 0})});if(r)throw r;return!tl()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==i?void 0:i.url),this._returnResult({data:{provider:e.provider,url:null==i?void 0:i.url},error:null})}catch(t){if(eJ(t))return this._returnResult({data:{provider:e.provider,url:null},error:t});throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{let{error:r,data:{session:s}}=t;if(r)throw r;let{options:n,provider:o,token:a,access_token:l,nonce:h}=e,{data:c,error:u}=await tN(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(i=null==s?void 0:s.access_token)&&void 0!==i?i:void 0,body:{provider:o,id_token:a,access_token:l,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tL});if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user)return this._returnResult({data:{user:null,session:null},error:new e1});return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("USER_UPDATED",c.session)),this._returnResult({data:c,error:u})}catch(e){if(await tg(this.storage,`${this.storageKey}-code-verifier`),eJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;let{data:s,error:n}=t;if(n)throw n;return await tN(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(i=s.session)||void 0===i?void 0:i.access_token)&&void 0!==r?r:void 0})})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var i,r;let s=Date.now();return await (i=async i=>(i>0&&await ty(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await tN(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:tL})),r=(e,t)=>{let i=200*Math.pow(2,e);return t&&e4(t)&&Date.now()+i-s<3e4},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{let t=await i(s);if(!r(s,null,t)){e(t);return}}catch(e){if(!r(s,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),eJ(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),tl()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;let i="#_recoverAndRefresh()";this._debug(i,"begin");try{let r=await tp(this.storage,this.storageKey);if(r&&this.userStorage){let t=await tp(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:r.user},await tf(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:tx()}else if(r&&!r.user&&!r.user){let e=await tp(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(r.user=e.user,await tg(this.storage,this.storageKey+"-user"),await tf(this.storage,this.storageKey,r)):r.user=tx()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),null!==r&&await this._removeSession();return}let s=(null!==(t=r.expires_at)&&void 0!==t?t:1/0)*1e3-Date.now()<9e4;if(this._debug(i,`session has${s?"":" not"} expired with margin of 90000s`),s){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),e4(e)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(r.access_token);!t&&(null==e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(i,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(i,"error",e),console.error(e);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new eQ;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new tm;let{data:t,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!t.session)throw new eQ;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let r={data:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),eJ(e)){let i={data:null,error:e};return e4(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(i),i}throw null===(i=this.refreshingDeferred)||void 0===i||i.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){let r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});let r=[],s=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(e,t)}catch(e){r.push(e)}});if(await Promise.all(s),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await tg(this.storage,`${this.storageKey}-code-verifier`);let t=Object.assign({},e),i=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!i&&t.user&&await tf(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let r=tC(e);await tf(this.storage,this.storageKey,r)}else{let e=tC(t);await tf(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await tg(this.storage,this.storageKey),await tg(this.storage,this.storageKey+"-code-verifier"),await tg(this.storage,this.storageKey+"-user"),this.userStorage&&await tg(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&tl()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e);let t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);let t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let r=Math.floor((1e3*i.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(i.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tW)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tl()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){let r=[`provider=${encodeURIComponent(t)}`];if((null==i?void 0:i.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),(null==i?void 0:i.scopes)&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),"pkce"===this.flowType){let[e,t]=await tE(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(i.toString())}if(null==i?void 0:i.queryParams){let e=new URLSearchParams(i.queryParams);r.push(e.toString())}return(null==i?void 0:i.skipBrowserRedirect)&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;let{data:r,error:s}=t;return s?this._returnResult({data:null,error:s}):await tN(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(i=null==r?void 0:r.session)||void 0===i?void 0:i.access_token})})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;let{data:s,error:n}=t;if(n)return this._returnResult({data:null,error:n});let o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:a,error:l}=await tN(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(i=null==s?void 0:s.session)||void 0===i?void 0:i.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===a.type&&(null===(r=null==a?void 0:a.totp)||void 0===r?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i,r,s;let{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});let a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?(r=e.webauthn.credential_response,"toJSON"in r&&"function"==typeof r.toJSON?r.toJSON():{id:r.id,rawId:r.id,response:{attestationObject:ta(new Uint8Array(r.response.attestationObject)),clientDataJSON:ta(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:null!==(s=r.authenticatorAttachment)&&void 0!==s?s:void 0}):function(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();let i=e.getClientExtensionResults(),r=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ta(new Uint8Array(r.authenticatorData)),clientDataJSON:ta(new Uint8Array(r.clientDataJSON)),signature:ta(new Uint8Array(r.signature)),userHandle:r.userHandle?ta(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:null!==(t=e.authenticatorAttachment)&&void 0!==t?t:void 0}}(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:h}=await tN(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:null===(i=null==n?void 0:n.session)||void 0===i?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:h}))})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;let{data:r,error:n}=t;if(n)return this._returnResult({data:null,error:n});let o=await tN(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(i=null==r?void 0:r.session)||void 0===i?void 0:i.access_token});if(o.error)return o;let{data:a}=o;if("webauthn"!==a.type)return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);let{challenge:t,user:i,excludeCredentials:r}=e,n=s(e,["challenge","user","excludeCredentials"]),o=to(t).buffer,a=Object.assign(Object.assign({},i),{id:to(i.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:o,user:a});if(r&&r.length>0){l.excludeCredentials=Array(r.length);for(let e=0;e<r.length;e++){let t=r[e];l.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:to(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return l}(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);let{challenge:t,allowCredentials:i}=e,r=s(e,["challenge","allowCredentials"]),n=to(t).buffer,o=Object.assign(Object.assign({},r),{challenge:n});if(i&&i.length>0){o.allowCredentials=Array(i.length);for(let e=0;e<i.length;e++){let t=i[e];o.allowCredentials[e]=Object.assign(Object.assign({},t),{id:to(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(e){let{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;let{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};let r={all:[],phone:[],totp:[],webauthn:[]};for(let i of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])r.all.push(i),"verified"===i.status&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,r,s;if(e)try{let{payload:r}=tv(e),s=null;r.aal&&(s=r.aal);let n=s,{data:{user:o},error:a}=await this.getUser(e);if(a)return this._returnResult({data:null,error:a});(null!==(i=null===(t=null==o?void 0:o.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==i?i:[]).length>0&&(n="aal2");let l=r.amr||[];return{data:{currentLevel:s,nextLevel:n,currentAuthenticationMethods:l},error:null}}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}let{data:{session:n},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:a}=tv(n.access_token),l=null;a.aal&&(l=a.aal);let h=l;return(null!==(s=null===(r=n.user.factors)||void 0===r?void 0:r.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(h="aal2"),{data:{currentLevel:l,nextLevel:h,currentAuthenticationMethods:a.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{let{data:{session:i},error:r}=t;return r?this._returnResult({data:null,error:r}):i?await tN(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new eQ})})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{let{data:{session:r},error:s}=i;if(s)return this._returnResult({data:null,error:s});if(!r)return this._returnResult({data:null,error:new eQ});let n=await tN(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&tl()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{let{data:{session:r},error:s}=i;if(s)return this._returnResult({data:null,error:s});if(!r)return this._returnResult({data:null,error:new eQ});let n=await tN(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&tl()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _listOAuthGrants(){try{return await this._useSession(async e=>{let{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await tN(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new eQ})})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{let{data:{session:i},error:r}=t;return r?this._returnResult({data:null,error:r}):i?(await tN(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new eQ})})}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(t=>t.kid===e);if(i)return i;let r=Date.now();if((i=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>r)return i;let{data:s,error:n}=await tN(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return s.keys&&0!==s.keys.length&&(this.jwks=s,this.jwks_cached_at=r,i=s.keys.find(t=>t.kid===e))?i:null}async getClaims(e,t={}){try{let i=e;if(!i){let{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});i=e.session.access_token}let{header:r,payload:s,signature:n,raw:{header:o,payload:a}}=tv(i);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(s.exp);let l=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!l){let{error:e}=await this.getUser(i);if(e)throw e;return{data:{claims:s,header:r,signature:n},error:null}}let h=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(r.alg),c=await crypto.subtle.importKey("jwk",l,h,!0,["verify"]);if(!await crypto.subtle.verify(h,c,n,function(e){let t=[];return function(e,t){for(let i=0;i<e.length;i+=1){let r=e.charCodeAt(i);if(r>55295&&r<=56319){let t=(r-55296)*1024&65535;r=(e.charCodeAt(i+1)-56320&65535|t)+65536,i+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${o}.${a}`)))throw new e7("Invalid JWT signature");return{data:{claims:s,header:r,signature:n},error:null}}catch(e){if(eJ(e))return this._returnResult({data:null,error:e});throw e}}}t7.nextInstanceID={};let ie=t7,it="";"undefined"!=typeof Deno?it="deno":"undefined"!=typeof document?it="web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?it="react-native":it="node";let ii={headers:{"X-Client-Info":`supabase-js-${it}/2.93.3`}},ir={schema:"public"},is={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},io={};function ia(e){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function il(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function ih(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?il(Object(i),!0).forEach(function(t){!function(e,t,i){var r;(r=function(e,t){if("object"!=ia(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ia(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==ia(r)?r:r+"")in e)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):il(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let ic=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),iu=()=>Headers,id=(e,t,i)=>{let r=ic(i),s=iu();return async(i,n)=>{var o;let a=null!==(o=await t())&&void 0!==o?o:e,l=new s(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),r(i,ih(ih({},n),{},{headers:l}))}};var ip=class extends ie{constructor(e){super(e)}},ig=class{constructor(e,t,i){var r,s,n;this.supabaseUrl=e,this.supabaseKey=t;let o=function(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t.endsWith("/")?t:t+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);let a=`sb-${o.hostname.split(".")[0]}-auth-token`,l=function(e,t){var i,r;let{db:s,auth:n,realtime:o,global:a}=e,{db:l,auth:h,realtime:c,global:u}=t,d={db:ih(ih({},l),s),auth:ih(ih({},h),n),realtime:ih(ih({},c),o),storage:{},global:ih(ih(ih({},u),a),{},{headers:ih(ih({},null!==(i=null==u?void 0:u.headers)&&void 0!==i?i:{}),null!==(r=null==a?void 0:a.headers)&&void 0!==r?r:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=i?i:{},{db:ir,realtime:io,auth:ih(ih({},is),{},{storageKey:a}),global:ii});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(s=l.global.headers)&&void 0!==s?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(n=l.auth)&&void 0!==n?n:{},this.headers,l.global.fetch),this.fetch=id(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(ih({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new A(new URL("rest/v1",o).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new ez(this.storageUrl.href,this.headers,this.fetch,null==i?void 0:i.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();let{data:i}=await this.auth.getSession();return null!==(e=null===(t=i.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,userStorage:s,storageKey:n,flowType:o,lock:a,debug:l,throwOnError:h},c,u){let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ip({url:this.authUrl.href,headers:ih(ih({},d),c),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,userStorage:s,flowType:o,lock:a,debug:l,throwOnError:h,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new X(this.realtimeUrl.href,ih(ih({},e),{},{params:ih(ih({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,i){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}};let im=(e,t,i)=>new ig(e,t,i);(function(){if("undefined"!=typeof window)return!1;let e=globalThis.process;if(!e)return!1;let t=e.version;if(null==t)return!1;let i=t.match(/^v(\d+)\./);return!!i&&18>=parseInt(i[1],10)})()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")}}]);