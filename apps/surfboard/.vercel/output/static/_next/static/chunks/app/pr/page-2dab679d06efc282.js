(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[852],{6482:function(e,t,s){Promise.resolve().then(s.bind(s,6508))},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},6508:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(7437),r=s(2265),l=s(4070),n=s(9376);let i={onde:{label:"@Onde_FRH",color:"cyan",bg:"bg-cyan-500/20",text:"text-cyan-400",border:"border-cyan-500/30"},frh:{label:"@FreeRiverHouse",color:"emerald",bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"},magmatic:{label:"@magmatic__",color:"purple",bg:"bg-purple-500/20",text:"text-purple-400",border:"border-purple-500/30"}};function o(){let{status:e}=(0,l.kP)(),t=(0,n.useRouter)(),[s,o]=(0,r.useState)([]),[d,c]=(0,r.useState)("pending"),[x,h]=(0,r.useState)(!0),[p,m]=(0,r.useState)({}),[u,b]=(0,r.useState)({}),[f,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{"unauthenticated"===e&&t.push("/login")},[e,t]);let v=(0,r.useCallback)(async()=>{try{let e="all"===d?"":"posted"===d?"posted":"pending,approved",t=await fetch("/api/pr/posts?status=".concat(e));if(t.ok){let e=await t.json();o(e.posts||[])}}catch(e){console.error("Failed to fetch posts:",e)}finally{h(!1)}},[d]);(0,r.useEffect)(()=>{if("authenticated"===e){v();let e=setInterval(v,15e3);return()=>clearInterval(e)}},[e,v]);let j=async e=>{m(t=>({...t,[e]:!0}));try{(await fetch("/api/pr/posts/".concat(e,"/approve"),{method:"POST",headers:{"Content-Type":"application/json"}})).ok&&(o(t=>t.map(t=>t.id===e?{...t,status:"approved"}:t)),setTimeout(v,3e3))}catch(e){console.error("Approve failed:",e)}finally{m(t=>({...t,[e]:!1}))}},w=async e=>{let t=u[e];if(null==t?void 0:t.trim()){m(t=>({...t,["feedback_".concat(e)]:!0}));try{(await fetch("/api/pr/posts/".concat(e,"/feedback"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedback:t})})).ok&&(b(t=>({...t,[e]:""})),g(null),v())}catch(e){console.error("Feedback failed:",e)}finally{m(t=>({...t,["feedback_".concat(e)]:!1}))}}};if("loading"===e||x)return(0,a.jsx)("div",{className:"min-h-screen bg-[#0f0f0f] flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-white/60",children:"Loading..."})});let N=s.filter(e=>"pending"===e.status).length,y=s.filter(e=>"approved"===e.status).length;return(0,a.jsx)("div",{className:"min-h-screen bg-[#0f0f0f] text-white",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-4xl",children:"\uD83D\uDCE2"}),"OndePR Dashboard"]}),(0,a.jsx)("p",{className:"text-white/50",children:"Approve posts to auto-publish on X"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-400",children:N}),(0,a.jsx)("div",{className:"text-sm text-white/50",children:"Pending"})]}),(0,a.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:y}),(0,a.jsx)("div",{className:"text-sm text-white/50",children:"Approved"})]}),(0,a.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-emerald-400",children:s.filter(e=>"posted"===e.status).length}),(0,a.jsx)("div",{className:"text-sm text-white/50",children:"Posted"})]})]}),(0,a.jsx)("div",{className:"flex gap-2 mb-6",children:["pending","posted","all"].map(e=>(0,a.jsx)("button",{onClick:()=>c(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(d===e?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"bg-white/5 text-white/50 border border-white/10 hover:bg-white/10"),children:"pending"===e?"Pending":"posted"===e?"Posted":"All"},e))}),(0,a.jsxs)("div",{className:"space-y-4",children:[s.map(e=>{var t;let s=i[e.account],r="pending"===e.status,l="approved"===e.status,n="posted"===e.status;return(0,a.jsxs)("article",{className:"rounded-2xl border overflow-hidden transition-all ".concat(n?"bg-emerald-500/5 border-emerald-500/20":l?"bg-blue-500/5 border-blue-500/20":"bg-white/5 border-white/10 hover:border-white/20"),children:[(0,a.jsxs)("div",{className:"px-5 py-3 border-b border-white/10 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-medium ".concat(s.bg," ").concat(s.text),children:s.label}),l&&(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-xs text-blue-400",children:[(0,a.jsxs)("svg",{className:"w-3 h-3 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Posting..."]}),n&&(0,a.jsxs)("span",{className:"text-xs text-emerald-400 flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Posted"]})]}),(0,a.jsx)("span",{className:"text-xs text-white/40",children:new Date(e.created_at).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"px-5 py-4",children:[(0,a.jsx)("p",{className:"text-white/90 whitespace-pre-wrap leading-relaxed",children:e.content}),e.post_url&&(0,a.jsxs)("a",{href:e.post_url,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center gap-2 text-sm text-cyan-400 hover:text-cyan-300 transition-colors",children:[(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"View on X"]}),e.feedback&&e.feedback.length>0&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-amber-500/10 rounded-lg border border-amber-500/20",children:[(0,a.jsx)("div",{className:"text-xs text-amber-400 mb-1",children:"Feedback:"}),e.feedback.map((e,t)=>(0,a.jsx)("div",{className:"text-sm text-white/70",children:e},t))]})]}),r&&(0,a.jsxs)("div",{className:"px-5 py-4 border-t border-white/10 bg-white/[0.02]",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>j(e.id),disabled:p[e.id],className:"flex-1 py-3 rounded-xl bg-emerald-500/20 text-emerald-400 font-medium hover:bg-emerald-500/30 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:[p[e.id]?(0,a.jsxs)("svg",{className:"w-5 h-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):(0,a.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Approve & Post"]}),(0,a.jsx)("button",{onClick:()=>g(f===e.id?null:e.id),className:"px-4 py-3 rounded-xl bg-amber-500/20 text-amber-400 font-medium hover:bg-amber-500/30 transition-all",children:(0,a.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}),f===e.id&&(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:u[e.id]||"",onChange:t=>b(s=>({...s,[e.id]:t.target.value})),onKeyDown:t=>"Enter"===t.key&&w(e.id),placeholder:"What changes do you need?",className:"flex-1 px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-white placeholder:text-white/30 focus:outline-none focus:border-amber-500/50"}),(0,a.jsx)("button",{onClick:()=>w(e.id),disabled:!(null===(t=u[e.id])||void 0===t?void 0:t.trim())||p["feedback_".concat(e.id)],className:"px-4 py-2 rounded-xl bg-amber-500/20 text-amber-400 font-medium hover:bg-amber-500/30 transition-all disabled:opacity-50",children:"Send"})]})]})]},e.id)}),0===s.length&&(0,a.jsxs)("div",{className:"text-center py-12 text-white/40",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 opacity-40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsxs)("p",{children:["No ","pending"===d?"pending":"posted"===d?"posted":""," posts"]})]})]})]})})}}},function(e){e.O(0,[70,971,30,744],function(){return e(e.s=6482)}),_N_E=e.O()}]);