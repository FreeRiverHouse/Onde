"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[977],{7977:function(e,t,s){s.d(t,{FreeRiverHouse:function(){return d}});var a=s(7437),r=s(2265),o=s(3145),i=s(9065);let n={cream:"#F5E6D3",terracotta:"#D4A574",sage:"#8B9A7B",sky:"#87CEEB",coral:"#E07A5F",stone:"#6B5B4F",shadow:"rgba(0,0,0,0.1)"},l=[{id:"editore-capo",name:"Editore Capo",role:"Content Director",room:"office",color:n.coral,skills:["content_create","book_edit"],image:"/house/agents/editore-capo.png"},{id:"video-factory",name:"Video Factory",role:"Video Production",room:"studio",color:n.terracotta,skills:["video_generate","image_generate"],image:"/house/agents/video-factory.png"},{id:"tech-support",name:"Tech Support",role:"Technical Ops",room:"lab",color:n.sky,skills:["content_create","post_edit"],image:"/house/agents/automation.png"},{id:"onde-pr",name:"Onde PR",role:"Public Relations",room:"lounge",color:n.terracotta,skills:["post_feedback","post_edit"],image:"/house/agents/ondepr.png"},{id:"pina-pennello",name:"Pina Pennello",role:"Visual Artist",room:"studio",color:n.coral,skills:["image_generate"],image:"/house/agents/pina-pennello.png"},{id:"gianni-parola",name:"Gianni Parola",role:"Copywriter",room:"library",color:n.sage,skills:["content_create","book_edit"],image:"/house/agents/gianni-parola.png"},{id:"sally",name:"Sally",role:"AI Assistant",room:"office",color:n.sage,skills:["content_create","post_feedback"],image:"/house/agents/sally.png"},{id:"automation",name:"Automation",role:"Workflow Design",room:"lab",color:n.stone,skills:["content_create"],image:"/house/agents/automation.png"}],c={office:{x:40,y:60,width:180,height:130,label:"Ufficio",image:"/house/rooms/office.png"},studio:{x:250,y:60,width:180,height:130,label:"Studio",image:"/house/rooms/studio.png"},lab:{x:460,y:60,width:180,height:130,label:"Lab",image:"/house/rooms/lab.png"},library:{x:40,y:220,width:180,height:130,label:"Biblioteca",image:"/house/rooms/library.png"},lounge:{x:250,y:220,width:180,height:130,label:"Salotto",image:"/house/rooms/lounge.png"},garden:{x:460,y:220,width:180,height:130,label:"Giardino",image:"/house/rooms/garden.png"}};function d(){let[e,t]=(0,r.useState)([]),[s,d]=(0,r.useState)(null),[u,h]=(0,r.useState)([]),[x,m]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!0),w=(0,r.useRef)(),{showToast:v}=(0,i.p)();(0,r.useEffect)(()=>{t(l.map(e=>{let t=c[e.room],s=t.x+30+Math.random()*(t.width-60),a=t.y+35+Math.random()*(t.height-70);return{...e,position:{x:s,y:a},targetPosition:{x:s,y:a},status:"idle",taskCount:0}}))},[]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/agent-tasks?status=pending,claimed,in_progress&limit=50");if(e.ok){let s=(await e.json()).tasks||[];h(s),t(e=>e.map(e=>{var t;let a=s.filter(t=>{var s;return t.assigned_to===e.id||(null===(s=t.description)||void 0===s?void 0:s.toLowerCase().includes(e.name.toLowerCase()))}),r=a.filter(e=>"in_progress"===e.status||"claimed"===e.status);return{...e,status:r.length>0?"working":"idle",currentTask:null===(t=r[0])||void 0===t?void 0:t.description,taskCount:a.length}}))}}catch(e){console.error("Failed to fetch tasks:",e)}};e();let s=setInterval(e,2e4);return()=>clearInterval(s)},[]),(0,r.useEffect)(()=>{let e=()=>{t(e=>e.map(e=>{if(.015>Math.random()){let t=c[e.room];return{...e,targetPosition:{x:t.x+30+Math.random()*(t.width-60),y:t.y+35+Math.random()*(t.height-70)}}}let t=e.targetPosition.x-e.position.x,s=e.targetPosition.y-e.position.y,a=Math.sqrt(t*t+s*s);if(a>1){let r="working"===e.status?1.2:.4;return{...e,position:{x:e.position.x+t/a*r,y:e.position.y+s/a*r}}}return e})),w.current=requestAnimationFrame(e)};return w.current=requestAnimationFrame(e),()=>{w.current&&cancelAnimationFrame(w.current)}},[]);let j=async()=>{if(s&&x.trim()){g(!0);try{if((await fetch("/api/agent-tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:s.skills[0]||"content_create",description:x,priority:"normal",assigned_to:s.id,created_by:"free-river-house"})})).ok){v("Task assegnato a ".concat(s.name),"success"),m("");let e=await fetch("/api/agent-tasks?status=pending,claimed,in_progress&limit=50");if(e.ok){let t=await e.json();h(t.tasks||[])}}else v("Errore nella creazione del task","error")}catch(e){v("Errore di connessione","error")}finally{g(!1)}}},k=e.filter(e=>"working"===e.status).length,y=u.filter(e=>{var t;return e.assigned_to===(null==s?void 0:s.id)||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes((null==s?void 0:s.name.toLowerCase())||""))});return(0,a.jsxs)("section",{"aria-label":"Free River House",className:"bg-white/5 rounded-2xl border border-white/10 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>b(!f),className:"w-full px-4 py-3 border-b border-white/10 flex items-center justify-between hover:bg-white/[0.02] transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83C\uDFE0"}),(0,a.jsx)("h2",{className:"text-sm font-medium text-white",children:"Free River House"}),k>0&&(0,a.jsxs)("span",{className:"px-2 py-0.5 text-xs bg-emerald-400/20 text-emerald-400 rounded-full animate-pulse",children:[k," al lavoro"]})]}),(0,a.jsx)("span",{className:"text-white/40 text-xs",children:f?"▼":"▶"})]}),f&&(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,a.jsx)("div",{className:"flex-1 p-4",children:(0,a.jsxs)("div",{className:"relative w-full",style:{aspectRatio:"680/390"},children:[(0,a.jsxs)("div",{className:"absolute inset-0 rounded-xl overflow-hidden",style:{background:"linear-gradient(135deg, ".concat(n.cream," 0%, ").concat(n.sky,"40 100%)")},children:[(0,a.jsx)("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-2 gap-2 p-3",children:Object.entries(c).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"relative rounded-lg overflow-hidden shadow-lg transition-transform hover:scale-[1.02]",style:{boxShadow:"0 4px 12px ".concat(n.shadow)},children:[(0,a.jsx)(o.default,{src:s.image,alt:s.label,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 33vw, 200px"}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 py-1.5 px-2 text-center",style:{background:"linear-gradient(transparent, rgba(0,0,0,0.5))"},children:(0,a.jsx)("span",{className:"text-white text-xs font-medium drop-shadow-md",children:s.label})})]},t)})}),(0,a.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:e.map(e=>{let t=Object.keys(c).indexOf(e.room),r=(e.position.x%40-20)*.3,i=(e.position.y%40-20)*.3;return(0,a.jsxs)("div",{className:"absolute pointer-events-auto cursor-pointer transition-all duration-300 hover:scale-110",style:{left:"calc(".concat(t%3*33.33+16.66,"% + ").concat(r,"px)"),top:"calc(".concat(50*Math.floor(t/3)+25,"% + ").concat(i,"px)"),transform:"translate(-50%, -50%)",zIndex:(null==s?void 0:s.id)===e.id?20:10},onClick:()=>d(e),children:["working"===e.status&&(0,a.jsx)("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:"radial-gradient(circle, ".concat(e.color,"60 0%, transparent 70%)"),transform:"scale(2)"}}),(0,a.jsx)("div",{className:"relative w-12 h-12 rounded-full overflow-hidden border-2 shadow-lg",style:{borderColor:(null==s?void 0:s.id)===e.id?"#fff":e.color,boxShadow:(null==s?void 0:s.id)===e.id?"0 0 0 2px #fff, 0 4px 12px rgba(0,0,0,0.3)":"0 4px 12px ".concat(n.shadow)},children:(0,a.jsx)(o.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover",sizes:"48px"})}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 rounded-full border-2 border-white shadow ".concat("working"===e.status?"bg-emerald-400 animate-pulse":"bg-amber-400")}),e.taskCount>0&&(0,a.jsx)("div",{className:"absolute -top-1 -left-1 w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center text-white text-[10px] font-bold shadow",children:e.taskCount}),(0,a.jsx)("div",{className:"absolute -bottom-5 left-1/2 transform -translate-x-1/2 whitespace-nowrap",style:{color:n.stone},children:(0,a.jsx)("span",{className:"text-[10px] font-medium bg-white/80 px-1.5 py-0.5 rounded shadow-sm",children:e.name.split(" ")[0]})})]},e.id)})})]}),(0,a.jsxs)("div",{className:"absolute bottom-2 left-3 right-3 flex items-center justify-between text-[10px]",style:{color:n.stone},children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 bg-white/80 px-2 py-1 rounded",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-emerald-400 rounded-full"}),"Working"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-amber-400 rounded-full"}),"Idle"]})]}),(0,a.jsx)("span",{className:"bg-white/80 px-2 py-1 rounded opacity-60",children:"Click agent to assign task"})]})]})}),(0,a.jsx)("div",{className:"w-full lg:w-72 border-t lg:border-t-0 lg:border-l border-white/10 flex flex-col bg-white/[0.02]",children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 border-b border-white/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("div",{className:"relative w-12 h-12 rounded-xl overflow-hidden",style:{backgroundColor:"".concat(s.color,"20")},children:(0,a.jsx)(o.default,{src:s.image,alt:s.name,fill:!0,className:"object-cover",sizes:"48px"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-white font-medium text-sm",children:s.name}),(0,a.jsx)("p",{className:"text-white/40 text-xs",children:s.role})]})]}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 rounded-lg text-xs ".concat("working"===s.status?"bg-emerald-400/10 text-emerald-400":"bg-amber-400/10 text-amber-400"),children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 rounded-full ".concat("working"===s.status?"bg-emerald-400 animate-pulse":"bg-amber-400")}),"working"===s.status?"Al lavoro":"Disponibile"]}),s.currentTask&&(0,a.jsxs)("p",{className:"mt-2 text-xs text-white/50 truncate",children:["Task: ",s.currentTask.slice(0,40),"..."]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto max-h-40 p-2",children:y.length>0?(0,a.jsx)("div",{className:"space-y-1",children:y.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"p-2 rounded-lg bg-white/5 text-xs",children:[(0,a.jsx)("div",{className:"text-white/70 truncate",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{className:"px-1.5 py-0.5 rounded ".concat("in_progress"===e.status?"bg-blue-400/20 text-blue-400":"pending"===e.status?"bg-amber-400/20 text-amber-400":"bg-white/10 text-white/50"),children:e.status}),(0,a.jsx)("span",{className:"text-white/30",children:e.priority})]})]},e.id))}):(0,a.jsx)("p",{className:"text-white/30 text-xs text-center py-4",children:"Nessun task assegnato"})}),(0,a.jsxs)("div",{className:"p-3 border-t border-white/10",children:[(0,a.jsxs)("label",{className:"block text-xs text-white/40 mb-1",children:["Nuovo task per ",s.name.split(" ")[0]]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),onKeyDown:e=>"Enter"===e.key&&j(),placeholder:"Descrivi il task...",className:"flex-1 bg-white/5 border border-white/10 text-white px-3 py-2 rounded-lg text-xs placeholder:text-white/30 focus:outline-none focus:border-cyan-500/50"}),(0,a.jsx)("button",{onClick:j,disabled:!x.trim()||p,className:"px-3 py-2 bg-cyan-500/20 text-cyan-400 rounded-lg hover:bg-cyan-500/30 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:p?(0,a.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-6 text-white/30 text-center text-sm",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-3xl mb-3 block",children:"\uD83D\uDC46"}),(0,a.jsxs)("p",{children:["Clicca un agente",(0,a.jsx)("br",{}),"per assegnare task"]})]})})})]}),f&&(0,a.jsx)("div",{className:"px-4 py-3 border-t border-white/10 bg-white/[0.01]",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>(0,a.jsxs)("button",{onClick:()=>d(e),className:"px-2 py-1 rounded-lg text-xs flex items-center gap-2 transition-all border ".concat((null==s?void 0:s.id)===e.id?"bg-white/10 text-white border-white/20":"bg-white/5 text-white/50 border-transparent hover:bg-white/10 hover:text-white/70"),children:[(0,a.jsx)("div",{className:"relative w-5 h-5 rounded-full overflow-hidden",children:(0,a.jsx)(o.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover",sizes:"20px"})}),(0,a.jsx)("span",{children:e.name.split(" ")[0]}),"working"===e.status&&(0,a.jsx)("span",{className:"w-1.5 h-1.5 bg-emerald-400 rounded-full animate-pulse"})]},e.id))})})]})}},9065:function(e,t,s){s.d(t,{V:function(){return n},p:function(){return i}});var a=s(7437),r=s(2265);let o=(0,r.createContext)(void 0);function i(){let e=(0,r.useContext)(o);if(!e)throw Error("useToast must be used within ToastProvider");return e}function n(e){let{children:t}=e,[s,i]=(0,r.useState)([]),n=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=Math.random().toString(36).substr(2,9);i(a=>[...a,{id:s,message:e,type:t}])},[]),c=(0,r.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]);return(0,a.jsxs)(o.Provider,{value:{showToast:n},children:[t,(0,a.jsx)(l,{toasts:s,removeToast:c})]})}function l(e){let{toasts:t,removeToast:s}=e;return(0,a.jsx)("div",{className:"fixed bottom-4 right-4 z-[100] flex flex-col gap-2 pointer-events-none",children:t.map(e=>(0,a.jsx)(c,{toast:e,onClose:()=>s(e.id)},e.id))})}function c(e){let{toast:t,onClose:s}=e;(0,r.useEffect)(()=>{let e=setTimeout(s,4e3);return()=>clearTimeout(e)},[s]);let o={success:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),error:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),warning:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),info:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})};return(0,a.jsxs)("div",{className:"".concat({success:"bg-emerald-500/90",error:"bg-red-500/90",warning:"bg-amber-500/90",info:"bg-cyan-500/90"}[t.type]," text-white px-4 py-3 rounded-xl shadow-lg backdrop-blur-sm flex items-center gap-3 pointer-events-auto animate-slide-in-right min-w-[280px] max-w-[400px]"),children:[o[t.type],(0,a.jsx)("span",{className:"text-sm font-medium flex-1",children:t.message}),(0,a.jsx)("button",{onClick:s,className:"opacity-70 hover:opacity-100 transition-opacity",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}}}]);