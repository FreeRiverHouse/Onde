var o={},m=(h,D,N)=>(o.__chunk_4306=(T,i,d)=>{"use strict";d.d(i,{JC:()=>_,JP:()=>b,PI:()=>u,SX:()=>l,Wm:()=>f,__:()=>g,cx:()=>O,mi:()=>c,o7:()=>E,sb:()=>p,sy:()=>S,yY:()=>y});let s=[{id:"1",account:"onde",content:"New book release coming soon! Stay tuned for our latest children's story about MILO the robot.",scheduled_for:"2026-01-22 08:08",status:"pending",created_at:new Date().toISOString(),source:"dashboard"},{id:"2",account:"frh",content:"Building in public: Just deployed our new dashboard with real-time monitoring.",scheduled_for:"2026-01-22 09:09",status:"pending",created_at:new Date().toISOString(),source:"dashboard"}];async function c(r){try{return(await r.prepare("SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC").bind("pending").all()).results.map(e=>({...e,feedback:e.feedback?JSON.parse(e.feedback):void 0,media_files:e.media_files?JSON.parse(e.media_files):void 0}))}catch(e){return console.error("D1 getPendingPosts error:",e),[]}}async function u(r){try{return(await r.prepare("SELECT * FROM posts ORDER BY created_at DESC LIMIT 100").all()).results.map(e=>({...e,feedback:e.feedback?JSON.parse(e.feedback):void 0,media_files:e.media_files?JSON.parse(e.media_files):void 0}))}catch(e){return console.error("D1 getAllPosts error:",e),[]}}async function p(r,e){try{let t=await r.prepare("UPDATE posts SET status = ?, approved_at = ? WHERE id = ? AND status = ?").bind("approved",new Date().toISOString(),e,"pending").run();try{await r.prepare("INSERT INTO activity_log (user_id, action, details) VALUES (?, ?, ?)").bind(0,"post_approved",JSON.stringify({post_id:e,source:"dashboard"})).run()}catch{}return t.success}catch(t){return console.error("D1 approvePost error:",t),!1}}async function l(r,e){try{let t=await r.prepare("UPDATE posts SET status = ? WHERE id = ? AND status = ?").bind("rejected",e,"pending").run();try{await r.prepare("INSERT INTO activity_log (user_id, action, details) VALUES (?, ?, ?)").bind(0,"post_rejected",JSON.stringify({post_id:e,source:"dashboard"})).run()}catch{}return t.success}catch(t){return console.error("D1 rejectPost error:",t),!1}}async function f(r,e,t){try{let a=await r.prepare("SELECT feedback FROM posts WHERE id = ?").bind(e).first(),n=[];return a?.feedback&&(n=JSON.parse(a.feedback)),n.push(t),(await r.prepare("UPDATE posts SET feedback = ? WHERE id = ?").bind(JSON.stringify(n),e).run()).success}catch(a){return console.error("D1 addFeedback error:",a),!1}}async function _(r,e){try{let t={...e,id:`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,created_at:new Date().toISOString()};await r.prepare(`INSERT INTO posts (id, account, content, scheduled_for, status, feedback, media_files, created_at, source)
       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)`).bind(t.id,t.account,t.content,t.scheduled_for||null,t.status||"pending",t.feedback?JSON.stringify(t.feedback):null,t.media_files?JSON.stringify(t.media_files):null,t.created_at,t.source||"dashboard").run();try{await r.prepare("INSERT INTO activity_log (user_id, action, details) VALUES (?, ?, ?)").bind(0,"post_created",JSON.stringify({post_id:t.id,account:t.account,source:t.source})).run()}catch{}return t}catch(t){return console.error("D1 addPost error:",t),null}}async function S(r,e,t){try{let a=await r.prepare("UPDATE posts SET status = ?, posted_at = ?, post_url = ? WHERE id = ?").bind("posted",new Date().toISOString(),t,e).run();try{await r.prepare("INSERT INTO activity_log (user_id, action, details) VALUES (?, ?, ?)").bind(0,"post_posted",JSON.stringify({post_id:e,url:t})).run()}catch{}return a.success}catch(a){return console.error("D1 markAsPosted error:",a),!1}}async function E(r,e=20){try{return(await r.prepare("SELECT * FROM activity_log ORDER BY created_at DESC LIMIT ?").bind(e).all()).results.map(t=>({id:t.id,type:t.type,title:t.title,description:t.description,actor:t.actor,metadata:t.metadata?JSON.parse(t.metadata):void 0,created_at:t.created_at}))}catch(t){return console.error("D1 getActivityLog error:",t),[]}}function b(){return s.filter(r=>r.status==="pending")}function y(r){let e=s.find(t=>t.id===r);return!!e&&(e.status="approved",e.approved_at=new Date().toISOString(),!0)}function g(r){let e=s.find(t=>t.id===r);return!!e&&(e.status="rejected",!0)}function O(r,e){let t=s.find(a=>a.id===r);return!!t&&(t.feedback||(t.feedback=[]),t.feedback.push(e),!0)}},o);export{m as __getNamedExports};
