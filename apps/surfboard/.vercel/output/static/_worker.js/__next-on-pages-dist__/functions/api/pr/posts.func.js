var G=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var Q=(s,i)=>()=>(s&&(i=s(s=0)),i);var B=(s,i,C,l)=>{if(i&&typeof i=="object"||typeof i=="function")for(let x of Y(i))!z.call(s,x)&&x!==C&&G(s,x,{get:()=>i[x],enumerable:!(l=V(i,x))||l.enumerable});return s},q=(s,i,C)=>(B(s,i,"default"),C&&B(C,i,"default"));var Z=s=>B(G({},"__esModule",{value:!0}),s);var F={};import*as ht from"async_hooks";var H=Q(()=>{q(F,ht)});import{__getNamedExports as ee}from"../../../../__next-on-pages-dist__/webpack/562f1929e61c51936b027740cd20d5f9.js";import{__getNamedExports as te}from"../../../../__next-on-pages-dist__/webpack/d6830180ae0f03b84fd7a5e7248c5aa2.js";import{__getNamedExports as ne}from"../../../../__next-on-pages-dist__/webpack/d2550da8fc2781985fea0b1c0d3097c7.js";import{__getNamedExports as _e}from"../../../../__next-on-pages-dist__/webpack/030bd997c35875172fa1ffa5b8a901e4.js";import{__getNamedExports as re}from"../../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var f=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/pr/posts"),W=ee(f,f,f),oe=W.__chunk_5822,ce=W.__chunk_7185,$=te(f,f,f),ae=$.__chunk_6195,se=$.__chunk_2067,ue=$.__chunk_5558,ie=$.__chunk_5303,pe=$.__chunk_5228,he=$.__chunk_1959,y=ne(f,f,f),ke=y.__chunk_1730,de=y.__chunk_3818,ge=y.__chunk_7037,fe=y.__chunk_1863,le=y.__chunk_932,xe=y.__chunk_581,me=y.__chunk_2561,be=y.__chunk_2988,Ee=y.__chunk_2039,ye=y.__chunk_5028,ve=y.__chunk_9548,Ne=y.__chunk_6914,Re=y.__chunk_7960,Oe=y.__chunk_5996,we=y.__chunk_4337,o=_e(f,f,f),Pe=o.__chunk_5405,Se=o.__chunk_7322,je=o.__chunk_5276,Te=o.__chunk_5577,Ae=o.__chunk_3039,Ie=o.__chunk_9573,$e=o.__chunk_7701,Ce=o.__chunk_662,Fe=o.__chunk_4101,Me=o.__chunk_6776,De=o.__chunk_8042,Le=o.__chunk_3665,Ue=o.__chunk_7444,Ke=o.__chunk_4591,Be=o.__chunk_6991,qe=o.__chunk_8816,Xe=o.__chunk_6631,Ge=o.__chunk_4828,He=o.__chunk_828,We=o.__chunk_5927,Je=o.__chunk_6202,Ve=o.__chunk_6947,Ye=o.__chunk_4363,ze=o.__chunk_8264,Qe=o.__chunk_1583,Ze=o.__chunk_9985,et=o.__chunk_4155,tt=o.__chunk_7908,nt=o.__chunk_8949,_t=o.__chunk_796,rt=o.__chunk_1651,ot=o.__chunk_5105,ct=o.__chunk_9642,at=o.__chunk_8819,st=o.__chunk_676,J=re(f,f,f),ut=J.__NEXT_FONT_MANIFEST,it=J.__REACT_LOADABLE_MANIFEST,xt=((s,i,C)=>(i._ENTRIES={},s.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/fd9d1056-dcba7f094ce3d609.js","static/chunks/30-b50f13889648ea77.js","static/chunks/main-app-17503da640fcbefb.js"],pages:{"/_app":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-dc5c0cdb2c2c0bdb.js","static/chunks/pages/_app-72b849fbd24ac258.js"],"/_error":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-dc5c0cdb2c2c0bdb.js","static/chunks/pages/_error-7ba65e1336b92748.js"]},ampFirstPages:[]},s.__BUILD_MANIFEST.lowPriorityFiles=["/static/FQBh2Ar4Fsg4ZG1NC9Wb7/_buildManifest.js",,"/static/FQBh2Ar4Fsg4ZG1NC9Wb7/_ssgManifest.js"],s.__REACT_LOADABLE_MANIFEST=it,s.__NEXT_FONT_MANIFEST=ut,s.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var l={},x={};function r(t){var a=x[t];if(a!==void 0)return a.exports;var u=x[t]={exports:{}},m=!0;try{l[t](u,u.exports,r),m=!1}finally{m&&delete x[t]}return u.exports}r.m=l,r.amdO={},(()=>{var t=[];r.O=(a,u,m,b)=>{if(u){b=b||0;for(var h=t.length;h>0&&t[h-1][2]>b;h--)t[h]=t[h-1];t[h]=[u,m,b];return}for(var g=1/0,h=0;h<t.length;h++){for(var[u,m,b]=t[h],R=!0,v=0;v<u.length;v++)g>=b&&Object.keys(r.O).every(I=>r.O[I](u[v]))?u.splice(v--,1):(R=!1,b<g&&(g=b));if(R){t.splice(h--,1);var P=m();P!==void 0&&(a=P)}}return a}})(),r.n=t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return r.d(a,{a}),a},r.d=(t,a)=>{for(var u in a)r.o(a,u)&&!r.o(t,u)&&Object.defineProperty(t,u,{enumerable:!0,get:a[u]})},r.e=()=>Promise.resolve(),r.g=function(){if(typeof i=="object")return i;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),r.o=(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r.r=t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={993:0};r.O.j=m=>t[m]===0;var a=(m,b)=>{var h,g,[R,v,P]=b,T=0;if(R.some(A=>t[A]!==0)){for(h in v)r.o(v,h)&&(r.m[h]=v[h]);if(P)var S=P(r)}for(m&&m(b);T<R.length;T++)g=R[T],r.o(t,g)&&t[g]&&t[g][0](),t[g]=0;return r.O(S)},u=s.webpackChunk_N_E=s.webpackChunk_N_E||[];u.forEach(a.bind(null,0)),u.push=a.bind(null,u.push.bind(u))})()})(),(s.webpackChunk_N_E=s.webpackChunk_N_E||[]).push([[241],{676:st,8819:at,9642:ct,5105:ot,1651:rt,796:_t,8949:nt,7908:tt,4155:et,9985:Ze,1583:Qe,8264:ze,4363:Ye,6947:Ve,6202:Je,5927:We,828:He,4828:Ge,6631:Xe,8816:qe,6991:Be,4591:Ke,7444:Ue,3665:Le,8042:De,6776:Me,4101:Fe,662:Ce,7701:$e,9573:Ie,3039:Ae,5577:Te,1959:he,5276:je,5228:pe,5303:ie,7322:Se,5558:ue,5405:Pe}]),(s.webpackChunk_N_E=s.webpackChunk_N_E||[]).push([[805],{4337:we,5996:Oe,7960:Re,6914:Ne,9548:ve,5028:ye,2039:Ee,2988:be,2561:me,581:xe,932:le,1863:fe,7037:ge,3818:de,1730:ke}]),(s.webpackChunk_N_E=s.webpackChunk_N_E||[]).push([[4],{2067:se,6195:ae,730:(l,x,r)=>{"use strict";r.r(x),r.d(x,{ComponentMod:()=>U,default:()=>K});var t={};r.r(t),r.d(t,{GET:()=>P,POST:()=>T,runtime:()=>v});var a={};r.r(a),r.d(a,{originalPathname:()=>D,patchFetch:()=>L,requestAsyncStorage:()=>A,routeModule:()=>S,serverHooks:()=>I,staticGenerationAsyncStorage:()=>M});var u=r(932),m=r(2561),b=r(4828),h=r(6631),g=r(9985),R=r(5822);let v="edge";async function P(O){try{let{env:w}=(0,R.getRequestContext)(),e=w.DB;if(!e)return g.xk.json({error:"Database not available"},{status:500});let c=new URL(O.url),n=c.searchParams.get("status"),_=c.searchParams.get("account"),k=parseInt(c.searchParams.get("limit")||"50"),d="SELECT * FROM posts WHERE 1=1",E=[];if(n){let p=n.split(",");d+=` AND status IN (${p.map(()=>"?").join(",")})`,E.push(...p)}if(_){let p=_.split(",");d+=` AND account IN (${p.map(()=>"?").join(",")})`,E.push(...p)}d+=" ORDER BY created_at DESC LIMIT ?",E.push(k);let N=((await e.prepare(d).bind(...E).all()).results||[]).map(p=>({...p,feedback:p.feedback?JSON.parse(p.feedback):[],media_files:p.media_files?JSON.parse(p.media_files):[]}));return g.xk.json({success:!0,posts:N,count:N.length})}catch(w){return console.error("PR posts GET error:",w),g.xk.json({error:"Failed to fetch posts"},{status:500})}}async function T(O){try{let{env:w}=(0,R.getRequestContext)(),e=w.DB;if(!e)return g.xk.json({error:"Database not available"},{status:500});let{account:c,content:n,scheduled_for:_,media_files:k,source:d="dashboard"}=await O.json();if(!c||!n)return g.xk.json({error:"account and content are required"},{status:400});let E=`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,N=new Date().toISOString();return await e.prepare(`
      INSERT INTO posts (id, account, content, scheduled_for, status, media_files, created_at, source, auto_post)
      VALUES (?, ?, ?, ?, 'pending', ?, ?, ?, 1)
    `).bind(E,c,n,_||null,k?JSON.stringify(k):null,N,d).run(),g.xk.json({success:!0,post:{id:E,account:c,content:n,scheduled_for:_,status:"pending",created_at:N,auto_post:1}})}catch(w){return console.error("PR posts POST error:",w),g.xk.json({error:"Failed to create post"},{status:500})}}let S=new m.AppRouteRouteModule({definition:{kind:b.x.APP_ROUTE,page:"/api/pr/posts/route",pathname:"/api/pr/posts",filename:"route",bundlePath:"app/api/pr/posts/route"},resolvedPagePath:"/Users/mattiapetrucciani/CascadeProjects/Onde/apps/surfboard/src/app/api/pr/posts/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:A,staticGenerationAsyncStorage:M,serverHooks:I}=S,D="/api/pr/posts/route";function L(){return(0,h.XH)({serverHooks:I,staticGenerationAsyncStorage:M})}let U=a,K=u.a.wrap(S)},7185:ce,5822:oe},l=>{var x=t=>l(l.s=t);l.O(0,[241,805],()=>x(730));var r=l.O();(i._ENTRIES=typeof i._ENTRIES>"u"?{}:i._ENTRIES)["middleware_app/api/pr/posts/route"]=r}]),function(){let l={exports:{},loaded:!1};return function(r,t){"use strict";var a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,m=Object.getOwnPropertyNames,b=Object.prototype.hasOwnProperty,h=(e,c)=>{for(var n in c)a(e,n,{get:c[n],enumerable:!0})},g=(e,c,n,_)=>{if(c&&typeof c=="object"||typeof c=="function")for(let k of m(c))!b.call(e,k)&&k!==n&&a(e,k,{get:()=>c[k],enumerable:!(_=u(c,k))||_.enumerable});return e},R=e=>g(a({},"__esModule",{value:!0}),e),v={};h(v,{default:()=>K}),r.exports=R(v);var P=(H(),Z(F)),T="@next/request-context",S=Symbol.for(T),A=Symbol.for("internal.storage");function M(){let e=i;if(!e[S]){let c=new P.AsyncLocalStorage,n={get:()=>c.getStore(),[A]:c};e[S]=n}return e[S]}var I=M();function D(e,c){return I[A].run(e,c)}function L(e){let c={};return e&&e.forEach((n,_)=>{c[_]=n,_.toLowerCase()==="set-cookie"&&(c[_]=U(n))}),c}function U(e){let c=[],n=0,_,k,d,E,N;function p(){for(;n<e.length&&/\s/.test(e.charAt(n));)n+=1;return n<e.length}function j(){return k=e.charAt(n),k!=="="&&k!==";"&&k!==","}for(;n<e.length;){for(_=n,N=!1;p();)if(k=e.charAt(n),k===","){for(d=n,n+=1,p(),E=n;n<e.length&&j();)n+=1;n<e.length&&e.charAt(n)==="="?(N=!0,n=E,c.push(e.substring(_,d)),_=n):n=d+1}else n+=1;(!N||n>=e.length)&&c.push(e.substring(_,e.length))}return c}function K(e){let c=e.staticRoutes.map(_=>({regexp:new RegExp(_.namedRegex),page:_.page})),n=e.dynamicRoutes?.map(_=>({regexp:new RegExp(_.namedRegex),page:_.page}))||[];return async function(_,k){let d=new URL(_.url).pathname,E={};if(e.nextConfig?.basePath&&d.startsWith(e.nextConfig.basePath)&&(d=d.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let p of e.nextConfig.i18n.locales){let j=new RegExp(`^/${p}($|/)`,"i");if(d.match(j)){d=d.replace(j,"/")||"/";break}}for(let p of c)if(p.regexp.exec(d)){E.name=p.page;break}if(!E.name){let p=w(d);for(let j of n||[]){if(p&&!w(j.page))continue;let X=j.regexp.exec(d);if(X){E={name:j.page,params:X.groups};break}}}let N=await D({waitUntil:k.waitUntil},()=>i._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:_.url,method:_.method,headers:L(_.headers),ip:O(_.headers,"x-real-ip"),geo:{city:O(_.headers,"x-vercel-ip-city",!0),country:O(_.headers,"x-vercel-ip-country",!0),latitude:O(_.headers,"x-vercel-ip-latitude"),longitude:O(_.headers,"x-vercel-ip-longitude"),region:O(_.headers,"x-vercel-ip-country-region",!0)},nextConfig:e.nextConfig,page:E,body:_.body}}));return N.waitUntil&&k.waitUntil(N.waitUntil),N.response}}function O(e,c,n=!1){let _=e.get(c)||void 0;return n&&_?decodeURIComponent(_):_}function w(e){return e==="/api"||e.startsWith("/api/")}}(l,l.exports),l.exports}.call({}).default({name:"app/api/pr/posts/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/coming-soon",regex:"^/coming\\-soon(?:/)?$",routeKeys:{},namedRegex:"^/coming\\-soon(?:/)?$"},{page:"/corde",regex:"^/corde(?:/)?$",routeKeys:{},namedRegex:"^/corde(?:/)?$"},{page:"/frh",regex:"^/frh(?:/)?$",routeKeys:{},namedRegex:"^/frh(?:/)?$"},{page:"/house",regex:"^/house(?:/)?$",routeKeys:{},namedRegex:"^/house(?:/)?$"},{page:"/login",regex:"^/login(?:/)?$",routeKeys:{},namedRegex:"^/login(?:/)?$"},{page:"/pr",regex:"^/pr(?:/)?$",routeKeys:{},namedRegex:"^/pr(?:/)?$"},{page:"/social",regex:"^/social(?:/)?$",routeKeys:{},namedRegex:"^/social(?:/)?$"}],dynamicRoutes:[{page:"/api/agent-tasks/[id]",regex:"^/api/agent\\-tasks/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/agent\\-tasks/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/pr/posts/[id]/approve",regex:"^/api/pr/posts/([^/]+?)/approve(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/pr/posts/(?<nxtPid>[^/]+?)/approve(?:/)?$"},{page:"/api/pr/posts/[id]/feedback",regex:"^/api/pr/posts/([^/]+?)/feedback(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/pr/posts/(?<nxtPid>[^/]+?)/feedback(?:/)?$"}],nextConfig:{basePath:""}})))(f,f,f);export{xt as default};
