var z=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Y=Object.prototype.hasOwnProperty;var Q=(p,g)=>()=>(p&&(g=p(p=0)),g);var B=(p,g,C,y)=>{if(g&&typeof g=="object"||typeof g=="function")for(let b of V(g))!Y.call(p,b)&&b!==C&&z(p,b,{get:()=>g[b],enumerable:!(y=W(g,b))||y.enumerable});return p},K=(p,g,C)=>(B(p,g,"default"),C&&B(C,g,"default"));var Z=p=>B(z({},"__esModule",{value:!0}),p);var $={};import*as mt from"async_hooks";var G=Q(()=>{K($,mt)});import{__getNamedExports as ee}from"../../../__next-on-pages-dist__/webpack/562f1929e61c51936b027740cd20d5f9.js";import{__getNamedExports as te}from"../../../__next-on-pages-dist__/webpack/4306.js";import{__getNamedExports as ne}from"../../../__next-on-pages-dist__/webpack/3326.js";import{__getNamedExports as _e}from"../../../__next-on-pages-dist__/webpack/d6830180ae0f03b84fd7a5e7248c5aa2.js";import{__getNamedExports as se}from"../../../__next-on-pages-dist__/webpack/d2550da8fc2781985fea0b1c0d3097c7.js";import{__getNamedExports as ae}from"../../../__next-on-pages-dist__/webpack/030bd997c35875172fa1ffa5b8a901e4.js";import{__getNamedExports as re}from"../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var h=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/sync"),H=ee(h,h,h),oe=H.__chunk_5822,ce=H.__chunk_7185,ue=te(h,h,h),ie=ue.__chunk_4306,de=ne(h,h,h),pe=de.__chunk_3326,A=_e(h,h,h),ke=A.__chunk_6195,he=A.__chunk_2067,ge=A.__chunk_5558,le=A.__chunk_5303,fe=A.__chunk_5228,me=A.__chunk_1959,v=se(h,h,h),xe=v.__chunk_1730,ye=v.__chunk_3818,be=v.__chunk_7037,Ee=v.__chunk_1863,je=v.__chunk_932,ve=v.__chunk_581,we=v.__chunk_2561,Ne=v.__chunk_2988,Oe=v.__chunk_2039,Se=v.__chunk_5028,Re=v.__chunk_9548,Pe=v.__chunk_6914,Te=v.__chunk_7960,Ae=v.__chunk_5996,Ce=v.__chunk_4337,u=ae(h,h,h),Fe=u.__chunk_5405,Ie=u.__chunk_7322,$e=u.__chunk_5276,Me=u.__chunk_5577,Ue=u.__chunk_3039,qe=u.__chunk_9573,De=u.__chunk_7701,Le=u.__chunk_662,Be=u.__chunk_4101,Ke=u.__chunk_6776,Xe=u.__chunk_8042,ze=u.__chunk_3665,Ge=u.__chunk_7444,He=u.__chunk_4591,Je=u.__chunk_6991,We=u.__chunk_8816,Ve=u.__chunk_6631,Ye=u.__chunk_4828,Qe=u.__chunk_828,Ze=u.__chunk_5927,et=u.__chunk_6202,tt=u.__chunk_6947,nt=u.__chunk_4363,_t=u.__chunk_8264,st=u.__chunk_1583,at=u.__chunk_9985,rt=u.__chunk_4155,ot=u.__chunk_7908,ct=u.__chunk_8949,ut=u.__chunk_796,it=u.__chunk_1651,dt=u.__chunk_5105,pt=u.__chunk_9642,kt=u.__chunk_8819,ht=u.__chunk_676,J=re(h,h,h),gt=J.__NEXT_FONT_MANIFEST,lt=J.__REACT_LOADABLE_MANIFEST,Nt=((p,g,C)=>(g._ENTRIES={},p.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/fd9d1056-dcba7f094ce3d609.js","static/chunks/30-b50f13889648ea77.js","static/chunks/main-app-17503da640fcbefb.js"],pages:{"/_app":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-cd26d40301e263df.js","static/chunks/pages/_app-72b849fbd24ac258.js"],"/_error":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-cd26d40301e263df.js","static/chunks/pages/_error-7ba65e1336b92748.js"]},ampFirstPages:[]},p.__BUILD_MANIFEST.lowPriorityFiles=["/static/YcCdT5nboS_5lNSC1gVhr/_buildManifest.js",,"/static/YcCdT5nboS_5lNSC1gVhr/_ssgManifest.js"],p.__REACT_LOADABLE_MANIFEST=lt,p.__NEXT_FONT_MANIFEST=gt,p.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var y={},b={};function o(s){var d=b[s];if(d!==void 0)return d.exports;var k=b[s]={exports:{}},E=!0;try{y[s](k,k.exports,o),E=!1}finally{E&&delete b[s]}return k.exports}o.m=y,o.amdO={},(()=>{var s=[];o.O=(d,k,E,j)=>{if(k){j=j||0;for(var l=s.length;l>0&&s[l-1][2]>j;l--)s[l]=s[l-1];s[l]=[k,E,j];return}for(var _=1/0,l=0;l<s.length;l++){for(var[k,E,j]=s[l],w=!0,m=0;m<k.length;m++)_>=j&&Object.keys(o.O).every(F=>o.O[F](k[m]))?k.splice(m--,1):(w=!1,j<_&&(_=j));if(w){s.splice(l--,1);var x=E();x!==void 0&&(d=x)}}return d}})(),o.n=s=>{var d=s&&s.__esModule?()=>s.default:()=>s;return o.d(d,{a:d}),d},o.d=(s,d)=>{for(var k in d)o.o(d,k)&&!o.o(s,k)&&Object.defineProperty(s,k,{enumerable:!0,get:d[k]})},o.e=()=>Promise.resolve(),o.g=function(){if(typeof g=="object")return g;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),o.o=(s,d)=>Object.prototype.hasOwnProperty.call(s,d),o.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},(()=>{var s={993:0};o.O.j=E=>s[E]===0;var d=(E,j)=>{var l,_,[w,m,x]=j,R=0;if(w.some(T=>s[T]!==0)){for(l in m)o.o(m,l)&&(o.m[l]=m[l]);if(x)var P=x(o)}for(E&&E(j);R<w.length;R++)_=w[R],o.o(s,_)&&s[_]&&s[_][0](),s[_]=0;return o.O(P)},k=p.webpackChunk_N_E=p.webpackChunk_N_E||[];k.forEach(d.bind(null,0)),k.push=d.bind(null,k.push.bind(k))})()})(),(p.webpackChunk_N_E=p.webpackChunk_N_E||[]).push([[241],{676:ht,8819:kt,9642:pt,5105:dt,1651:it,796:ut,8949:ct,7908:ot,4155:rt,9985:at,1583:st,8264:_t,4363:nt,6947:tt,6202:et,5927:Ze,828:Qe,4828:Ye,6631:Ve,8816:We,6991:Je,4591:He,7444:Ge,3665:ze,8042:Xe,6776:Ke,4101:Be,662:Le,7701:De,9573:qe,3039:Ue,5577:Me,1959:me,5276:$e,5228:fe,5303:le,7322:Ie,5558:ge,5405:Fe}]),(p.webpackChunk_N_E=p.webpackChunk_N_E||[]).push([[805],{4337:Ce,5996:Ae,7960:Te,6914:Pe,9548:Re,5028:Se,2039:Oe,2988:Ne,2561:we,581:ve,932:je,1863:Ee,7037:be,3818:ye,1730:xe}]),(p.webpackChunk_N_E=p.webpackChunk_N_E||[]).push([[475],{2067:he,6195:ke,9696:(y,b,o)=>{"use strict";o.r(b),o.d(b,{ComponentMod:()=>n,default:()=>i});var s={};o.r(s),o.d(s,{GET:()=>D,POST:()=>F,runtime:()=>R});var d={};o.r(d),o.d(d,{originalPathname:()=>O,patchFetch:()=>q,requestAsyncStorage:()=>L,routeModule:()=>I,serverHooks:()=>U,staticGenerationAsyncStorage:()=>M});var k=o(932),E=o(2561),j=o(4828),l=o(6631),_=o(9985),w=o(5822),m=o(4306),x=o(3326);let R="edge",P=process.env.SYNC_SECRET||"onde-sync-2026";function T(a){return a.headers.get("Authorization")===`Bearer ${P}`}async function D(a){if(!T(a))return _.xk.json({error:"Unauthorized"},{status:401});try{let{env:r}=(0,w.getRequestContext)(),c=r.DB;if(!c)return _.xk.json({error:"Database not available"},{status:500});let e=await(0,m.PI)(c);return _.xk.json({success:!0,posts:e,timestamp:new Date().toISOString()})}catch(r){return console.error("Sync GET error:",r),_.xk.json({error:"Sync failed"},{status:500})}}async function F(a){if(!T(a))return _.xk.json({error:"Unauthorized"},{status:401});try{let{env:r}=(0,w.getRequestContext)(),c=r.DB;if(!c)return _.xk.json({error:"Database not available"},{status:500});let e=await a.json();switch(e.action){case"add_post":{let t=await(0,m.JC)(c,{account:e.account,content:e.content,status:e.status||"pending",scheduled_for:e.scheduled_for,media_files:e.media_files,source:e.source||"telegram"});return _.xk.json({success:!0,post:t})}case"mark_posted":{let t=await(0,m.sy)(c,e.post_id,e.post_url);return _.xk.json({success:t,message:t?"Post marked as posted":"Failed to update post"})}case"batch_sync":{let t=[];for(let f of e.posts){let N=await(0,m.JC)(c,{account:f.account,content:f.content||f.text,status:f.status||"pending",scheduled_for:f.scheduled_for,media_files:f.media_files||f.mediaFiles,source:f.source||"telegram"});t.push(N)}return _.xk.json({success:!0,synced:t.length,posts:t})}case"approve_post":{if(!e.post_id)return _.xk.json({error:"post_id is required"},{status:400});let t=await(0,m.sb)(c,e.post_id);return _.xk.json({success:t,message:t?"Post approved":"Failed to approve post"})}case"reject_post":{if(!e.post_id)return _.xk.json({error:"post_id is required"},{status:400});let t=await(0,m.SX)(c,e.post_id);return _.xk.json({success:t,message:t?"Post rejected":"Failed to reject post"})}case"get_tasks":{let t={};e.status?t.status=e.status:t.status=["pending","claimed","in_progress"],e.type&&(t.type=e.type),e.assigned_to&&(t.assigned_to=e.assigned_to),e.limit&&(t.limit=e.limit);let f=await(0,x.xT)(c,t);return _.xk.json({success:!0,tasks:f,count:f.length})}case"get_next_task":{let t=await(0,x.BL)(c,e.agent_name,e.type);return _.xk.json({success:!0,task:t})}case"claim_task":{if(!e.task_id||!e.agent_name)return _.xk.json({error:"task_id and agent_name are required"},{status:400});let t=await(0,x.$)(c,e.task_id,e.agent_name);return _.xk.json({success:t,message:t?"Task claimed":"Failed to claim task (may already be claimed)"})}case"start_task":{if(!e.task_id)return _.xk.json({error:"task_id is required"},{status:400});let t=await(0,x.Rr)(c,e.task_id);return _.xk.json({success:t,message:t?"Task started":"Failed to start task"})}case"complete_task":{if(!e.task_id||!e.result)return _.xk.json({error:"task_id and result are required"},{status:400});let t=await(0,x.Xw)(c,e.task_id,e.result);return _.xk.json({success:t,message:t?"Task completed":"Failed to complete task"})}case"fail_task":{if(!e.task_id||!e.error)return _.xk.json({error:"task_id and error are required"},{status:400});let t=await(0,x.zf)(c,e.task_id,e.error);return _.xk.json({success:t,message:t?"Task marked as failed":"Failed to update task"})}case"create_task":{if(!e.type||!e.description)return _.xk.json({error:"type and description are required"},{status:400});let t=await(0,x.n5)(c,{type:e.type,description:e.description,target_id:e.target_id,target_type:e.target_type,payload:e.payload?JSON.stringify(e.payload):void 0,priority:e.priority||"normal",assigned_to:e.assigned_to,source_agent:e.source_agent,source_dashboard:e.source_dashboard,due_at:e.due_at,metadata:e.metadata?JSON.stringify(e.metadata):void 0,created_by:e.created_by||"agent"});return _.xk.json({success:!!t,task:t})}case"get_agents":{let t=await(0,x.rL)(c);return _.xk.json({success:!0,agents:t,count:t.length})}case"register_agent":{if(!e.agent_id||!e.agent_name||!e.agent_type)return _.xk.json({error:"agent_id, agent_name, and agent_type are required"},{status:400});let t=await(0,x.VC)(c,{id:e.agent_id,name:e.agent_name,type:e.agent_type,description:e.description,capabilities:e.capabilities?JSON.stringify(e.capabilities):void 0,status:e.status||"active"});return _.xk.json({success:!!t,agent:t})}case"agent_heartbeat":{if(!e.agent_id)return _.xk.json({error:"agent_id is required"},{status:400});let t=await(0,x.zd)(c,e.agent_id);return _.xk.json({success:t,message:t?"Heartbeat recorded":"Agent not found"})}default:return _.xk.json({error:"Unknown action"},{status:400})}}catch(r){return console.error("Sync POST error:",r),_.xk.json({error:"Sync failed"},{status:500})}}let I=new E.AppRouteRouteModule({definition:{kind:j.x.APP_ROUTE,page:"/api/sync/route",pathname:"/api/sync",filename:"route",bundlePath:"app/api/sync/route"},resolvedPagePath:"/Users/mattiapetrucciani/CascadeProjects/Onde/apps/surfboard/src/app/api/sync/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:L,staticGenerationAsyncStorage:M,serverHooks:U}=I,O="/api/sync/route";function q(){return(0,l.XH)({serverHooks:U,staticGenerationAsyncStorage:M})}let n=d,i=k.a.wrap(I)},7185:ce,3326:pe,4306:ie,5822:oe},y=>{var b=s=>y(y.s=s);y.O(0,[241,805],()=>b(9696));var o=y.O();(g._ENTRIES=typeof g._ENTRIES>"u"?{}:g._ENTRIES)["middleware_app/api/sync/route"]=o}]),function(){let y={exports:{},loaded:!1};return function(o,s){"use strict";var d=Object.defineProperty,k=Object.getOwnPropertyDescriptor,E=Object.getOwnPropertyNames,j=Object.prototype.hasOwnProperty,l=(n,i)=>{for(var a in i)d(n,a,{get:i[a],enumerable:!0})},_=(n,i,a,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of E(i))!j.call(n,c)&&c!==a&&d(n,c,{get:()=>i[c],enumerable:!(r=k(i,c))||r.enumerable});return n},w=n=>_(d({},"__esModule",{value:!0}),n),m={};l(m,{default:()=>U}),o.exports=w(m);var x=(G(),Z($)),R="@next/request-context",P=Symbol.for(R),T=Symbol.for("internal.storage");function D(){let n=g;if(!n[P]){let i=new x.AsyncLocalStorage,a={get:()=>i.getStore(),[T]:i};n[P]=a}return n[P]}var F=D();function I(n,i){return F[T].run(n,i)}function L(n){let i={};return n&&n.forEach((a,r)=>{i[r]=a,r.toLowerCase()==="set-cookie"&&(i[r]=M(a))}),i}function M(n){let i=[],a=0,r,c,e,t,f;function N(){for(;a<n.length&&/\s/.test(n.charAt(a));)a+=1;return a<n.length}function S(){return c=n.charAt(a),c!=="="&&c!==";"&&c!==","}for(;a<n.length;){for(r=a,f=!1;N();)if(c=n.charAt(a),c===","){for(e=a,a+=1,N(),t=a;a<n.length&&S();)a+=1;a<n.length&&n.charAt(a)==="="?(f=!0,a=t,i.push(n.substring(r,e)),r=a):a=e+1}else a+=1;(!f||a>=n.length)&&i.push(n.substring(r,n.length))}return i}function U(n){let i=n.staticRoutes.map(r=>({regexp:new RegExp(r.namedRegex),page:r.page})),a=n.dynamicRoutes?.map(r=>({regexp:new RegExp(r.namedRegex),page:r.page}))||[];return async function(r,c){let e=new URL(r.url).pathname,t={};if(n.nextConfig?.basePath&&e.startsWith(n.nextConfig.basePath)&&(e=e.replace(n.nextConfig.basePath,"")||"/"),n.nextConfig?.i18n)for(let N of n.nextConfig.i18n.locales){let S=new RegExp(`^/${N}($|/)`,"i");if(e.match(S)){e=e.replace(S,"/")||"/";break}}for(let N of i)if(N.regexp.exec(e)){t.name=N.page;break}if(!t.name){let N=q(e);for(let S of a||[]){if(N&&!q(S.page))continue;let X=S.regexp.exec(e);if(X){t={name:S.page,params:X.groups};break}}}let f=await I({waitUntil:c.waitUntil},()=>g._ENTRIES[`middleware_${n.name}`].default.call({},{request:{url:r.url,method:r.method,headers:L(r.headers),ip:O(r.headers,"x-real-ip"),geo:{city:O(r.headers,"x-vercel-ip-city",!0),country:O(r.headers,"x-vercel-ip-country",!0),latitude:O(r.headers,"x-vercel-ip-latitude"),longitude:O(r.headers,"x-vercel-ip-longitude"),region:O(r.headers,"x-vercel-ip-country-region",!0)},nextConfig:n.nextConfig,page:t,body:r.body}}));return f.waitUntil&&c.waitUntil(f.waitUntil),f.response}}function O(n,i,a=!1){let r=n.get(i)||void 0;return a&&r?decodeURIComponent(r):r}function q(n){return n==="/api"||n.startsWith("/api/")}}(y,y.exports),y.exports}.call({}).default({name:"app/api/sync/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/coming-soon",regex:"^/coming\\-soon(?:/)?$",routeKeys:{},namedRegex:"^/coming\\-soon(?:/)?$"},{page:"/corde",regex:"^/corde(?:/)?$",routeKeys:{},namedRegex:"^/corde(?:/)?$"},{page:"/frh",regex:"^/frh(?:/)?$",routeKeys:{},namedRegex:"^/frh(?:/)?$"},{page:"/login",regex:"^/login(?:/)?$",routeKeys:{},namedRegex:"^/login(?:/)?$"},{page:"/social",regex:"^/social(?:/)?$",routeKeys:{},namedRegex:"^/social(?:/)?$"}],dynamicRoutes:[{page:"/api/agent-tasks/[id]",regex:"^/api/agent\\-tasks/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/agent\\-tasks/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"}],nextConfig:{basePath:""}})))(h,h,h);export{Nt as default};
