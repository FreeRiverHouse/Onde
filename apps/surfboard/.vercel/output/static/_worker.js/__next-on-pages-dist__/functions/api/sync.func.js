var z=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Y=Object.prototype.hasOwnProperty;var Q=(d,g)=>()=>(d&&(g=d(d=0)),g);var K=(d,g,C,y)=>{if(g&&typeof g=="object"||typeof g=="function")for(let b of V(g))!Y.call(d,b)&&b!==C&&z(d,b,{get:()=>g[b],enumerable:!(y=W(g,b))||y.enumerable});return d},B=(d,g,C)=>(K(d,g,"default"),C&&K(C,g,"default"));var Z=d=>K(z({},"__esModule",{value:!0}),d);var I={};import*as xt from"async_hooks";var G=Q(()=>{B(I,xt)});import{__getNamedExports as ee}from"../../../__next-on-pages-dist__/webpack/562f1929e61c51936b027740cd20d5f9.js";import{__getNamedExports as te}from"../../../__next-on-pages-dist__/webpack/4306.js";import{__getNamedExports as ne}from"../../../__next-on-pages-dist__/webpack/3326.js";import{__getNamedExports as se}from"../../../__next-on-pages-dist__/webpack/d6830180ae0f03b84fd7a5e7248c5aa2.js";import{__getNamedExports as ae}from"../../../__next-on-pages-dist__/webpack/d2550da8fc2781985fea0b1c0d3097c7.js";import{__getNamedExports as _e}from"../../../__next-on-pages-dist__/webpack/030bd997c35875172fa1ffa5b8a901e4.js";import{__getNamedExports as re}from"../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var h=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/sync"),H=ee(h,h,h),oe=H.__chunk_5822,ce=H.__chunk_7185,ue=te(h,h,h),ie=ue.__chunk_4306,pe=ne(h,h,h),de=pe.__chunk_3326,A=se(h,h,h),ke=A.__chunk_6195,he=A.__chunk_2067,ge=A.__chunk_5558,le=A.__chunk_5303,fe=A.__chunk_5228,xe=A.__chunk_1959,v=ae(h,h,h),me=v.__chunk_1730,ye=v.__chunk_3818,be=v.__chunk_7037,Ee=v.__chunk_1863,je=v.__chunk_932,ve=v.__chunk_581,we=v.__chunk_2561,Ne=v.__chunk_2988,Oe=v.__chunk_2039,Pe=v.__chunk_5028,Re=v.__chunk_9548,Se=v.__chunk_6914,Te=v.__chunk_7960,Ae=v.__chunk_5996,Ce=v.__chunk_4337,u=_e(h,h,h),$e=u.__chunk_5405,Fe=u.__chunk_7322,Ie=u.__chunk_5276,Me=u.__chunk_5577,Ue=u.__chunk_3039,qe=u.__chunk_9573,De=u.__chunk_7701,Le=u.__chunk_662,Ke=u.__chunk_4101,Be=u.__chunk_6776,Xe=u.__chunk_8042,ze=u.__chunk_3665,Ge=u.__chunk_7444,He=u.__chunk_4591,Je=u.__chunk_6991,We=u.__chunk_8816,Ve=u.__chunk_6631,Ye=u.__chunk_4828,Qe=u.__chunk_828,Ze=u.__chunk_5927,et=u.__chunk_6202,tt=u.__chunk_6947,nt=u.__chunk_4363,st=u.__chunk_8264,at=u.__chunk_1583,_t=u.__chunk_9985,rt=u.__chunk_4155,ot=u.__chunk_7908,ct=u.__chunk_8949,ut=u.__chunk_796,it=u.__chunk_1651,pt=u.__chunk_5105,dt=u.__chunk_9642,kt=u.__chunk_8819,ht=u.__chunk_676,J=re(h,h,h),gt=J.__NEXT_FONT_MANIFEST,lt=J.__REACT_LOADABLE_MANIFEST,Nt=((d,g,C)=>(g._ENTRIES={},d.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/fd9d1056-dcba7f094ce3d609.js","static/chunks/30-b50f13889648ea77.js","static/chunks/main-app-17503da640fcbefb.js"],pages:{"/_app":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-dc5c0cdb2c2c0bdb.js","static/chunks/pages/_app-72b849fbd24ac258.js"],"/_error":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-dc5c0cdb2c2c0bdb.js","static/chunks/pages/_error-7ba65e1336b92748.js"]},ampFirstPages:[]},d.__BUILD_MANIFEST.lowPriorityFiles=["/static/FQBh2Ar4Fsg4ZG1NC9Wb7/_buildManifest.js",,"/static/FQBh2Ar4Fsg4ZG1NC9Wb7/_ssgManifest.js"],d.__REACT_LOADABLE_MANIFEST=lt,d.__NEXT_FONT_MANIFEST=gt,d.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var y={},b={};function o(a){var p=b[a];if(p!==void 0)return p.exports;var k=b[a]={exports:{}},E=!0;try{y[a](k,k.exports,o),E=!1}finally{E&&delete b[a]}return k.exports}o.m=y,o.amdO={},(()=>{var a=[];o.O=(p,k,E,j)=>{if(k){j=j||0;for(var l=a.length;l>0&&a[l-1][2]>j;l--)a[l]=a[l-1];a[l]=[k,E,j];return}for(var s=1/0,l=0;l<a.length;l++){for(var[k,E,j]=a[l],w=!0,x=0;x<k.length;x++)s>=j&&Object.keys(o.O).every($=>o.O[$](k[x]))?k.splice(x--,1):(w=!1,j<s&&(s=j));if(w){a.splice(l--,1);var m=E();m!==void 0&&(p=m)}}return p}})(),o.n=a=>{var p=a&&a.__esModule?()=>a.default:()=>a;return o.d(p,{a:p}),p},o.d=(a,p)=>{for(var k in p)o.o(p,k)&&!o.o(a,k)&&Object.defineProperty(a,k,{enumerable:!0,get:p[k]})},o.e=()=>Promise.resolve(),o.g=function(){if(typeof g=="object")return g;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),o.o=(a,p)=>Object.prototype.hasOwnProperty.call(a,p),o.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},(()=>{var a={993:0};o.O.j=E=>a[E]===0;var p=(E,j)=>{var l,s,[w,x,m]=j,R=0;if(w.some(T=>a[T]!==0)){for(l in x)o.o(x,l)&&(o.m[l]=x[l]);if(m)var S=m(o)}for(E&&E(j);R<w.length;R++)s=w[R],o.o(a,s)&&a[s]&&a[s][0](),a[s]=0;return o.O(S)},k=d.webpackChunk_N_E=d.webpackChunk_N_E||[];k.forEach(p.bind(null,0)),k.push=p.bind(null,k.push.bind(k))})()})(),(d.webpackChunk_N_E=d.webpackChunk_N_E||[]).push([[241],{676:ht,8819:kt,9642:dt,5105:pt,1651:it,796:ut,8949:ct,7908:ot,4155:rt,9985:_t,1583:at,8264:st,4363:nt,6947:tt,6202:et,5927:Ze,828:Qe,4828:Ye,6631:Ve,8816:We,6991:Je,4591:He,7444:Ge,3665:ze,8042:Xe,6776:Be,4101:Ke,662:Le,7701:De,9573:qe,3039:Ue,5577:Me,1959:xe,5276:Ie,5228:fe,5303:le,7322:Fe,5558:ge,5405:$e}]),(d.webpackChunk_N_E=d.webpackChunk_N_E||[]).push([[805],{4337:Ce,5996:Ae,7960:Te,6914:Se,9548:Re,5028:Pe,2039:Oe,2988:Ne,2561:we,581:ve,932:je,1863:Ee,7037:be,3818:ye,1730:me}]),(d.webpackChunk_N_E=d.webpackChunk_N_E||[]).push([[475],{2067:he,6195:ke,9696:(y,b,o)=>{"use strict";o.r(b),o.d(b,{ComponentMod:()=>n,default:()=>i});var a={};o.r(a),o.d(a,{GET:()=>D,POST:()=>$,runtime:()=>R});var p={};o.r(p),o.d(p,{originalPathname:()=>O,patchFetch:()=>q,requestAsyncStorage:()=>L,routeModule:()=>F,serverHooks:()=>U,staticGenerationAsyncStorage:()=>M});var k=o(932),E=o(2561),j=o(4828),l=o(6631),s=o(9985),w=o(5822),x=o(4306),m=o(3326);let R="edge",S=process.env.SYNC_SECRET||"onde-sync-2026";function T(_){return _.headers.get("Authorization")===`Bearer ${S}`}async function D(_){if(!T(_))return s.xk.json({error:"Unauthorized"},{status:401});try{let{env:r}=(0,w.getRequestContext)(),c=r.DB;if(!c)return s.xk.json({error:"Database not available"},{status:500});let e=await(0,x.PI)(c);return s.xk.json({success:!0,posts:e,timestamp:new Date().toISOString()})}catch(r){return console.error("Sync GET error:",r),s.xk.json({error:"Sync failed"},{status:500})}}async function $(_){if(!T(_))return s.xk.json({error:"Unauthorized"},{status:401});try{let{env:r}=(0,w.getRequestContext)(),c=r.DB;if(!c)return s.xk.json({error:"Database not available"},{status:500});let e=await _.json();switch(e.action){case"add_post":{let t=await(0,x.JC)(c,{account:e.account,content:e.content,status:e.status||"pending",scheduled_for:e.scheduled_for,media_files:e.media_files,source:e.source||"telegram"});return s.xk.json({success:!0,post:t})}case"mark_posted":{let t=await(0,x.sy)(c,e.post_id,e.post_url);return s.xk.json({success:t,message:t?"Post marked as posted":"Failed to update post"})}case"batch_sync":{let t=[];for(let f of e.posts){let N=await(0,x.JC)(c,{account:f.account,content:f.content||f.text,status:f.status||"pending",scheduled_for:f.scheduled_for,media_files:f.media_files||f.mediaFiles,source:f.source||"telegram"});t.push(N)}return s.xk.json({success:!0,synced:t.length,posts:t})}case"approve_post":{if(!e.post_id)return s.xk.json({error:"post_id is required"},{status:400});let t=await(0,x.sb)(c,e.post_id);return s.xk.json({success:t,message:t?"Post approved":"Failed to approve post"})}case"reject_post":{if(!e.post_id)return s.xk.json({error:"post_id is required"},{status:400});let t=await(0,x.SX)(c,e.post_id);return s.xk.json({success:t,message:t?"Post rejected":"Failed to reject post"})}case"get_tasks":{let t={};e.status?t.status=e.status:t.status=["pending","claimed","in_progress"],e.type&&(t.type=e.type),e.assigned_to&&(t.assigned_to=e.assigned_to),e.limit&&(t.limit=e.limit);let f=await(0,m.xT)(c,t);return s.xk.json({success:!0,tasks:f,count:f.length})}case"get_next_task":{let t=await(0,m.BL)(c,e.agent_name,e.type);return s.xk.json({success:!0,task:t})}case"claim_task":{if(!e.task_id||!e.agent_name)return s.xk.json({error:"task_id and agent_name are required"},{status:400});let t=await(0,m.$)(c,e.task_id,e.agent_name);return s.xk.json({success:t,message:t?"Task claimed":"Failed to claim task (may already be claimed)"})}case"start_task":{if(!e.task_id)return s.xk.json({error:"task_id is required"},{status:400});let t=await(0,m.Rr)(c,e.task_id);return s.xk.json({success:t,message:t?"Task started":"Failed to start task"})}case"complete_task":{if(!e.task_id||!e.result)return s.xk.json({error:"task_id and result are required"},{status:400});let t=await(0,m.Xw)(c,e.task_id,e.result);return s.xk.json({success:t,message:t?"Task completed":"Failed to complete task"})}case"fail_task":{if(!e.task_id||!e.error)return s.xk.json({error:"task_id and error are required"},{status:400});let t=await(0,m.zf)(c,e.task_id,e.error);return s.xk.json({success:t,message:t?"Task marked as failed":"Failed to update task"})}case"create_task":{if(!e.type||!e.description)return s.xk.json({error:"type and description are required"},{status:400});let t=await(0,m.n5)(c,{type:e.type,description:e.description,target_id:e.target_id,target_type:e.target_type,payload:e.payload?JSON.stringify(e.payload):void 0,priority:e.priority||"normal",assigned_to:e.assigned_to,source_agent:e.source_agent,source_dashboard:e.source_dashboard,due_at:e.due_at,metadata:e.metadata?JSON.stringify(e.metadata):void 0,created_by:e.created_by||"agent"});return s.xk.json({success:!!t,task:t})}case"get_agents":{let t=await(0,m.rL)(c);return s.xk.json({success:!0,agents:t,count:t.length})}case"register_agent":{if(!e.agent_id||!e.agent_name||!e.agent_type)return s.xk.json({error:"agent_id, agent_name, and agent_type are required"},{status:400});let t=await(0,m.VC)(c,{id:e.agent_id,name:e.agent_name,type:e.agent_type,description:e.description,capabilities:e.capabilities?JSON.stringify(e.capabilities):void 0,status:e.status||"active"});return s.xk.json({success:!!t,agent:t})}case"agent_heartbeat":{if(!e.agent_id)return s.xk.json({error:"agent_id is required"},{status:400});let t=await(0,m.zd)(c,e.agent_id);return s.xk.json({success:t,message:t?"Heartbeat recorded":"Agent not found"})}default:return s.xk.json({error:"Unknown action"},{status:400})}}catch(r){return console.error("Sync POST error:",r),s.xk.json({error:"Sync failed"},{status:500})}}let F=new E.AppRouteRouteModule({definition:{kind:j.x.APP_ROUTE,page:"/api/sync/route",pathname:"/api/sync",filename:"route",bundlePath:"app/api/sync/route"},resolvedPagePath:"/Users/mattiapetrucciani/CascadeProjects/Onde/apps/surfboard/src/app/api/sync/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:L,staticGenerationAsyncStorage:M,serverHooks:U}=F,O="/api/sync/route";function q(){return(0,l.XH)({serverHooks:U,staticGenerationAsyncStorage:M})}let n=p,i=k.a.wrap(F)},7185:ce,3326:de,4306:ie,5822:oe},y=>{var b=a=>y(y.s=a);y.O(0,[241,805],()=>b(9696));var o=y.O();(g._ENTRIES=typeof g._ENTRIES>"u"?{}:g._ENTRIES)["middleware_app/api/sync/route"]=o}]),function(){let y={exports:{},loaded:!1};return function(o,a){"use strict";var p=Object.defineProperty,k=Object.getOwnPropertyDescriptor,E=Object.getOwnPropertyNames,j=Object.prototype.hasOwnProperty,l=(n,i)=>{for(var _ in i)p(n,_,{get:i[_],enumerable:!0})},s=(n,i,_,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of E(i))!j.call(n,c)&&c!==_&&p(n,c,{get:()=>i[c],enumerable:!(r=k(i,c))||r.enumerable});return n},w=n=>s(p({},"__esModule",{value:!0}),n),x={};l(x,{default:()=>U}),o.exports=w(x);var m=(G(),Z(I)),R="@next/request-context",S=Symbol.for(R),T=Symbol.for("internal.storage");function D(){let n=g;if(!n[S]){let i=new m.AsyncLocalStorage,_={get:()=>i.getStore(),[T]:i};n[S]=_}return n[S]}var $=D();function F(n,i){return $[T].run(n,i)}function L(n){let i={};return n&&n.forEach((_,r)=>{i[r]=_,r.toLowerCase()==="set-cookie"&&(i[r]=M(_))}),i}function M(n){let i=[],_=0,r,c,e,t,f;function N(){for(;_<n.length&&/\s/.test(n.charAt(_));)_+=1;return _<n.length}function P(){return c=n.charAt(_),c!=="="&&c!==";"&&c!==","}for(;_<n.length;){for(r=_,f=!1;N();)if(c=n.charAt(_),c===","){for(e=_,_+=1,N(),t=_;_<n.length&&P();)_+=1;_<n.length&&n.charAt(_)==="="?(f=!0,_=t,i.push(n.substring(r,e)),r=_):_=e+1}else _+=1;(!f||_>=n.length)&&i.push(n.substring(r,n.length))}return i}function U(n){let i=n.staticRoutes.map(r=>({regexp:new RegExp(r.namedRegex),page:r.page})),_=n.dynamicRoutes?.map(r=>({regexp:new RegExp(r.namedRegex),page:r.page}))||[];return async function(r,c){let e=new URL(r.url).pathname,t={};if(n.nextConfig?.basePath&&e.startsWith(n.nextConfig.basePath)&&(e=e.replace(n.nextConfig.basePath,"")||"/"),n.nextConfig?.i18n)for(let N of n.nextConfig.i18n.locales){let P=new RegExp(`^/${N}($|/)`,"i");if(e.match(P)){e=e.replace(P,"/")||"/";break}}for(let N of i)if(N.regexp.exec(e)){t.name=N.page;break}if(!t.name){let N=q(e);for(let P of _||[]){if(N&&!q(P.page))continue;let X=P.regexp.exec(e);if(X){t={name:P.page,params:X.groups};break}}}let f=await F({waitUntil:c.waitUntil},()=>g._ENTRIES[`middleware_${n.name}`].default.call({},{request:{url:r.url,method:r.method,headers:L(r.headers),ip:O(r.headers,"x-real-ip"),geo:{city:O(r.headers,"x-vercel-ip-city",!0),country:O(r.headers,"x-vercel-ip-country",!0),latitude:O(r.headers,"x-vercel-ip-latitude"),longitude:O(r.headers,"x-vercel-ip-longitude"),region:O(r.headers,"x-vercel-ip-country-region",!0)},nextConfig:n.nextConfig,page:t,body:r.body}}));return f.waitUntil&&c.waitUntil(f.waitUntil),f.response}}function O(n,i,_=!1){let r=n.get(i)||void 0;return _&&r?decodeURIComponent(r):r}function q(n){return n==="/api"||n.startsWith("/api/")}}(y,y.exports),y.exports}.call({}).default({name:"app/api/sync/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/coming-soon",regex:"^/coming\\-soon(?:/)?$",routeKeys:{},namedRegex:"^/coming\\-soon(?:/)?$"},{page:"/corde",regex:"^/corde(?:/)?$",routeKeys:{},namedRegex:"^/corde(?:/)?$"},{page:"/frh",regex:"^/frh(?:/)?$",routeKeys:{},namedRegex:"^/frh(?:/)?$"},{page:"/house",regex:"^/house(?:/)?$",routeKeys:{},namedRegex:"^/house(?:/)?$"},{page:"/login",regex:"^/login(?:/)?$",routeKeys:{},namedRegex:"^/login(?:/)?$"},{page:"/pr",regex:"^/pr(?:/)?$",routeKeys:{},namedRegex:"^/pr(?:/)?$"},{page:"/social",regex:"^/social(?:/)?$",routeKeys:{},namedRegex:"^/social(?:/)?$"}],dynamicRoutes:[{page:"/api/agent-tasks/[id]",regex:"^/api/agent\\-tasks/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/agent\\-tasks/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/pr/posts/[id]/approve",regex:"^/api/pr/posts/([^/]+?)/approve(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/pr/posts/(?<nxtPid>[^/]+?)/approve(?:/)?$"},{page:"/api/pr/posts/[id]/feedback",regex:"^/api/pr/posts/([^/]+?)/feedback(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/pr/posts/(?<nxtPid>[^/]+?)/feedback(?:/)?$"}],nextConfig:{basePath:""}})))(h,h,h);export{Nt as default};
