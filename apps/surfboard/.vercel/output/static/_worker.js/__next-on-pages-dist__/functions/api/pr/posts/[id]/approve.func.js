var X=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var Y=(s,p)=>()=>(s&&(p=s(s=0)),p);var B=(s,p,C,g)=>{if(p&&typeof p=="object"||typeof p=="function")for(let f of z(p))!Q.call(s,f)&&f!==C&&X(s,f,{get:()=>p[f],enumerable:!(g=V(p,f))||g.enumerable});return s},q=(s,p,C)=>(B(s,p,"default"),C&&B(C,p,"default"));var Z=s=>B(X({},"__esModule",{value:!0}),s);var F={};import*as ht from"async_hooks";var W=Y(()=>{q(F,ht)});import{__getNamedExports as ee}from"../../../../../../__next-on-pages-dist__/webpack/562f1929e61c51936b027740cd20d5f9.js";import{__getNamedExports as te}from"../../../../../../__next-on-pages-dist__/webpack/d6830180ae0f03b84fd7a5e7248c5aa2.js";import{__getNamedExports as ne}from"../../../../../../__next-on-pages-dist__/webpack/d2550da8fc2781985fea0b1c0d3097c7.js";import{__getNamedExports as _e}from"../../../../../../__next-on-pages-dist__/webpack/030bd997c35875172fa1ffa5b8a901e4.js";import{__getNamedExports as oe}from"../../../../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var h=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/pr/posts/[id]/approve"),G=ee(h,h,h),re=G.__chunk_5822,ae=G.__chunk_7185,$=te(h,h,h),ce=$.__chunk_6195,se=$.__chunk_2067,ue=$.__chunk_5558,pe=$.__chunk_5303,ie=$.__chunk_5228,he=$.__chunk_1959,m=ne(h,h,h),de=m.__chunk_1730,ke=m.__chunk_3818,ge=m.__chunk_7037,fe=m.__chunk_1863,le=m.__chunk_932,xe=m.__chunk_581,me=m.__chunk_2561,be=m.__chunk_2988,Ee=m.__chunk_2039,ve=m.__chunk_5028,ye=m.__chunk_9548,Ne=m.__chunk_6914,Re=m.__chunk_7960,we=m.__chunk_5996,Pe=m.__chunk_4337,r=_e(h,h,h),Oe=r.__chunk_5405,Se=r.__chunk_7322,je=r.__chunk_5276,Te=r.__chunk_5577,Ae=r.__chunk_3039,$e=r.__chunk_9573,Ce=r.__chunk_7701,Ie=r.__chunk_662,Fe=r.__chunk_4101,Me=r.__chunk_6776,Ue=r.__chunk_8042,Le=r.__chunk_3665,De=r.__chunk_7444,Ke=r.__chunk_4591,Be=r.__chunk_6991,qe=r.__chunk_8816,He=r.__chunk_6631,Xe=r.__chunk_4828,We=r.__chunk_828,Ge=r.__chunk_5927,Je=r.__chunk_6202,Ve=r.__chunk_6947,ze=r.__chunk_4363,Qe=r.__chunk_8264,Ye=r.__chunk_1583,Ze=r.__chunk_9985,et=r.__chunk_4155,tt=r.__chunk_7908,nt=r.__chunk_8949,_t=r.__chunk_796,ot=r.__chunk_1651,rt=r.__chunk_5105,at=r.__chunk_9642,ct=r.__chunk_8819,st=r.__chunk_676,J=oe(h,h,h),ut=J.__NEXT_FONT_MANIFEST,pt=J.__REACT_LOADABLE_MANIFEST,xt=((s,p,C)=>(p._ENTRIES={},s.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/fd9d1056-dcba7f094ce3d609.js","static/chunks/30-b50f13889648ea77.js","static/chunks/main-app-17503da640fcbefb.js"],pages:{"/_app":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-dc5c0cdb2c2c0bdb.js","static/chunks/pages/_app-72b849fbd24ac258.js"],"/_error":["static/chunks/webpack-a3c37fcbf859f6f9.js","static/chunks/framework-3664cab31236a9fa.js","static/chunks/main-dc5c0cdb2c2c0bdb.js","static/chunks/pages/_error-7ba65e1336b92748.js"]},ampFirstPages:[]},s.__BUILD_MANIFEST.lowPriorityFiles=["/static/FQBh2Ar4Fsg4ZG1NC9Wb7/_buildManifest.js",,"/static/FQBh2Ar4Fsg4ZG1NC9Wb7/_ssgManifest.js"],s.__REACT_LOADABLE_MANIFEST=pt,s.__NEXT_FONT_MANIFEST=ut,s.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var g={},f={};function _(t){var c=f[t];if(c!==void 0)return c.exports;var u=f[t]={exports:{}},l=!0;try{g[t](u,u.exports,_),l=!1}finally{l&&delete f[t]}return u.exports}_.m=g,_.amdO={},(()=>{var t=[];_.O=(c,u,l,x)=>{if(u){x=x||0;for(var i=t.length;i>0&&t[i-1][2]>x;i--)t[i]=t[i-1];t[i]=[u,l,x];return}for(var d=1/0,i=0;i<t.length;i++){for(var[u,l,x]=t[i],v=!0,b=0;b<u.length;b++)d>=x&&Object.keys(_.O).every(I=>_.O[I](u[b]))?u.splice(b--,1):(v=!1,x<d&&(d=x));if(v){t.splice(i--,1);var y=l();y!==void 0&&(c=y)}}return c}})(),_.n=t=>{var c=t&&t.__esModule?()=>t.default:()=>t;return _.d(c,{a:c}),c},_.d=(t,c)=>{for(var u in c)_.o(c,u)&&!_.o(t,u)&&Object.defineProperty(t,u,{enumerable:!0,get:c[u]})},_.e=()=>Promise.resolve(),_.g=function(){if(typeof p=="object")return p;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),_.o=(t,c)=>Object.prototype.hasOwnProperty.call(t,c),_.r=t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={993:0};_.O.j=l=>t[l]===0;var c=(l,x)=>{var i,d,[v,b,y]=x,N=0;if(v.some(S=>t[S]!==0)){for(i in b)_.o(b,i)&&(_.m[i]=b[i]);if(y)var O=y(_)}for(l&&l(x);N<v.length;N++)d=v[N],_.o(t,d)&&t[d]&&t[d][0](),t[d]=0;return _.O(O)},u=s.webpackChunk_N_E=s.webpackChunk_N_E||[];u.forEach(c.bind(null,0)),u.push=c.bind(null,u.push.bind(u))})()})(),(s.webpackChunk_N_E=s.webpackChunk_N_E||[]).push([[241],{676:st,8819:ct,9642:at,5105:rt,1651:ot,796:_t,8949:nt,7908:tt,4155:et,9985:Ze,1583:Ye,8264:Qe,4363:ze,6947:Ve,6202:Je,5927:Ge,828:We,4828:Xe,6631:He,8816:qe,6991:Be,4591:Ke,7444:De,3665:Le,8042:Ue,6776:Me,4101:Fe,662:Ie,7701:Ce,9573:$e,3039:Ae,5577:Te,1959:he,5276:je,5228:ie,5303:pe,7322:Se,5558:ue,5405:Oe}]),(s.webpackChunk_N_E=s.webpackChunk_N_E||[]).push([[805],{4337:Pe,5996:we,7960:Re,6914:Ne,9548:ye,5028:ve,2039:Ee,2988:be,2561:me,581:xe,932:le,1863:fe,7037:ge,3818:ke,1730:de}]),(s.webpackChunk_N_E=s.webpackChunk_N_E||[]).push([[761],{2067:se,6195:ce,9287:(g,f,_)=>{"use strict";_.r(f),_.d(f,{ComponentMod:()=>L,default:()=>D});var t={};_.r(t),_.d(t,{POST:()=>y,runtime:()=>b});var c={};_.r(c),_.d(c,{originalPathname:()=>I,patchFetch:()=>U,requestAsyncStorage:()=>O,routeModule:()=>N,serverHooks:()=>M,staticGenerationAsyncStorage:()=>S});var u=_(932),l=_(2561),x=_(4828),i=_(6631),d=_(9985),v=_(5822);let b="edge";async function y(K,{params:w}){try{let{env:A}=(0,v.getRequestContext)(),e=A.DB,{id:a}=await w;if(!e)return d.xk.json({error:"Database not available"},{status:500});let n=await e.prepare("SELECT * FROM posts WHERE id = ?").bind(a).first();if(!n)return d.xk.json({error:"Post not found"},{status:404});if(n.status!=="pending")return d.xk.json({error:"Post is not pending"},{status:400});let o=new Date().toISOString();await e.prepare(`
      UPDATE posts
      SET status = 'approved', approved_at = ?, auto_post = 1
      WHERE id = ?
    `).bind(o,a).run();try{await e.prepare(`
        INSERT INTO activity_log (type, title, description, actor, created_at)
        VALUES ('post_approved', ?, ?, 'dashboard', ?)
      `).bind(`Post approved for @${n.account}`,n.content.substring(0,100),o).run()}catch{}let k=new URL("/api/pr/auto-post",K.url);return fetch(k.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:a})}).catch(()=>{}),d.xk.json({success:!0,message:"Post approved and queued for auto-posting",post:{id:n.id,account:n.account,status:"approved",approved_at:o}})}catch(A){return console.error("Approve post error:",A),d.xk.json({error:"Failed to approve post"},{status:500})}}let N=new l.AppRouteRouteModule({definition:{kind:x.x.APP_ROUTE,page:"/api/pr/posts/[id]/approve/route",pathname:"/api/pr/posts/[id]/approve",filename:"route",bundlePath:"app/api/pr/posts/[id]/approve/route"},resolvedPagePath:"/Users/mattiapetrucciani/CascadeProjects/Onde/apps/surfboard/src/app/api/pr/posts/[id]/approve/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:O,staticGenerationAsyncStorage:S,serverHooks:M}=N,I="/api/pr/posts/[id]/approve/route";function U(){return(0,i.XH)({serverHooks:M,staticGenerationAsyncStorage:S})}let L=c,D=u.a.wrap(N)},7185:ae,5822:re},g=>{var f=t=>g(g.s=t);g.O(0,[241,805],()=>f(9287));var _=g.O();(p._ENTRIES=typeof p._ENTRIES>"u"?{}:p._ENTRIES)["middleware_app/api/pr/posts/[id]/approve/route"]=_}]),function(){let g={exports:{},loaded:!1};return function(_,t){"use strict";var c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,x=Object.prototype.hasOwnProperty,i=(e,a)=>{for(var n in a)c(e,n,{get:a[n],enumerable:!0})},d=(e,a,n,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let k of l(a))!x.call(e,k)&&k!==n&&c(e,k,{get:()=>a[k],enumerable:!(o=u(a,k))||o.enumerable});return e},v=e=>d(c({},"__esModule",{value:!0}),e),b={};i(b,{default:()=>K}),_.exports=v(b);var y=(W(),Z(F)),N="@next/request-context",O=Symbol.for(N),S=Symbol.for("internal.storage");function M(){let e=p;if(!e[O]){let a=new y.AsyncLocalStorage,n={get:()=>a.getStore(),[S]:a};e[O]=n}return e[O]}var I=M();function U(e,a){return I[S].run(e,a)}function L(e){let a={};return e&&e.forEach((n,o)=>{a[o]=n,o.toLowerCase()==="set-cookie"&&(a[o]=D(n))}),a}function D(e){let a=[],n=0,o,k,E,j,T;function R(){for(;n<e.length&&/\s/.test(e.charAt(n));)n+=1;return n<e.length}function P(){return k=e.charAt(n),k!=="="&&k!==";"&&k!==","}for(;n<e.length;){for(o=n,T=!1;R();)if(k=e.charAt(n),k===","){for(E=n,n+=1,R(),j=n;n<e.length&&P();)n+=1;n<e.length&&e.charAt(n)==="="?(T=!0,n=j,a.push(e.substring(o,E)),o=n):n=E+1}else n+=1;(!T||n>=e.length)&&a.push(e.substring(o,e.length))}return a}function K(e){let a=e.staticRoutes.map(o=>({regexp:new RegExp(o.namedRegex),page:o.page})),n=e.dynamicRoutes?.map(o=>({regexp:new RegExp(o.namedRegex),page:o.page}))||[];return async function(o,k){let E=new URL(o.url).pathname,j={};if(e.nextConfig?.basePath&&E.startsWith(e.nextConfig.basePath)&&(E=E.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let R of e.nextConfig.i18n.locales){let P=new RegExp(`^/${R}($|/)`,"i");if(E.match(P)){E=E.replace(P,"/")||"/";break}}for(let R of a)if(R.regexp.exec(E)){j.name=R.page;break}if(!j.name){let R=A(E);for(let P of n||[]){if(R&&!A(P.page))continue;let H=P.regexp.exec(E);if(H){j={name:P.page,params:H.groups};break}}}let T=await U({waitUntil:k.waitUntil},()=>p._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:o.url,method:o.method,headers:L(o.headers),ip:w(o.headers,"x-real-ip"),geo:{city:w(o.headers,"x-vercel-ip-city",!0),country:w(o.headers,"x-vercel-ip-country",!0),latitude:w(o.headers,"x-vercel-ip-latitude"),longitude:w(o.headers,"x-vercel-ip-longitude"),region:w(o.headers,"x-vercel-ip-country-region",!0)},nextConfig:e.nextConfig,page:j,body:o.body}}));return T.waitUntil&&k.waitUntil(T.waitUntil),T.response}}function w(e,a,n=!1){let o=e.get(a)||void 0;return n&&o?decodeURIComponent(o):o}function A(e){return e==="/api"||e.startsWith("/api/")}}(g,g.exports),g.exports}.call({}).default({name:"app/api/pr/posts/[id]/approve/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/coming-soon",regex:"^/coming\\-soon(?:/)?$",routeKeys:{},namedRegex:"^/coming\\-soon(?:/)?$"},{page:"/corde",regex:"^/corde(?:/)?$",routeKeys:{},namedRegex:"^/corde(?:/)?$"},{page:"/frh",regex:"^/frh(?:/)?$",routeKeys:{},namedRegex:"^/frh(?:/)?$"},{page:"/house",regex:"^/house(?:/)?$",routeKeys:{},namedRegex:"^/house(?:/)?$"},{page:"/login",regex:"^/login(?:/)?$",routeKeys:{},namedRegex:"^/login(?:/)?$"},{page:"/pr",regex:"^/pr(?:/)?$",routeKeys:{},namedRegex:"^/pr(?:/)?$"},{page:"/social",regex:"^/social(?:/)?$",routeKeys:{},namedRegex:"^/social(?:/)?$"}],dynamicRoutes:[{page:"/api/agent-tasks/[id]",regex:"^/api/agent\\-tasks/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/agent\\-tasks/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/pr/posts/[id]/approve",regex:"^/api/pr/posts/([^/]+?)/approve(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/pr/posts/(?<nxtPid>[^/]+?)/approve(?:/)?$"},{page:"/api/pr/posts/[id]/feedback",regex:"^/api/pr/posts/([^/]+?)/feedback(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/pr/posts/(?<nxtPid>[^/]+?)/feedback(?:/)?$"}],nextConfig:{basePath:""}})))(h,h,h);export{xt as default};
